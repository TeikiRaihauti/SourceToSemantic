{
    "init": {
        "name": "stemp_epic_initialize"
    },
    "process": {
        "name": "stemp_epic_process",
        "description": "Daily process for EPIC soil temperature."
    },
    "inputs": [
        {
            "name": "ISWWAT",
            "description": "'Y' if water balance simulated, else 'N'.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "BD",
            "description": "Bulk density per layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "g/cm3",
            "uri": "-"
        },
        {
            "name": "DLAYR",
            "description": "Layer thickness.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "DS",
            "description": "Cumulative depth to bottom of each layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "DUL",
            "description": "Drained upper limit per layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "LL",
            "description": "Lower limit per layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "NLAYR",
            "description": "Number of soil layers.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Volumetric water content per layer.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Daily average air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Daily maximum air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "TMIN",
            "description": "Daily minimum air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Annual average air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "RAIN",
            "description": "Daily precipitation.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DEPIR",
            "description": "Daily irrigation depth.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "BIOMAS",
            "description": "Live biomass.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "kg/ha",
            "uri": "-"
        },
        {
            "name": "MULCHMASS",
            "description": "Surface mulch mass.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "kg/ha",
            "uri": "-"
        },
        {
            "name": "SNOW",
            "description": "Snow water equivalent.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Profile depth to bottom.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to midpoint of each layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Accumulated sum(DUL*DLAYR) (only accumulates when ISWWAT == 'N').",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Moving 5-day memory variable of X2.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "NDays",
            "description": "Wet-day memory counter (<= 30).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "INT",
            "len": "-",
            "min": "0",
            "max": "30",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "WetDay",
            "description": "30-day wet-day flags (0/1).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "INTARRAY",
            "len": "30",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "X2_PREV",
            "description": "Previous day's X2_AVG memory.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.0",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface temperature from previous step.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer from previous step.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "TDL",
            "description": "Updated accumulated sum(DUL*DLAYR) (only accumulates when ISWWAT == 'N').",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Updated moving 5-day memory variable of X2.",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "NDays",
            "description": "Updated wet-day memory counter.",
            "datatype": "INT",
            "category": "state",
            "len": "-",
            "min": "0",
            "max": "30",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "WetDay",
            "description": "Updated 30-day wet-day flags (0/1).",
            "datatype": "INTARRAY",
            "category": "state",
            "len": "30",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "X2_PREV",
            "description": "Updated to current X2_AVG.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Updated surface temperature.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Updated soil temperature by layer.",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        },
        {
            "name": "X2_AVG",
            "description": "Updated 5-day average of X2.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "C",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "SOILT_EPIC",
            "description": "Determines soil temperature by layer (EPIC method)."
        }
    ],
    "tests": [
        {
            "name": "test_stemp_epic_basic",
            "description": "Basic test exercising initialization and a few daily steps using representative inputs.",
            "inputs": [
                {
                    "name": "NLAYR",
                    "value": 4
                },
                {
                    "name": "BD",
                    "value": [
                        1.6,
                        1.6,
                        1.6,
                        1.6
                    ]
                },
                {
                    "name": "DLAYR",
                    "value": [
                        10.0,
                        10.0,
                        10.0,
                        10.0
                    ]
                },
                {
                    "name": "DS",
                    "value": [
                        10.0,
                        20.0,
                        30.0,
                        40.0
                    ]
                },
                {
                    "name": "DUL",
                    "value": [
                        0.3,
                        0.3,
                        0.3,
                        0.3
                    ]
                },
                {
                    "name": "LL",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "SW",
                    "value": [
                        0.25,
                        0.25,
                        0.25,
                        0.25
                    ]
                },
                {
                    "name": "ISWWAT",
                    "value": "Y"
                },
                {
                    "name": "TAVG",
                    "value": 25.0
                },
                {
                    "name": "TMAX",
                    "value": 30.0
                },
                {
                    "name": "TMIN",
                    "value": 20.0
                },
                {
                    "name": "TAV",
                    "value": 20.0
                },
                {
                    "name": "RAIN",
                    "value": 0.0
                },
                {
                    "name": "DEPIR",
                    "value": 0.0
                },
                {
                    "name": "BIOMAS",
                    "value": 0.0
                },
                {
                    "name": "MULCHMASS",
                    "value": 0.0
                },
                {
                    "name": "SNOW",
                    "value": 0.0
                },
                {
                    "name": "X2_PREV",
                    "value": 0.0
                },
                {
                    "name": "days",
                    "value": 5
                }
            ],
            "outputs": [
                {
                    "name": "CUMDPT",
                    "value": "-"
                },
                {
                    "name": "DSMID",
                    "value": "-"
                },
                {
                    "name": "TDL_end",
                    "value": "-"
                },
                {
                    "name": "ST_end",
                    "value": "-"
                },
                {
                    "name": "SRFTEMP_end",
                    "value": "-"
                }
            ]
        }
    ],
    "comments": [
        {
            "comment": "stemp_epic_process is documented as the major process. SOILT_EPIC is treated as a supporting function implementing the core EPIC temperature calculation."
        },
        {
            "comment": "CUMDPT and DSMID are produced at initialization and then treated as constant parameters for the daily process."
        },
        {
            "comment": "State variables passed in/out of the daily process are listed as both inputs and outputs (TDL, TMA, NDays, WetDay, X2_PREV, SRFTEMP, ST)."
        },
        {
            "comment": "X2_AVG is returned by the process but not used as an input on subsequent calls; it is still listed as an output as per schema."
        },
        {
            "comment": "Array lengths: BD, DLAYR, DS, DUL, LL, SW, DSMID, ST are length NLAYR; TMA length 5; WetDay length 30."
        }
    ]
}