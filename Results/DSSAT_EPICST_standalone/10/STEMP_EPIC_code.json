{
    "init": {
        "name": "stemp_epic_initialize"
    },
    "process": {
        "name": "stemp_epic_rate",
        "description": "Daily rate calculations for EPIC soil temperature."
    },
    "inputs": [
        {
            "name": "ISWWAT",
            "description": "'Y' if soil water is simulated; otherwise uses TDL-LL for PESW",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "BD",
            "description": "Bulk density by soil layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "g/cm3",
            "uri": "-"
        },
        {
            "name": "DLAYR",
            "description": "Thickness of each soil layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "DS",
            "description": "Cumulative depth at bottom of each soil layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "DUL",
            "description": "Drained upper limit by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "LL",
            "description": "Lower limit by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "NLAYR",
            "description": "Number of soil layers",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Soil water by layer",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Daily average air temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Daily maximum air temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "TMIN",
            "description": "Daily minimum air temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Long-term average air temperature",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "MULCHMASS",
            "description": "Surface mulch mass",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "kg/ha",
            "uri": "-"
        },
        {
            "name": "SNOW",
            "description": "Snow water equivalent",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "RAIN",
            "description": "Daily rainfall",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DEPIR",
            "description": "Irrigation depth equivalent",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "BIOMAS",
            "description": "Aboveground biomass",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "kg/ha",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Total profile depth",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to mid-point of each layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Running sum of DUL*DLAYR, used when ISWWAT != 'Y'",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Temperature memory array",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "NDays",
            "description": "Count of wet-day records currently stored (<=30)",
            "inputtype": "variable",
            "category": "state",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "30",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "WetDay",
            "description": "30-day wet-day memory (0/1 values)",
            "inputtype": "variable",
            "category": "state",
            "datatype": "INTARRAY",
            "len": "30",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "X2_PREV",
            "description": "Previous X2 average used for surface cover blending",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface temperature",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "TDL_out",
            "description": "Updated running sum of DUL*DLAYR used for PESW when ISWWAT != 'Y'",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TMA_out",
            "description": "Updated temperature memory array",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "NDays_out",
            "description": "Updated number of wet-day records stored",
            "datatype": "INT",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "30",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "WetDay_out",
            "description": "Updated 30-day wet-day memory",
            "datatype": "INTARRAY",
            "category": "state",
            "len": "30",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "X2_PREV_out",
            "description": "Updated previous X2 average used for surface cover blending",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "SRFTEMP_out",
            "description": "Updated surface temperature",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        },
        {
            "name": "ST_out",
            "description": "Updated soil temperature by layer",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "soilt_epic",
            "description": "EPIC soil temperature routine for daily update by layer."
        }
    ],
    "tests": [
        {
            "name": "test_stemp_epic_basic",
            "description": "Basic shape and execution test: initialize and perform one daily rate step.",
            "inputs": [
                {
                    "name": "NLAYR",
                    "value": "4"
                },
                {
                    "name": "BD",
                    "value": "[1.6, 1.6, 1.6, 1.6]"
                },
                {
                    "name": "DLAYR",
                    "value": "[10.0, 10.0, 10.0, 10.0]"
                },
                {
                    "name": "DS",
                    "value": "[10.0, 20.0, 30.0, 40.0]"
                },
                {
                    "name": "DUL",
                    "value": "[0.3, 0.3, 0.3, 0.3]"
                },
                {
                    "name": "LL",
                    "value": "[0.2, 0.2, 0.2, 0.2]"
                },
                {
                    "name": "SW",
                    "value": "[0.2, 0.2, 0.2, 0.2]"
                },
                {
                    "name": "ISWWAT",
                    "value": "Y"
                },
                {
                    "name": "TAVG",
                    "value": "25.0"
                },
                {
                    "name": "TMAX",
                    "value": "30.0"
                },
                {
                    "name": "TMIN",
                    "value": "20.0"
                },
                {
                    "name": "TAV",
                    "value": "20.0"
                },
                {
                    "name": "RAIN",
                    "value": "0.0"
                },
                {
                    "name": "DEPIR",
                    "value": "0.0"
                },
                {
                    "name": "BIOMAS",
                    "value": "0.0"
                },
                {
                    "name": "MULCHMASS",
                    "value": "0.0"
                },
                {
                    "name": "SNOW",
                    "value": "0.0"
                }
            ],
            "outputs": [
                {
                    "name": "len(DSMID)",
                    "value": "4"
                },
                {
                    "name": "len(TMA)",
                    "value": "5"
                },
                {
                    "name": "len(WetDay)",
                    "value": "30"
                },
                {
                    "name": "len(ST)",
                    "value": "4"
                }
            ]
        }
    ],
    "comments": [
        {
            "comment": "stemp_epic_rate is treated as the major daily process; it internally calls soilt_epic for the layer temperature update."
        },
        {
            "comment": "CUMDPT and DSMID are computed in initialization and not updated subsequently; they are documented as parameters (constant) rather than states."
        },
        {
            "comment": "State variables passed to and updated by the rate function are TDL, TMA, NDays, WetDay, X2_PREV, SRFTEMP, and ST."
        },
        {
            "comment": "SRFTEMP is accepted as an input to stemp_epic_rate but is not read before being overwritten; it remains documented as a state due to the API signature."
        },
        {
            "comment": "The unit test asserts shapes/types only; no numeric expectations are provided."
        }
    ]
}