{
    "metadata": {
        "Title": "STEMP_EPIC (EPIC soil temperature)",
        "Authors": "Kenneth N. Potter (USDA-ARS); Jimmy R. Williams (USDA-ARS)",
        "Institution": "The University of Georgia; University of Florida; Iowa State University; International Center of Soil Fertility and Agricultural Development; University of Guelph",
        "URI": "-",
        "DOI": "https://doi.org/10.2134/agronj1994.00021962008600060014x",
        "Extended description": "Calculates soil temperature profile by layer using the EPIC soil temperature method (Potter & Williams 1994). Accounts for soil water content, snow and surface mulch cover; updates layer midpoint temperatures and surface temperature on a daily timestep.",
        "Short description": "Determines soil temperature by layer",
        "Model version": "1.0"
    },
    "init": {
        "name": "STEMP_EPIC",
        "firstLine": "IF (DYNAMIC .EQ. SEASINIT) THEN",
        "lastLine": "ENDIF"
    },
    "process": {
        "name": "SOILT_EPIC",
        "description": "Determines soil temperature by layer using the EPIC soil temperature routine; computes surface temperature and updates soil layer temperatures.",
        "firstLine": "SUBROUTINE SOILT_EPIC (B, BCV, CUMDPT, DP, DSMID, NLAYR, PESW, TAV, TAVG, TMAX, TMIN, WetDay, WFT, WW, TMA, SRFTEMP, ST, X2_AVG, X2_PREV)",
        "lastLine": "END SUBROUTINE SOILT_EPIC"
    },
    "inputs": [
        {
            "name": "B",
            "description": "Exponential decay factor B (Parton & Logan) used in soil thermal calculations (computed as ALOG(500.0/DP) in STEMP_EPIC).",
            "inputtype": "variable",
            "category": "auxiliary",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "BCV",
            "description": "Soil cover fraction (from biomass/mulch/snow) used to blend surface temperature.",
            "inputtype": "variable",
            "category": "auxiliary",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "1.0",
            "default": "-",
            "unit": "fraction",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Cumulative depth of soil profile (mm).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "0.0",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DP",
            "description": "Characteristic depth DP (mm) used in temperature diffusion (computed in STEMP_EPIC).",
            "inputtype": "variable",
            "category": "auxiliary",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to midpoint of each soil layer (mm).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "NL",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "NLAYR",
            "description": "Number of soil layers.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "1",
            "max": "20",
            "default": "-",
            "unit": "count",
            "uri": "-"
        },
        {
            "name": "PESW",
            "description": "Potential extractable soil water (cm) = SW - LL summed over root/profile depth.",
            "inputtype": "variable",
            "category": "auxiliary",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Average annual soil temperature (degC) (exogenous).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-60.0",
            "max": "60.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Average daily air temperature (degC) (exogenous).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-60.0",
            "max": "60.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Daily maximum air temperature (degC) (exogenous).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-60.0",
            "max": "70.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TMIN",
            "description": "Daily minimum air temperature (degC) (exogenous).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-80.0",
            "max": "60.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "WetDay",
            "description": "Indicator of a wet day (1 = wet (rain or irrigation), 0 = dry). Stored as an array of 30 days in STEMP_EPIC; passed to SOILT_EPIC as scalar for the current day.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "INTARRAY",
            "len": "30",
            "min": "0",
            "max": "1",
            "default": "0",
            "unit": "flag",
            "uri": "-"
        },
        {
            "name": "WFT",
            "description": "Fraction of wet days (rainfall + irrigation) over the memory window (dimensionless).",
            "inputtype": "variable",
            "category": "auxiliary",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "1.0",
            "default": "0.1",
            "unit": "fraction",
            "uri": "-"
        },
        {
            "name": "WW",
            "description": "Volumetric fraction WW used in moisture correction (dimensionless), computed as 0.356 - 0.144*ABD in STEMP_EPIC.",
            "inputtype": "variable",
            "category": "auxiliary",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "1.0",
            "default": "-",
            "unit": "fraction",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Array of previous 5 days of average soil temperatures (degC); state memory (TMA(5)).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "5",
            "min": "-60.0",
            "max": "60.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "X2_PREV",
            "description": "Previous-day surface temperature (degC) used for mixing with cover factor (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-60.0",
            "max": "60.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature for each soil layer (degC); in/out state vector (ST(NL)).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "NL",
            "min": "-60.0",
            "max": "80.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "BD",
            "description": "Bulk density per soil layer (g soil / cm3 soil) (soil property).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NL",
            "min": "0.0",
            "max": "3.0",
            "default": "-",
            "unit": "g/cm3",
            "uri": "-"
        },
        {
            "name": "DLAYR",
            "description": "Thickness of soil layers (cm) (soil property).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NL",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "DS",
            "description": "Cumulative depth in soil layers (cm) (soil property).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NL",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "DUL",
            "description": "Volumetric soil water content at Drained Upper Limit (cm3 water / cm3 soil) (soil property).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NL",
            "min": "0.0",
            "max": "1.0",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "LL",
            "description": "Lower limit volumetric soil water content per layer (cm3 water / cm3 soil) (soil property).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NL",
            "min": "0.0",
            "max": "1.0",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Volumetric soil water content per layer (cm3 water / cm3 soil); input state to STEMP_EPIC.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "NL",
            "min": "0.0",
            "max": "1.0",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "ISWWAT",
            "description": "Water simulation control switch (Y/N). If 'Y', water content is used; if 'N', DUL is used instead.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "1",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TAMP",
            "description": "Annual amplitude of average air temperature (degC) (WEATHER%TAMP).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "RAIN",
            "description": "Daily rainfall (mm) (WEATHER%RAIN) used to determine wet days.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "0.0",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DEPIR",
            "description": "Depth of irrigation (mm) (MGMT%DEPIR) used to determine wet days.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "0.0",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "BIOMAS",
            "description": "Plant biomass (kg/ha) used to compute surface cover fraction.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "0.0",
            "unit": "kg/ha",
            "uri": "-"
        },
        {
            "name": "MULCHMASS",
            "description": "Mulch mass (kg/ha) used to compute surface cover fraction (ORGC%MULCHMASS).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "0.0",
            "unit": "kg/ha",
            "uri": "-"
        },
        {
            "name": "SNOW",
            "description": "Snow cover (mm) used to compute surface cover fraction (WATER%SNOW).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "0.0",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "NDays",
            "description": "Number of days currently stored in wet-day memory (integer, up to 30).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "INT",
            "len": "-",
            "min": "0",
            "max": "30",
            "default": "0",
            "unit": "days",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Total water content of soil at drained upper limit (cm) (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "SRFTEMP",
            "description": "Temperature of soil surface litter (degC).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-60.0",
            "max": "80.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature in each soil layer (degC).",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "NL",
            "min": "-60.0",
            "max": "80.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "X2_AVG",
            "description": "Average of recent X2 (surface temperature estimate) values (degC) computed by SOILT_EPIC.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-60.0",
            "max": "80.0",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "-",
            "description": "-"
        }
    ],
    "tests": [
        {
            "name": "ASKEE",
            "description": "Standalone driver program that initializes CONTROL, ISWITCH, SOILPROP and WEATHER variables and calls STEMP_EPIC across dynamics (serves as a basic integration/test driver).",
            "inputs": [
                {
                    "name": "BD",
                    "value": "1.6"
                },
                {
                    "name": "DLAYR",
                    "value": "10.0"
                },
                {
                    "name": "DS",
                    "value": "[10.0, 20.0, 30.0, 40.0]"
                },
                {
                    "name": "DUL",
                    "value": "0.3"
                },
                {
                    "name": "LL",
                    "value": "0.2"
                },
                {
                    "name": "NLAYR",
                    "value": "4"
                },
                {
                    "name": "SW",
                    "value": "0.2"
                },
                {
                    "name": "TAVG",
                    "value": "25.0"
                },
                {
                    "name": "TMAX",
                    "value": "30.0"
                },
                {
                    "name": "TMIN",
                    "value": "20.0"
                },
                {
                    "name": "TAV",
                    "value": "20.0"
                },
                {
                    "name": "WEATHER_TAMP",
                    "value": "10.0"
                },
                {
                    "name": "WEATHER_RAIN",
                    "value": "0.0"
                },
                {
                    "name": "MULCHMASS",
                    "value": "0.0"
                },
                {
                    "name": "SNOW",
                    "value": "0.0"
                },
                {
                    "name": "DEPIR",
                    "value": "0.0"
                },
                {
                    "name": "BIOMAS",
                    "value": "0.0"
                }
            ],
            "outputs": [
                {
                    "name": "SRFTEMP",
                    "value": "-"
                },
                {
                    "name": "ST",
                    "value": "-"
                },
                {
                    "name": "X2_PREV",
                    "value": "-"
                },
                {
                    "name": "DSMID",
                    "value": "-"
                },
                {
                    "name": "CUMDPT",
                    "value": "-"
                }
            ]
        }
    ]
}