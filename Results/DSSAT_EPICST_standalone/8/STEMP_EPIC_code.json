{
    "init": {
        "name": "STEMP_EPIC_Initialize"
    },
    "process": {
        "name": "STEMP_EPIC",
        "description": "Daily EPIC soil temperature update; maintains wet-day memory and cover effects, and updates soil temperature by layer."
    },
    "inputs": [
        {
            "name": "ISWWAT",
            "description": "Water balance switch ('Y' uses soil water, 'N' uses TDL)",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "BD",
            "description": "Bulk density by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "g/cm3",
            "uri": "-"
        },
        {
            "name": "DLAYR",
            "description": "Layer thickness",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "DS",
            "description": "Cumulative depth by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "DUL",
            "description": "Drained upper limit by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "LL",
            "description": "Lower limit by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "NLAYR",
            "description": "Number of soil layers",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Soil water content by layer",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Daily average air temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Daily maximum air temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TMIN",
            "description": "Daily minimum air temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Long-term average air temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "WEATHER_RAIN",
            "description": "Daily rainfall",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "MGMT_DEPIR",
            "description": "Management depletion or irrigation depth",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "PLANT_BIOMAS",
            "description": "Plant biomass",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "kg/ha",
            "uri": "-"
        },
        {
            "name": "ORGC_MULCHMASS",
            "description": "Surface organic mulch mass",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "kg/ha",
            "uri": "-"
        },
        {
            "name": "WATER_SNOW",
            "description": "Snow water equivalent",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Cumulative profile depth",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Layer mid-point depths",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Profile total at drained upper limit (accumulated per original code)",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "5-day memory of surface forcing temperature",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "NDays",
            "description": "Number of days tracked for wet-day fraction",
            "inputtype": "variable",
            "category": "state",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "d",
            "uri": "-"
        },
        {
            "name": "WetDay",
            "description": "30-day memory of wet days (0/1)",
            "inputtype": "variable",
            "category": "state",
            "datatype": "INTARRAY",
            "len": "30",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "X2_PREV",
            "description": "Previous 5-day average surface forcing temperature",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface soil temperature",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "TDL",
            "description": "Profile total at drained upper limit (accumulated per original code)",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "5-day memory of surface forcing temperature",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "NDays",
            "description": "Number of days tracked for wet-day fraction",
            "datatype": "INT",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "d",
            "uri": "-"
        },
        {
            "name": "WetDay",
            "description": "30-day memory of wet days (0/1)",
            "datatype": "INTARRAY",
            "category": "state",
            "len": "30",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "X2_PREV",
            "description": "Previous 5-day average surface forcing temperature",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface soil temperature",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "_nint",
            "description": "Nearest-integer rounding helper emulating Fortran NINT."
        },
        {
            "name": "SOILT_EPIC",
            "description": "EPIC soil temperature by layer; updates 5-day memory, surface temperature, and layer temperatures."
        }
    ],
    "tests": [
        {
            "name": "test_STEMP_EPIC_basic",
            "description": "Basic end-to-end initialization and 5 daily steps; checks array lengths, types, and that NDays increments to 5.",
            "inputs": [
                {
                    "name": "ISWWAT",
                    "value": "Y"
                },
                {
                    "name": "NLAYR",
                    "value": 4
                },
                {
                    "name": "BD",
                    "value": [
                        1.6,
                        1.6,
                        1.6,
                        1.6
                    ]
                },
                {
                    "name": "DLAYR",
                    "value": [
                        10.0,
                        10.0,
                        10.0,
                        10.0
                    ]
                },
                {
                    "name": "DS",
                    "value": [
                        10.0,
                        20.0,
                        30.0,
                        40.0
                    ]
                },
                {
                    "name": "DUL",
                    "value": [
                        0.3,
                        0.3,
                        0.3,
                        0.3
                    ]
                },
                {
                    "name": "LL",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "SW",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "TAVG",
                    "value": 25.0
                },
                {
                    "name": "TMAX",
                    "value": 30.0
                },
                {
                    "name": "TMIN",
                    "value": 20.0
                },
                {
                    "name": "TAV",
                    "value": 20.0
                },
                {
                    "name": "WEATHER_RAIN",
                    "value": 0.0
                },
                {
                    "name": "MGMT_DEPIR",
                    "value": 0.0
                },
                {
                    "name": "PLANT_BIOMAS",
                    "value": 0.0
                },
                {
                    "name": "ORGC_MULCHMASS",
                    "value": 0.0
                },
                {
                    "name": "WATER_SNOW",
                    "value": 0.0
                }
            ],
            "outputs": [
                {
                    "name": "NDays",
                    "value": 5
                }
            ]
        }
    ]
}