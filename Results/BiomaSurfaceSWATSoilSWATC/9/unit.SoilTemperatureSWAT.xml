<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperatureSWAT" name="SoilTemperatureSWAT" timestep="1" version="001">
	<Description>
		<Title>SoilTemperatureSWAT</Title>
		<Authors>Simone Bregaglio; Nicol√≤ Frasso</Authors>
		<Institution>University Of Milan</Institution>
		<URI>http://bioma.jrc.ec.europa.eu/ontology/JRC_MARS_biophysical_domain.owl</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Strategy for the calculation of soil temperature with the SWAT method. Reference: Neitsch, S.L., Arnold, J.G., Kiniry, J.R., Williams, J.R., King, K.W. Soil and Water Assessment Tool. Theoretical documentation. Version 2000. http://swatmodel.tamu.edu/media/1290/swat2000theory.pdf</ExtendedDescription>
		<ShortDescription>Calculates soil temperature by layers using the SWAT approach.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="LayerThickness" description="Soil layer thicknesses" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="len(LayerThickness)" max="" min="" default="" unit="m" uri=""/>
		<Input name="LagCoefficient" description="Lag coefficient controlling memory of previous day's soil temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1.0" min="0.0" default="" unit="-" uri=""/>
		<Input name="SoilProfileDepth" description="Total soil profile depth" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="" unit="m" uri=""/>
		<Input name="SurfaceSoilTemperature" description="Surface soil temperature at the current time step" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="AirTemperatureAnnualAverage" description="Annual average air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="SoilTemperatureByLayers" description="Previous step soil temperature by layer" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="len(LayerThickness)" max="" min="" default="" unit="degC" uri=""/>
		<Input name="BulkDensity" description="Soil bulk density by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="len(LayerThickness)" max="" min="" default="" unit="t m-3" uri=""/>
		<Input name="VolumetricWaterContent" description="Volumetric water content by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="len(LayerThickness)" max="" min="" default="" unit="m3 m-3" uri=""/>
	</Inputs>
	<Outputs>
		<Output name="SoilTemperatureByLayers" description="Updated soil temperature by layer after current step" variablecategory="state" datatype="DOUBLELIST" len="len(LayerThickness)" max="" min="" unit="degC" uri=""/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="Init" description="Initializes SoilTemperatureByLayers to 15.0 degC for each layer." language="cyml" type="external" filename="algo/pyx/Init.pyx"/>
	<Function name="Estimate" description="Updates soil temperature by layer using damping depth based on bulk density and water content with a lag term." language="cyml" type="external" filename="algo/pyx/Estimate.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
