<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperatureSWAT" name="SoilTemperatureSWAT" timestep="1" version="001">
	<Description>
		<Title>SoilTemperatureSWAT</Title>
		<Authors>Simone Bregaglio; Nicol√≤ Frasso</Authors>
		<Institution>University of Milan</Institution>
		<URI>http://bioma.jrc.ec.europa.eu/ontology/JRC_MARS_biophysical_domain.owl</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Daily, multi-layer soil temperature model implementing the SWAT method (Neitsch et al., 2000). It computes a maximum damping depth as a function of bulk density, scales it by the total soil water content and soil profile depth to obtain an effective damping depth, and derives a depth factor for each layer center. Layer temperatures are updated using a first-order lag: T_i(t) = LagCoefficient * T_i(t-1) + (1 - LagCoefficient) * [DepthFactor * (T_air,annual - T_surface) + T_surface]. Inputs include soil profile depth, surface soil temperature (from a companion surface model), annual average air temperature, layer thickness, volumetric water content, and bulk density. Output is soil temperature by layers.</ExtendedDescription>
		<ShortDescription>SWAT-based daily soil temperature by layers using damping depth and a lag coefficient.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="SoilProfileDepth" description="Soil profile depth" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="50" min="0" default="-" unit="m" uri="-"/>
		<Input name="SurfaceSoilTemperature" description="Average surface soil temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="60" min="-60" default="-" unit="degC" uri="-"/>
		<Input name="AirTemperatureAnnualAverage" description="Annual average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="50" min="-40" default="-" unit="degC" uri="-"/>
		<Input name="SoilTemperatureByLayers" description="Soil temperature of each layer (previous values; updated in-place)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="60" min="-60" default="-" unit="degC" uri="-"/>
		<Input name="BulkDensity" description="Bulk density by layer" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="1.8" min="0.9" default="-" unit="t m-3" uri="-"/>
		<Input name="VolumetricWaterContent" description="Volumetric soil water content by layer" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="0.8" min="0" default="-" unit="m3 m-3" uri="-"/>
		<Input name="LayerThickness" description="Soil layer thickness" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="3" min="0.005" default="-" unit="m" uri="-"/>
		<Input name="LagCoefficient" description="Lag coefficient that controls the influence of the previous day's temperature on the current day's temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.8" unit="dimensionless" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="SoilTemperatureByLayers" description="Updated soil temperature of each layer" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="60" min="-60" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="Init" description="Initialize SoilTemperatureByLayers to 15 degC for each layer." language="cyml" type="external" filename="algo/pyx/Init.pyx"/>
	<Function name="Estimate" description="Compute daily soil temperature by layer using SWAT formulation with lagging." language="cyml" type="external" filename="algo/pyx/Estimate.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
