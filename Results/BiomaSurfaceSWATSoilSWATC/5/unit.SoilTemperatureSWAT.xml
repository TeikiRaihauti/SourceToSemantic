<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperatureSWAT" name="SoilTemperatureSWAT" timestep="1" version="001">
	<Description>
		<Title>SoilTemperatureSWAT</Title>
		<Authors>Simone Bregaglio; Nicol√≤ Frasso</Authors>
		<Institution>University of Milan</Institution>
		<URI>http://bioma.jrc.ec.europa.eu/ontology/JRC_MARS_biophysical_domain.owl</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Strategy for the calculation of soil temperature with the SWAT method. Reference: Neitsch, S.L., Arnold, J.G., Kiniry, J.R., Williams, J.R., King, K.W. Soil and Water Assessment Tool. Theoretical Documentation. Version 2000. http://swatmodel.tamu.edu/media/1290/swat2000theory.pdf</ExtendedDescription>
		<ShortDescription>Soil temperature by layers computed using the SWAT approach.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="LagCoefficient" description="Lag coefficient controlling inertia of daily soil temperature update" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="states_SoilProfileDepth" description="Total soil profile depth" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="m" uri="-"/>
		<Input name="states_SurfaceSoilTemperature" description="Surface soil temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="exogenous_AirTemperatureAnnualAverage" description="Annual average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="states_SoilTemperatureByLayers" description="Soil temperature by layer (previous timestep values)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="states_BulkDensity" description="Soil bulk density by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="t m-3" uri="-"/>
		<Input name="states_VolumetricWaterContent" description="Volumetric water content by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="m3 m-3" uri="-"/>
		<Input name="states_LayerThickness" description="Soil layer thicknesses" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="m" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="states_SoilTemperatureByLayers" description="Soil temperature by layer (updated)" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="Init" description="Initialize SoilTemperatureByLayers." language="cyml" type="external" filename="algo/pyx/Init.pyx"/>
	<Function name="Estimate" description="Update SoilTemperatureByLayers using SWAT method." language="cyml" type="external" filename="algo/pyx/Estimate.pyx"/>
	<Function name="_compute_maximum_dumping_depth" description="Compute maximum dumping depth (mm): 1000 + (2500*BD)/(BD + 686*exp(-5.63*BD))." language="cyml" type="external" filename="algo/pyx/_compute_maximum_dumping_depth.pyx"/>
	<Function name="_compute_scaling_factor" description="Compute scaling factor SF = TWCmm / ((0.356 - 0.144*BD) * SPDmm)." language="cyml" type="external" filename="algo/pyx/_compute_scaling_factor.pyx"/>
	<Function name="_compute_dumping_depth" description="Compute dumping depth DD = MDD * exp(ln(500/MDD) * ((1 - SF)/(1 + SF))^2)." language="cyml" type="external" filename="algo/pyx/_compute_dumping_depth.pyx"/>
	<Function name="_compute_depth_factor" description="Compute depth factor DF = RC / (RC + exp(-0.867 - 2.078*RC))." language="cyml" type="external" filename="algo/pyx/_compute_depth_factor.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
