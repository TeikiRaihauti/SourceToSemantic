<?xml version="1.0" ?>
<ModelUnit modelid=".Vernalisation (SIMPLACE component)" name="Vernalisation (SIMPLACE component)" timestep="1" version="-">
	<Description>
		<Title>Vernalisation (SIMPLACE component)</Title>
		<Authors>Gunther Krauss; Andreas Enders</Authors>
		<Institution>Crop Science Group, University of Bonn, Katzenburgweg 5, 53115 Bonn, Germany</Institution>
		<URI>http://www.simplace.net</URI>
		<Reference>-</Reference>
		<ExtendedDescription>The SIMPLACE Vernalisation component computes vernalisation days as a piecewise-linear function of daily mean air temperature using four thresholds (cTlowCritical, cTlow, cThigh, cThighCritical). Accumulated vernalisation days (sVernalDays) are converted to a VernalisationFactor via linear scaling between crop-specific minimum and maximum vernalisation day requirements (cVernalDaysMin, cVernalDaysMax). The component scales the daily effective temperature (RTSUM) for development by the minimum of the photo period factor and the VernalisationFactor. RTSUM is selected from pre-anthesis (iTSumBaseAnt), optional base-shoot (iTSumBaseShoot) phase, or post-anthesis (iTSumBaseMat) depending on development stage. Vernalisation can be toggled via cApplyVernalisation and the state is reset on sowing (iDoSow). Reference: Goudriaan &amp; Van Laar (1994) Modelling Potential Crop Growth Processes, Kluwer Academic Publishers.</ExtendedDescription>
		<ShortDescription>Calculates vernalisation days and factor from temperature and scales thermal time by min(photoresponse, vernalisation) to drive crop development.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="cApplyVernalisation" description="Flag to activate vernalisation (crops requiring vernalisation for flower initialization)." inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="true" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cVernalDaysMin" description="Crop specific minimum number of days required for vernalisation." inputtype="parameter" parametercategory="constant" datatype="INT" max="100" min="0" default="10" unit="d" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cVernalDaysMax" description="Crop specific maximum number of days required for vernalisation." inputtype="parameter" parametercategory="constant" datatype="INT" max="400" min="0" default="70" unit="d" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cTlow" description="Lower temperature threshold for vernalisation; days with lower mean air temperature are not fully considered as a vernalisation day." inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="50" min="-40" default="3" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="cThigh" description="Upper temperature threshold for vernalisation; days with higher mean air temperature are not fully considered as a vernalisation day." inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="50" min="-40" default="10" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="cTlowCritical" description="Lower critical temperature threshold for vernalisation; days below do not contribute at all." inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="50" min="-40" default="-4" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="cThighCritical" description="Upper critical temperature threshold for vernalisation; days above do not contribute at all." inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="50" min="-40" default="17" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="iDoSow" description="True if sowing day (resets sVernalDays)." inputtype="variable" variablecategory="exogenous" datatype="CHAR" max="-" min="-" default="false" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iPhotoPeriodFactor" description="Photoperiod response factor." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="-" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iDAVTMP" description="Daily mean air temperature." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="50" min="0" default="-" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="iTSumBaseAnt" description="Daily effective temperature before anthesis." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="10000" min="0" default="-" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="iTSumBaseShoot" description="Daily effective temperature after shooting (if given)." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="10000" min="0" default="-" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="iDevStageBaseShoot" description="Development stage threshold for base shoot." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="10000" min="0" default="0.5" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iTSumBaseMat" description="Daily effective temperature after anthesis." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="10000" min="0" default="-" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="iDevStage" description="Development stage of the crop (1.0=anthesis, 2.0=physiological maturity)." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="3" min="0" default="-" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="sVernalDays" description="Actual vernalisation days (state)." inputtype="variable" variablecategory="state" datatype="DOUBLE" max="400" min="0" default="0" unit="d" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
	</Inputs>
	<Outputs>
		<Output name="sVernalDays" description="Updated accumulated vernalisation days." variablecategory="state" datatype="DOUBLE" max="400" min="0" unit="d" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Output name="DayLength" description="Day length in minutes." variablecategory="auxiliary" datatype="INT" max="1441" min="0" unit="min" uri="http://www.wurvoc.org/vocabularies/om-1.8/minute-time"/>
		<Output name="VernalisationFactor" description="Daily vernalisation factor." variablecategory="auxiliary" datatype="DOUBLE" max="1" min="0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Output name="RTSUM" description="Daily effective temperature used to calculate the temperature sum and development stage." variablecategory="auxiliary" datatype="DOUBLE" max="50" min="0" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
	</Outputs>
	<Initialization name="init" language="cyml" filename="algo/pyx/init.pyx"/>
	<Function name="reset" description="Reset on sowing: runs init checks and sets sVernalDays to 0." language="cyml" type="external" filename="algo/pyx/reset.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/process.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
