<?xml version="1.0" ?>
<ModelUnit modelid=".SIMPLACE LINTUL Biomass component (LintulBiomass)" name="SIMPLACE LINTUL Biomass component (LintulBiomass)" timestep="1" version="-">
	<Description>
		<Title>SIMPLACE LINTUL Biomass component (LintulBiomass)</Title>
		<Authors>Gunther Krauss; Andreas Enders; Thomas Gaiser</Authors>
		<Institution>Crop Science Group (INRES), University of Bonn, Katzenburgweg 5, 53115 Bonn, Germany</Institution>
		<URI>https://github.com/SIMPLACE/Simplace/blob/master/Simplace/src/net/simplace/sim/components/models/lintul/LintulBiomass.java</URI>
		<Reference>-</Reference>
		<ExtendedDescription>LintulBiomass calculates daily crop biomass production and leaf area index (LAI) in the SIMPLACE framework using LINTUL concepts. Intercepted photosynthetically active radiation (PAR) is computed from global radiation and LAI via an extinction coefficient. Daily total biomass growth equals PAR times a crop-specific light-use efficiency (LUE), reduced by the most limiting stress (water via TRANRF or nitrogen via an LUE reduction function of the nitrogen nutrition index, NNI). Biomass is partitioned to roots, stems, leaves, and storage organs using development-stage dependent fractions. Leaf senescence combines development-, shading-, water- and heat-stress-related relative death rates, with additional N-stress impacts. LAI growth is derived from leaf biomass via specific leaf area (SLA), reduced under N stress; at early development LAI follows an exponential relative growth rate constrained by water and N stress. Outputs include daily total biomass increment (GTOTAL), intercepted PAR, and above-ground biomass.</ExtendedDescription>
		<ShortDescription>SIMPLACE component implementing LINTUL-based biomass and LAI growth with water and nitrogen stress effects.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="cK" description="Extinction coefficient for photosynthetically active radiation" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.6" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cLAII" description="Initial LAI" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="0.1" min="0" default="0.012" unit="m2 m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/square_metre_per_square_metre"/>
		<Input name="cLaiCritical" description="Critical LAI beyond which leaves die due to self-shading" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="6" min="0" default="4" unit="m2 m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/square_metre_per_square_metre"/>
		<Input name="cRDRSHM" description="Maximum relative death rate of leaves due to shading" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.05" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cRDRNS" description="Max. relative death rate of leaves due to N stress" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.05" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cRDRL" description="Max. relative death rate of leaves due to water stress" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.05" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cRGRL" description="Relative growth rate of LAI during exponential growth" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.05" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cSLA" description="Specific Leaf Area" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="20" min="0" default="0.2" unit="m2 g-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/square_metre_per_gram"/>
		<Input name="cLaiNStressReduction" description="N Stress effect on LAI growth rate" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="1" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cLueNStressReduction" description="N Stress effect on LUE" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="1" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cSlaNStressReduction" description="N Stress effect on Specific Leaf Area" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="1" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cRDRT" description="Table of development specific leaves death rates (fallback flat pair list)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="-" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cRelativeDayOfEmergence" description="Days between sowing and start of LAI development/plant growth" inputtype="parameter" parametercategory="constant" datatype="INT" max="366" min="0" default="12" unit="d" uri="http://www.wurvoc.org/vocabularies/om-1.8/day"/>
		<Input name="cDevStageRGRL" description="Development stage up to which LAI growth uses constant rate RGRL" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="2" min="0" default="0.3" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cGrainToRootsDailyBiomass" description="Daily biomass supplied from seeds to roots after emergence" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="10" min="0" default="0.2" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Input name="cGrainToRootsDevStage" description="DevStage after emergence up to which root biomass is supplied by the seed" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="2" min="0" default="0.0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="cRDRLeavesTableMeanTemperature" description="Daily mean temperature for relative death rate of leaves (c.f. RDRT)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="-" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="cRDRLeavesTableRelativeRate" description="Relative death rate of leaves as a function of daily mean temperature (c.f. RDRT)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="-" unit="d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/reciprocal_day"/>
		<Input name="iDoHarvest" description="Flag to specify the day of harvest" inputtype="variable" variablecategory="exogenous" datatype="INT" max="1" min="0" default="0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iDoSow" description="Flag to specify the day of sowing" inputtype="variable" variablecategory="exogenous" datatype="INT" max="1" min="0" default="0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iUnusedRootBiomass" description="Root biomass unused due to limitations (returned to next day's growth)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="20000" min="0" default="0" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Input name="iNitrogenNutritionIndex" description="Nitrogen Nutrition Index (actual N concentration / critical N concentration)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="1" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iAirTemperatureMean" description="Measured daily average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="60" min="-50" default="0" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="iEffectiveTempRateBeforeAnt" description="Daily effective temperature before anthesis" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="40" min="0" default="0" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="iEffectiveTempRateAfterAnt" description="Daily effective temperature after anthesis" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="40" min="0" default="0" unit="degC" uri="http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"/>
		<Input name="iRadiation" description="Daily global radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="30" min="0" default="0" unit="MJ m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/megajoule_per_square_metre"/>
		<Input name="iDevStage" description="Development stage of the plant (1.0=anthesis, 2.0=maturity)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="3" min="0" default="0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iCropAvailWaterContent" description="Crop available water content in the soil" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="20" min="0" default="0.0001" unit="mm" uri="http://www.wurvoc.org/vocabularies/om-1.8/millimetre"/>
		<Input name="iTRANRF" description="Transpiration reduction factor (actual/potential transpiration)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="1" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iPartRootFactor" description="Proportion of daily total biomass increase partitioned to roots" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iPartStemsFactor" description="Proportion of daily total biomass increase partitioned to stems" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iPartStorageOrgansFactor" description="Proportion of daily total biomass increase partitioned to storage organs" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iPartLeavesFactor" description="Proportion of daily total biomass increase partitioned to leaves" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="iLUE" description="Light Use Efficiency" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="10" min="0" default="3" unit="g MJ-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_megajoule"/>
		<Input name="iLeaveSenescenceHeatStressFactor" description="Factor increasing leaf senescence due to heat stress" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="1.0" unit="-" uri="http://www.wurvoc.org/vocabularies/om-1.8/one"/>
		<Input name="sDaysSinceSowing" description="Days since sowing" inputtype="variable" variablecategory="state" datatype="INT" max="1000" min="0" default="0" unit="d" uri="http://www.wurvoc.org/vocabularies/om-1.8/day"/>
		<Input name="sWLV" description="Biomass of leaves (total)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="2000" min="0" default="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Input name="sWLVG" description="Biomass of green leaves" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="2000" min="0" default="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Input name="sWLVD" description="Biomass of dead leaves" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="2000" min="0" default="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Input name="sWST" description="Biomass of stems" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="2000" min="0" default="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Input name="sWSO" description="Biomass of storage organs" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="2000" min="0" default="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Input name="sWRT" description="Biomass of roots" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="2000" min="0" default="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Input name="sLAI" description="Leaf area index" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="20" min="0" default="0" unit="m2 m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/square_metre_per_square_metre"/>
		<Input name="rDeadLeaves" description="Rate of dead leaves" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="200" min="-200" default="0" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Input name="rDeadStems" description="Rate of dead stems" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="200" min="-200" default="0" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Input name="rRWLVG" description="Rate of change in weight of green leaves" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="200" min="-200" default="0" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Input name="rRWRT" description="Rate of change in weight of roots" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="200" min="-200" default="0" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Input name="rDLAI" description="Rate of change of Leaf area index" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="10" min="-10" default="0" unit="m2 m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/square_metre_per_square_metre"/>
		<Input name="PARINT" description="Intercepted photosynthetically active radiation (previous value)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="30" min="0" default="0" unit="MJ m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/megajoule_per_square_metre_day"/>
	</Inputs>
	<Outputs>
		<Output name="GTOTAL" description="Growth rate of total crop dry matter" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="-" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Output name="AboveGroundBiomass" description="Sum of biomass fractions above ground" variablecategory="auxiliary" datatype="DOUBLE" max="10000" min="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Output name="PARINT" description="Intercepted photosynthetically active radiation (updated)" variablecategory="auxiliary" datatype="DOUBLE" max="30" min="0" unit="MJ m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/megajoule_per_square_metre_day"/>
		<Output name="sDaysSinceSowing" description="Days since sowing (updated)" variablecategory="state" datatype="INT" max="1000" min="0" unit="d" uri="http://www.wurvoc.org/vocabularies/om-1.8/day"/>
		<Output name="sWLV" description="Biomass of leaves (total) (updated)" variablecategory="state" datatype="DOUBLE" max="2000" min="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Output name="sWLVG" description="Biomass of green leaves (updated)" variablecategory="state" datatype="DOUBLE" max="2000" min="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Output name="sWLVD" description="Biomass of dead leaves (updated)" variablecategory="state" datatype="DOUBLE" max="2000" min="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Output name="sWST" description="Biomass of stems (updated)" variablecategory="state" datatype="DOUBLE" max="2000" min="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Output name="sWSO" description="Biomass of storage organs (updated)" variablecategory="state" datatype="DOUBLE" max="2000" min="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Output name="sWRT" description="Biomass of roots (updated)" variablecategory="state" datatype="DOUBLE" max="2000" min="0" unit="g m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre"/>
		<Output name="sLAI" description="Leaf area index (updated)" variablecategory="state" datatype="DOUBLE" max="20" min="0" unit="m2 m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/square_metre_per_square_metre"/>
		<Output name="rDeadLeaves" description="Dead leaves increment (updated)" variablecategory="state" datatype="DOUBLE" max="200" min="-200" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Output name="rDeadStems" description="Dead stems increment (updated)" variablecategory="state" datatype="DOUBLE" max="200" min="-200" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Output name="rRWLVG" description="Daily change in green leaf biomass (updated)" variablecategory="state" datatype="DOUBLE" max="200" min="-200" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Output name="rRWRT" description="Daily change in root biomass (updated)" variablecategory="state" datatype="DOUBLE" max="200" min="-200" unit="g m-2 d-1" uri="http://www.wurvoc.org/vocabularies/om-1.8/gram_per_square_metre_day"/>
		<Output name="rDLAI" description="Daily change in LAI (updated)" variablecategory="state" datatype="DOUBLE" max="10" min="-10" unit="m2 m-2" uri="http://www.wurvoc.org/vocabularies/om-1.8/square_metre_per_square_metre"/>
	</Outputs>
	<Initialization name="init" language="cyml" filename="algo/pyx/init.pyx"/>
	<Function name="init" description="Initialize variables and build the interpolation table for leaf death rate." language="cyml" type="external" filename="algo/pyx/init.pyx"/>
	<Function name="process" description="Compute daily biomass growth, partitioning, senescence, LAI dynamics, and update states and outputs." language="cyml" type="external" filename="algo/pyx/process.pyx"/>
	<Function name="resetOnHarvest" description="Reset all states, rates, and outputs to defaults on harvest." language="cyml" type="external" filename="algo/pyx/resetOnHarvest.pyx"/>
	<Function name="resetOnSowing" description="Reset all states, rates, and outputs to defaults on sowing." language="cyml" type="external" filename="algo/pyx/resetOnSowing.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/process.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
