<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperatureSWAT model" name="SoilTemperatureSWAT model" timestep="1" version="001">
	<Description>
		<Title>SoilTemperatureSWAT model</Title>
		<Authors>Simone Bregaglio</Authors>
		<Institution>University of Milan</Institution>
		<URI>-</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Strategy for calculating soil temperature by layers using the SWAT method. The algorithm computes a water-content-dependent damping depth based on bulk density and total soil water, then updates each layerâ€™s temperature via a lagged approach that blends the annual average air temperature with the current surface soil temperature using a depth factor. Reference: Neitsch, S.L., Arnold, J.G., Kiniry, J.R., Williams, J.R., King, K.W. Soil and Water Assessment Tool. Theoretical documentation. Version 2000. http://swatmodel.tamu.edu/media/1290/swat2000theory.pdf</ExtendedDescription>
		<ShortDescription>SWAT-based multi-layer soil temperature calculation with lag and damping depth.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="VolumetricWaterContent" description="Volumetric water content by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="m3 m-3" uri="-"/>
		<Input name="SurfaceSoilTemperature" description="Surface soil temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="LayerThickness" description="Thickness per soil layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="m" uri="-"/>
		<Input name="LagCoefficient" description="Lag coefficient controlling update weight" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SoilTemperatureByLayers" description="Soil temperature by layer (previous state)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="AirTemperatureAnnualAverage" description="Annual average air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="BulkDensity" description="Soil bulk density by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="t m-3" uri="-"/>
		<Input name="SoilProfileDepth" description="Total soil profile depth" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="m" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="SoilTemperatureByLayers" description="Updated soil temperature by layer" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="init_soiltemperatureswat" language="cyml" filename="algo/pyx/init_soiltemperatureswat.pyx"/>
	<Function name="init_soiltemperatureswat" description="Initialize soil temperature by layers to 15 degC for each layer." language="cyml" type="external" filename="algo/pyx/init_soiltemperatureswat.pyx"/>
	<Function name="model_soiltemperatureswat" description="Compute soil temperature by layers using SWAT method with damping depth and lag." language="cyml" type="external" filename="algo/pyx/model_soiltemperatureswat.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/model_soiltemperatureswat.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
