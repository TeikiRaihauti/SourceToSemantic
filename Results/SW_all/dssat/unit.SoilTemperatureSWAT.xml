<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperatureSWAT" name="SoilTemperatureSWAT" timestep="1" version="001">
	<Description>
		<Title>SoilTemperatureSWAT</Title>
		<Authors>Simone Bregaglio</Authors>
		<Institution>University Of Milan</Institution>
		<URI>http://bioma.jrc.ec.europa.eu/ontology/JRC_MARS_biophysical_domain.owl</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Strategy for the calculation of soil temperature with the SWAT method. Based on Neitsch, S.L., Arnold, J.G., Kiniry, J.R., Williams, J.R., King, K.W. Soil and Water Assessment Tool. Theoretical documentation. Version 2000. http://swatmodel.tamu.edu/media/1290/swat2000theory.pdf</ExtendedDescription>
		<ShortDescription>Soil temperature by layers computed using the SWAT method with damping depth, water content scaling, and lag coefficient.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="VolumetricWaterContent" description="Volumetric water content by soil layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="n_layers" max="-" min="-" default="-" unit="m3 m-3" uri="-"/>
		<Input name="LayerThickness" description="Soil layer thicknesses" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="n_layers" max="-" min="-" default="-" unit="m" uri="-"/>
		<Input name="LagCoefficient" description="Temperature lag coefficient" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="AirTemperatureAnnualAverage" description="Annual average air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="BulkDensity" description="Soil bulk density by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="n_layers" max="-" min="-" default="-" unit="t m-3" uri="-"/>
		<Input name="SoilProfileDepth" description="Total soil profile depth" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="m" uri="-"/>
		<Input name="SoilTemperatureByLayers" description="Previous soil temperature by layer (state)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="n_layers" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="SurfaceSoilTemperature" description="Current surface soil temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="SoilTemperatureByLayers_out" description="Updated soil temperature by layer after one step" variablecategory="state" datatype="DOUBLELIST" len="n_layers" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="init_soiltemperatureswat" language="cyml" filename="algo/pyx/init_soiltemperatureswat.pyx"/>
	<Function name="init_soiltemperatureswat" description="Initialization function for SoilTemperatureSWAT; sets all soil layer temperatures to 15 degC." language="cyml" type="external" filename="algo/pyx/init_soiltemperatureswat.pyx"/>
	<Function name="model_soiltemperatureswat" description="Main process function for SoilTemperatureSWAT updating soil temperatures by layer using damping depth influenced by bulk density and moisture." language="cyml" type="external" filename="algo/pyx/model_soiltemperatureswat.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/model_soiltemperatureswat.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
