<?xml version="1.0" ?>
<ModelUnit modelid=".SWAT-based Soil and Surface Temperature Component (SurfaceSWATSoilSWATC)" name="SWAT-based Soil and Surface Temperature Component (SurfaceSWATSoilSWATC)" timestep="1" version="-">
	<Description>
		<Title>SWAT-based Soil and Surface Temperature Component (SurfaceSWATSoilSWATC)</Title>
		<Authors>Simone Bregaglio</Authors>
		<Institution>University of Milan</Institution>
		<URI>SurfaceSWATSoilSWATC.Strategies.SoilTemperatureSWAT</URI>
		<Reference>-</Reference>
		<ExtendedDescription>This C# component implements the SWAT (Soil and Water Assessment Tool) methodology to compute daily soil temperature by layers (SoilTemperatureSWAT) and the companion surface soil temperature (SurfaceTemperatureSWAT). Surface temperature is calculated from air temperature, global solar radiation, albedo, vegetation biomass, and snowpack using SWAT’s cover/snow weighting and radiative heating formulation. Layer temperatures are then updated using a lag approach and a depth damping mechanism parameterized by bulk density, volumetric water content, soil profile depth, and annual average air temperature. Key steps include: (1) total water content (mm) from layer volumetric contents and thickness; (2) maximum damping depth from bulk density: Dmax = 1000 + (2500·BD)/(BD + 686·exp(-5.63·BD)); (3) scaling factor SF = TWCmm / ((0.356 − 0.144·BD)·ProfileDepthmm); (4) damping depth D = Dmax·exp(ln(500/Dmax)·((1−SF)/(1+SF))^2); (5) depth factor DF using the ratio of layer-center depth to D; (6) daily update Ti = Lag·Ti + (1−Lag)·(DF·(TavgAnnual − Tsurf) + Tsurf). Initialization sets all layer temperatures to 15 °C. Parameters: LayerThickness (m), BulkDensity (t m−3), SoilProfileDepth (m), LagCoefficient (−), AirTemperatureAnnualAverage (°C). Inputs: VolumetricWaterContent (m3 m−3) and SurfaceSoilTemperature (°C). Output: SoilTemperatureByLayers (°C). Reference: Neitsch, S.L., Arnold, J.G., Kiniry, J.R., Williams, J.R., King, K.W. SWAT Theoretical Documentation, Version 2000. http://swatmodel.tamu.edu/media/1290/swat2000theory.pdf</ExtendedDescription>
		<ShortDescription>C# implementation of SWAT’s daily soil and surface temperature algorithms computing layer temperatures via damping depth and a lagged update.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="LayerThickness" description="Thickness of each soil layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="m" uri="-"/>
		<Input name="VolumetricWaterContent" description="Volumetric water content per soil layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="m3 m-3" uri="-"/>
		<Input name="SurfaceSoilTemperature" description="Current surface soil temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="SoilTemperatureByLayers" description="Previous day's soil temperature per layer (state)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="LagCoefficient" description="Daily temperature lag coefficient" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1.0" min="0.0" default="-" unit="-" uri="-"/>
		<Input name="AirTemperatureAnnualAverage" description="Annual average air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="BulkDensity" description="Bulk density per soil layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="t m-3" uri="-"/>
		<Input name="SoilProfileDepth" description="Total soil profile depth" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="m" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="SoilTemperatureByLayers" description="Updated soil temperature per layer after processing step" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="Init" description="Initialize soil temperature by layers." language="cyml" type="external" filename="algo/pyx/Init.pyx"/>
	<Function name="CalculateModel" description="Update soil temperature by layers using the SWAT method." language="cyml" type="external" filename="algo/pyx/CalculateModel.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/CalculateModel.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
