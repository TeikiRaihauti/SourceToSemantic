{
    "metadata": {
        "Title": "STMP - Soil temperature calculator (STMPsimCalculator)",
        "Authors": "Gunther Krauss, Andreas Enders",
        "Institution": "Crop Science Group, Katzenburgweg 5, 53115 Bonn, Germany",
        "URI": "http://www.simplace.net",
        "DOI": "-",
        "Extended description": "Calculates the daily average soil temperature at the center of each soil layer using a lagged weighting of yesterday's temperature and an adjustment based on damping depth (function of bulk density and soil water content). Surface temperature and cover effects are considered to estimate the soil surface temperature which drives the layer temperatures.",
        "Short description": "Soil temperature calculation for soil layers (STMP).",
        "Model version": "-"
    },
    "init": {
        "name": "init",
        "firstLine": "Double[] Z = cSoilLayerDepth.getValue();",
        "lastLine": "pSoilLayerDepth.setValue(tz, this);"
    },
    "process": {
        "name": "process",
        "description": "Compute daily soil temperature for each soil layer and update SoilTempArray and rSoilTempArrayRate based on damping depth, surface temperature and previous temperatures.",
        "firstLine": "Double[] tZp = pSoilLayerDepth.getValue();",
        "lastLine": "SoilTempArray.setArrayValue(i, SoilTempArray.getValue()[i] + rSoilTempArrayRate.getValue()[i], this);"
    },
    "inputs": [
        {
            "name": "cSoilLayerDepth",
            "description": "Depth of soil layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "-",
            "min": "0.03",
            "max": "20",
            "default": "-",
            "unit": "metre",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/metre"
        },
        {
            "name": "cFirstDayMeanTemp",
            "description": "Mean air temperature on first day",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-40",
            "max": "50",
            "default": "-",
            "unit": "degree_Celsius",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"
        },
        {
            "name": "cAVT",
            "description": "Constant Temperature of deepest soil layer - use long term mean air temperature",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-10",
            "max": "20",
            "default": "-",
            "unit": "degree_Celsius",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"
        },
        {
            "name": "cABD",
            "description": "Mean bulk density",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "1",
            "max": "4",
            "default": "2",
            "unit": "tonne_per_cubic_metre",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/tonne_per_cubic_metre"
        },
        {
            "name": "cDampingDepth",
            "description": "Initial value for damping depth of soil",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "1.5",
            "max": "20",
            "default": "6",
            "unit": "metre",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/metre"
        },
        {
            "name": "pSoilLayerDepth",
            "description": "Depth of soil layer plus additional depth",
            "inputtype": "variable",
            "category": "auxiliary",
            "datatype": "DOUBLEARRAY",
            "len": "-",
            "min": "0.03",
            "max": "20",
            "default": "-",
            "unit": "metre",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/metre"
        },
        {
            "name": "iSoilWaterContent",
            "description": "Water content, sum of whole soil profile",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "1.5",
            "max": "20",
            "default": "5",
            "unit": "millimetre",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/millimetre"
        },
        {
            "name": "iSoilSurfaceTemperature",
            "description": "Temperature at soil surface",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "1.5",
            "max": "20",
            "default": "-",
            "unit": "degree_Celsius",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"
        },
        {
            "name": "iDoInitialize",
            "description": "Switch to re-initialize the model with initial values.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "false",
            "unit": "one",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/one"
        },
        {
            "name": "SoilTempArray",
            "description": "Array of soil temperatures in layers ",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "-",
            "min": "-40",
            "max": "50",
            "default": "-",
            "unit": "degree_Celsius",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"
        },
        {
            "name": "rSoilTempArrayRate",
            "description": "Array of daily temperature change",
            "inputtype": "variable",
            "category": "rate",
            "datatype": "DOUBLEARRAY",
            "len": "-",
            "min": "-20",
            "max": "20",
            "default": "-",
            "unit": "degree_Celsius_per_day",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius_per_day"
        }
    ],
    "outputs": [
        {
            "name": "SoilTempArray",
            "description": "Array of soil temperatures in layers ",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "-",
            "min": "-40",
            "max": "50",
            "default": "-",
            "unit": "degree_Celsius",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius"
        },
        {
            "name": "rSoilTempArrayRate",
            "description": "Array of daily temperature change",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "-",
            "min": "-20",
            "max": "20",
            "default": "-",
            "unit": "degree_Celsius_per_day",
            "uri": "http://www.wurvoc.org/vocabularies/om-1.8/degree_Celsius_per_day"
        }
    ],
    "functions": [
        {
            "name": "reInitialize",
            "description": "Helper to re-run initialization (calls init() to reset internal arrays and state)."
        }
    ],
    "tests": [
        {
            "name": "fillTestVariables",
            "description": "Single component test to define initial variables and check resulting SoilTempArray after process execution.",
            "inputs": [
                {
                    "name": "cSoilLayerDepth",
                    "value": "[0.1, 0.5, 1.5]"
                },
                {
                    "name": "cFirstDayMeanTemp",
                    "value": "15.0"
                },
                {
                    "name": "cAVT",
                    "value": "9.0"
                },
                {
                    "name": "cABD",
                    "value": "1.4"
                },
                {
                    "name": "cDampingDepth",
                    "value": "6.0"
                },
                {
                    "name": "iSoilWaterContent",
                    "value": "0.3"
                },
                {
                    "name": "iSoilSurfaceTemperature",
                    "value": "6.0"
                }
            ],
            "outputs": [
                {
                    "name": "SoilTempArray",
                    "value": "[13.624360856350041, 13.399968504634286, 12.599999999999845, 12.2, 11.4, 10.6, 9.799999999999999, 9.0]"
                }
            ]
        }
    ]
}