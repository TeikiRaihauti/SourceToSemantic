<?xml version="1.0" ?>
<ModelUnit modelid=".STEMP (DSSAT Soil Temperature Model Component)" name="STEMP (DSSAT Soil Temperature Model Component)" timestep="1" version="-">
	<Description>
		<Title>STEMP (DSSAT Soil Temperature Model Component)</Title>
		<Authors>DSSAT</Authors>
		<Institution>DSSAT Florida</Institution>
		<URI>https://dssat.net</URI>
		<Reference>-</Reference>
		<ExtendedDescription>STEMP is a soil temperature component originating from the DSSAT suite. This C# implementation (SiriusQualitySTEMP_) computes daily soil temperature profiles by combining sinusoidal seasonal forcing (using average annual soil temperature TAV, amplitude TAMP, day of year DOY, and hemisphere-dependent phase HDAY) with damping controlled by soil bulk density (BD), water content (SW, DUL, LL), and profile depth. It maintains a 5-day moving array of mean temperatures (TMA), updates surface temperature (SRFTEMP), layer midpoints (DSMID), cumulative depth (CUMDPT), and layer temperatures (ST). Key parameters include NL, NLAYR, DS, DLAYR, MSALB, XLAT, and a water control switch (ISWWAT). The core routine SOILT computes depth-dependent temperature using an exponential decay from the surface sinusoid modulated by water content and density-derived damping depth.</ExtendedDescription>
		<ShortDescription>Soil temperature profile calculator (DSSAT STEMP) using sinusoidal forcing with depth and soil water/density damping.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="NL" description="Number of soil layers (array length)" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ISWWAT" description="Water simulation control switch (&quot;Y&quot; or other)" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="Y/N" unit="-" uri="-"/>
		<Input name="BD" description="Bulk density per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="g/cm3" uri="-"/>
		<Input name="DLAYR" description="Thickness per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="DS" description="Cumulative depth per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="DUL" description="Water content at drained upper limit per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="LL" description="Lower limit water content per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="NLAYR" description="Number of layers actually used" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="MSALB" description="Soil albedo" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SW" description="Volumetric soil water per layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="XLAT" description="Latitude used to set HDAY reference" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="deg" uri="-"/>
		<Input name="SRAD" description="Solar radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="MJ/m2-d" uri="-"/>
		<Input name="TAVG" description="Average daily temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TMAX" description="Maximum daily temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TAV" description="Annual average temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TAMP" description="Amplitude of annual temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="DOY" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="-" min="-" default="-" unit="day" uri="-"/>
		<Input name="CUMDPT" description="Cumulative profile depth" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="DSMID" description="Depth to midpoint of each layer" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="TDL" description="Total water content at drained upper limit (profile-integrated)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="TMA" description="Last 5 days average soil temperatures (rolling window)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ATOT" description="Sum of last 5 days average soil temperatures" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="SRFTEMP" description="Surface temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ST" description="Soil temperature profile per layer" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="HDAY" description="Reference day in the annual cycle (hemisphere-based)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="day" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="CUMDPT" description="Unchanged cumulative profile depth" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="cm" uri="-"/>
		<Output name="DSMID" description="Unchanged depth to midpoint of each layer" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" unit="cm" uri="-"/>
		<Output name="TDL" description="Updated total water content at drained upper limit (profile-integrated)" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="cm" uri="-"/>
		<Output name="TMA" description="Updated last 5 days average soil temperatures (rolling window)" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ATOT" description="Updated sum of last 5 days average soil temperatures" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="SRFTEMP" description="Updated surface temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ST" description="Updated soil temperature profile per layer" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" unit="degC" uri="-"/>
		<Output name="HDAY" description="Unchanged reference day in the annual cycle" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="day" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="_truncate" description="Truncate a float to a fixed number of decimal places (toward zero)." language="cyml" type="external" filename="algo/pyx/_truncate.pyx"/>
	<Function name="SOILT" description="Compute soil temperatures across layers and surface temperature using damping depth, moisture, and annual cycle." language="cyml" type="external" filename="algo/pyx/SOILT.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/CalculateModel.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
