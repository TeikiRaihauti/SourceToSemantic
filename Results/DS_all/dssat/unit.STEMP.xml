<?xml version="1.0" ?>
<ModelUnit modelid=".STEMP (Soil Temperature Model)" name="STEMP (Soil Temperature Model)" timestep="1" version="1.0">
	<Description>
		<Title>STEMP (Soil Temperature Model)</Title>
		<Authors>DSSAT Team</Authors>
		<Institution>DSSAT Florida</Institution>
		<URI>https://github.com/DSSAT/dssat-csm</URI>
		<Reference>https://doi.org/10.2134/agronj1994.00021962008600060014x</Reference>
		<ExtendedDescription>STEMP computes daily soil temperature by layer using a seasonal cosine forcing around the annual mean soil temperature and a depth-dependent damping term. Damping depth is a function of bulk density and soil water, with albedo and water content affecting heat flux. The module updates a 5â€‘day moving average of soil temperature, surface temperature, and the profile temperatures at each layer midpoint.</ExtendedDescription>
		<ShortDescription>Determines daily soil temperature by layer.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="NL" description="Number of soil layers (alternate count, preserved for interface)" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ISWWAT" description="Water switch ('Y' uses SW-LL, otherwise uses DUL-LL for PESW)" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="BD" description="Bulk density by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DLAYR" description="Layer thickness by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DS" description="Cumulative depth by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DUL" description="Drained upper limit by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="LL" description="Lower limit by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="NLAYR" description="Number of soil layers used for looping" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="MSALB" description="Soil albedo (mapped to ALBEDO, preserved for interface)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SRAD" description="Daily solar radiation (preserved; passed through)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SW" description="Soil water content by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TAVG" description="Daily average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TMAX" description="Daily maximum air temperature (preserved; not used in calculations)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="XLAT" description="Latitude (used in init to determine HDAY; preserved in process signature)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="deg" uri="-"/>
		<Input name="TAV" description="Mean annual air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TAMP" description="Annual temperature amplitude" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="DOY" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="-" min="-" default="-" unit="d" uri="-"/>
		<Input name="CUMDPT" description="Cumulative depth measure used in temperature damping calculations" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DSMID" description="Layer midpoint depths" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TDL" description="Profile sum of DUL*thickness (upper bound used for extractable water computations)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TMA" description="5-day moving average of daily average temperatures" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ATOT" description="Sum of TMA entries (for moving average)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SRFTEMP" description="Soil surface temperature state" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ST" description="Soil temperature by layer" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="HDAY" description="Reference day (phase origin) for annual temperature cycle based on latitude" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="d" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="CUMDPT" description="Cumulative depth measure used in temperature damping calculations (carried forward)" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="DSMID" description="Layer midpoint depths (carried forward)" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" unit="-" uri="-"/>
		<Output name="TDL" description="Updated profile sum of DUL*thickness" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="TMA" description="Updated 5-day moving average of daily average temperatures" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ATOT" description="Updated sum of TMA entries" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="SRFTEMP" description="Updated soil surface temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ST" description="Updated soil temperature profile by layer" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="init_stemp" language="cyml" filename="algo/pyx/init_stemp.pyx"/>
	<Function name="SOILT" description="Compute daily soil temperature profile and surface temperature." language="cyml" type="external" filename="algo/pyx/SOILT.pyx"/>
	<Function name="_trunc" description="Truncate a floating-point number to a fixed number of decimal places (toward zero)." language="cyml" type="external" filename="algo/pyx/_trunc.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/model_stemp.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
