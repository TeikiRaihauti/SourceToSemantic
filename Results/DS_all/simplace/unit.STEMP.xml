<?xml version="1.0" ?>
<ModelUnit modelid=".STEMP (DSSAT Soil Temperature Module, Simplace/Java port)" name="STEMP (DSSAT Soil Temperature Module, Simplace/Java port)" timestep="1" version="-">
	<Description>
		<Title>STEMP (DSSAT Soil Temperature Module, Simplace/Java port)</Title>
		<Authors>-</Authors>
		<Institution>-</Institution>
		<URI>net.simplace.usermodules.amei.DSSAT_ST_standalone.STEMP</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Java implementation of the DSSAT STEMP soil temperature routine as a Simplace FWSimComponent. It initializes soil profile depths and midpoints, aggregates soil water variables at drained upper limit and lower limit, and computes an effective thermal damping depth as a function of bulk density and soil water. The module maintains a 5â€‘day running average of surface temperature (TMA/ATOT) influenced by albedo and radiation, applies a hemispheric phase shift (HDAY=200 for northern, 20 for southern hemisphere), and then calculates surface litter temperature (SRFTEMP) and the temperature in each soil layer (ST) using a damped cosine function of day of year. Key inputs: soil layer properties (BD, DLAYR, DS, DUL, LL), soil water (SW), site/weather (TAVG, TMAX, SRAD, XLAT), and annual temperature parameters (TAV, TAMP, MSALB). Key outputs: CUMDPT, DSMID, TDL, TMA, ATOT, SRFTEMP, and ST.</ExtendedDescription>
		<ShortDescription>Computes daily soil surface and layer temperatures using the DSSAT/EPIC-style STEMP approach with effects of soil water, bulk density, albedo, and radiation.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="NL" description="Number of soil layers (for arrays sized by NL)" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ISWWAT" description="Water simulation control switch (e.g., Y/N)" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="Y" unit="-" uri="-"/>
		<Input name="BD" description="Bulk density per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DLAYR" description="Layer thickness" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="DS" description="Cumulative depth in soil layer L" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="DUL" description="Volumetric water content at Drained Upper Limit per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="LL" description="Volumetric water content at lower limit per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="NLAYR" description="Actual number of soil layers" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="1" default="-" unit="-" uri="-"/>
		<Input name="MSALB" description="Soil albedo with mulch and water effects" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="SRAD" description="Solar radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="SW" description="Volumetric soil water content per layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="NLAYR" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="TAVG" description="Average daily temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TMAX" description="Maximum daily temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="XLAT" description="Latitude" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="90" min="-90" default="-" unit="deg" uri="-"/>
		<Input name="TAV" description="Average annual soil temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TAMP" description="Amplitude for soil temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="degC" uri="-"/>
		<Input name="DOY" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="366" min="1" default="-" unit="-" uri="-"/>
		<Input name="CUMDPT" description="Cumulative profile depth metric used in temperature damping calculations" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="DSMID" description="Depth to midpoint of soil layers used for temperature computation" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="TDL" description="Total water content at Drained Upper Limit across layers" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="TMA" description="Last 5 days of modified air temperatures" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ATOT" description="Sum of TMA values (5-day running total)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="SRFTEMP" description="Surface soil temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ST" description="Soil temperature per layer" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="HDAY" description="Hemispheric reference day used in seasonal temperature phase (computed from latitude)" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="-" default="-" unit="day" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="CUMDPT" description="Cumulative profile depth metric used in temperature damping calculations" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="-" uri="-"/>
		<Output name="DSMID" description="Depth to midpoint of soil layers used for temperature computation" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="0" unit="-" uri="-"/>
		<Output name="TDL" description="Total water content at Drained Upper Limit across layers" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="-" uri="-"/>
		<Output name="TMA" description="Last 5 days of modified air temperatures" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ATOT" description="Sum of TMA values (5-day running total)" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="SRFTEMP" description="Surface soil temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ST" description="Soil temperature per layer" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="init" language="cyml" filename="algo/pyx/init.pyx"/>
	<Function name="_truncate" description="Truncate a float to a fixed number of decimal places (toward zero)." language="cyml" type="external" filename="algo/pyx/_truncate.pyx"/>
	<Function name="Calculate_SOILT" description="Calculate soil temperature profiles and surface temperature using energy balance and damping depth." language="cyml" type="external" filename="algo/pyx/Calculate_SOILT.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/process.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
