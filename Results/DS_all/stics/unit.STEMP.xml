<?xml version="1.0" ?>
<ModelUnit modelid=".STEMP (Soil Temperature) module" name="STEMP (Soil Temperature) module" timestep="1" version="1.0">
	<Description>
		<Title>STEMP (Soil Temperature) module</Title>
		<Authors>DSSAT</Authors>
		<Institution>DSSAT, University of Florida (IFAS) and collaborators</Institution>
		<URI>https://github.com/DSSAT/dssat-csm</URI>
		<Reference>https://doi.org/10.2134/agronj1994.00021962008600060014x</Reference>
		<ExtendedDescription>STEMP computes daily soil temperature by layer using a sinusoidal annual forcing around an average annual soil temperature (TAV) with amplitude (TAMP). Thermal damping depth depends on bulk density and soil water status, and a 5â€‘day moving average of recent temperatures adjusts the surface forcing. The module provides surface temperature and soil temperatures at the midpoint of each soil layer.</ExtendedDescription>
		<ShortDescription>Determines soil temperature by layer.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="NL" description="Total number of soil layers for output arrays" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ISWWAT" description="Water switch (Y/N) controlling available water use in temperature routine" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="BD" description="Bulk density by soil layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DLAYR" description="Soil layer thickness" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DS" description="Cumulative depth to bottom of each layer (used to derive midpoints)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DUL" description="Drained upper limit by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="LL" description="Lower limit by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="NLAYR" description="Number of soil layers with properties" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="MSALB" description="Soil albedo" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SRAD" description="Solar radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SW" description="Soil water content by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TAVG" description="Daily average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TMAX" description="Daily maximum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="XLAT" description="Latitude" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TAV" description="Annual average air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TAMP" description="Annual amplitude of air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DOY" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="CUMDPT" description="Cumulative soil depth used in temperature damping computations" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DSMID" description="Depth to midpoint of each soil layer" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TDL" description="Cumulative drained upper limit term (sum of DUL*thickness)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="TMA" description="Last 5 days moving average of temperatures" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ATOT" description="Sum of the last 5 daily average temperatures (sum of TMA)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SRFTEMP" description="Surface soil temperature (previous step)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ST" description="Soil temperature by layer (previous step)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="HDAY" description="Hemisphere-based seasonal phase day used in temperature cycle" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="CUMDPT" description="Cumulative soil depth used in temperature damping computations" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="DSMID" description="Depth to midpoint of each soil layer" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" unit="-" uri="-"/>
		<Output name="TDL" description="Cumulative drained upper limit term (sum of DUL*thickness)" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="TMA" description="Last 5 days moving average of temperatures" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" unit="-" uri="-"/>
		<Output name="ATOT" description="Sum of the last 5 daily average temperatures (sum of TMA)" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="SRFTEMP" description="Surface soil temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="ST" description="Soil temperature by layer" variablecategory="state" datatype="DOUBLELIST" len="NL" max="-" min="-" unit="-" uri="-"/>
	</Outputs>
	<Initialization name="init_stemp" language="cyml" filename="algo/pyx/init_stemp.pyx"/>
	<Function name="_trunc" description="Truncate toward zero to a fixed number of decimals." language="cyml" type="external" filename="algo/pyx/_trunc.pyx"/>
	<Function name="SOILT" description="Compute soil temperature profile and surface temperature." language="cyml" type="external" filename="algo/pyx/SOILT.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/model_stemp.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
