<?xml version="1.0" ?>
<ModelUnit modelid=".STEMP" name="STEMP" timestep="1" version="1.0">
	<Description>
		<Title>STEMP</Title>
		<Authors>DSSAT</Authors>
		<Institution>DSSAT Florida</Institution>
		<URI>https://dssat.net</URI>
		<Reference>https://doi.org/10.2134/agronj1994.00021962008600060014x</Reference>
		<ExtendedDescription>STEMP is the DSSAT soil temperature module that computes daily soil temperature by soil layer using a damped cosine function of day-of-year around a mean annual temperature. Damping depth and profile are influenced by bulk density, soil water, and albedo; the module also maintains a 5-day moving average and provides surface litter temperature and layer midpoint temperatures.</ExtendedDescription>
		<ShortDescription>Determines soil temperature by layer.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="NL" description="Number of soil layers" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ISWWAT" description="Water simulation control switch (&quot;Y&quot; or &quot;N&quot;)" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="Y/N" unit="-" uri="-"/>
		<Input name="BD" description="Bulk density per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="NL" max="-" min="-" default="-" unit="g/cm3" uri="-"/>
		<Input name="DLAYR" description="Thickness of soil layer L" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="NL" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="DS" description="Cumulative depth per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="NL" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="DUL" description="Volumetric water at drained upper limit per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="NL" max="-" min="-" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="LL" description="Volumetric water at lower limit per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="NL" max="-" min="-" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="NLAYR" description="Actual number of soil layers" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="MSALB" description="Soil albedo including mulch/water effects" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="fraction" uri="-"/>
		<Input name="SW" description="Current volumetric soil water per layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="NL" max="-" min="-" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="XLAT" description="Latitude" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="deg" uri="-"/>
		<Input name="SRAD" description="Solar radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="MJ/m2-d" uri="-"/>
		<Input name="TAVG" description="Average daily air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TMAX" description="Maximum daily air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TAV" description="Average annual soil temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TAMP" description="Amplitude of annual soil temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="DOY" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="366" min="1" default="-" unit="doy" uri="-"/>
		<Input name="CUMDPT" description="Cumulative depth of soil profile" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="mm" uri="-"/>
		<Input name="DSMID" description="Depth to midpoint of soil layers" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="NL" max="-" min="-" default="-" unit="mm" uri="-"/>
		<Input name="TDL" description="Total water at drained upper limit in profile (cumulative)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="TMA" description="Previous 5 days average soil temperatures" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="5" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ATOT" description="Sum of last 5 days soil temperatures" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="SRFTEMP" description="Surface (litter) temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ST" description="Soil temperature in each soil layer" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="NL" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="HDAY" description="Reference day used for annual temperature phase based on latitude" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="doy" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="CUMDPT" description="Cumulative depth of soil profile" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="mm" uri="-"/>
		<Output name="DSMID" description="Depth to midpoint of soil layers" variablecategory="state" datatype="DOUBLEARRAY" len="NL" max="-" min="-" unit="mm" uri="-"/>
		<Output name="TDL" description="Total water at drained upper limit in profile (cumulative)" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="cm" uri="-"/>
		<Output name="TMA" description="Previous 5 days average soil temperatures" variablecategory="state" datatype="DOUBLEARRAY" len="5" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ATOT" description="Sum of last 5 days soil temperatures" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="SRFTEMP" description="Surface (litter) temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ST" description="Soil temperature in each soil layer" variablecategory="state" datatype="DOUBLEARRAY" len="NL" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="_truncate" description="Truncate a float to a given number of decimal places without rounding." language="cyml" type="external" filename="algo/pyx/_truncate.pyx"/>
	<Function name="SOILT" description="Compute soil temperature profile and surface temperature for one time step." language="cyml" type="external" filename="algo/pyx/SOILT.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/CalculateModel.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
