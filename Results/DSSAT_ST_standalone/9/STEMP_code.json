{
    "init": {
        "name": "STEMP"
    },
    "process": {
        "name": "STEMP",
        "description": "Determines soil temperature by layer; performs seasonal initialization when CONTROL_DYNAMIC==2 and daily rate calculations when CONTROL_DYNAMIC==3."
    },
    "inputs": [
        {
            "name": "CONTROL_DYNAMIC",
            "description": "Controls phase: 2=SEASINIT, 3=RATE, 5=OUTPUT, 6=SEASEND",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "CONTROL_YRDOY",
            "description": "Composite year-day of year (YYYY*1000 + DOY)",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "ISWITCH_ISWWAT",
            "description": "Water balance switch ('Y' uses soil water, 'N' uses DUL)",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SOILPROP_BD",
            "description": "Bulk density by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SOILPROP_DLAYR",
            "description": "Layer thickness by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SOILPROP_DS",
            "description": "Cumulative depth by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SOILPROP_DUL",
            "description": "Drained upper limit by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SOILPROP_LL",
            "description": "Lower limit by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SOILPROP_NLAYR",
            "description": "Number of soil layers",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SOILPROP_MSALB",
            "description": "Mulch/soil albedo",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SRAD",
            "description": "Daily solar radiation (not used in calculations here)",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "SW",
            "description": "Soil water by layer",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "TAVG",
            "description": "Daily average surface temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "TMAX",
            "description": "Daily maximum temperature (not used in calculations here)",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "XLAT",
            "description": "Latitude (sign indicates hemisphere)",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg",
            "uri": ""
        },
        {
            "name": "TAV",
            "description": "Average annual temperature",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "TAMP",
            "description": "Annual temperature amplitude",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "CUMDPT",
            "description": "Cumulative profile depth",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": ""
        },
        {
            "name": "DSMID",
            "description": "Depth to middle of each layer",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": ""
        },
        {
            "name": "TDL",
            "description": "Running sum variable used in water-related calculations",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "TMA",
            "description": "Moving average memory (5-day)",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "ATOT",
            "description": "Running total of TMA entries",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "SRFTEMP",
            "description": "Surface temperature",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "CONTROL_RUN",
            "description": "Run counter used during seasonal initialization",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "CONTROL_RNMODE",
            "description": "Run mode flag (e.g., 'B','Q','F') used during seasonal initialization",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        }
    ],
    "outputs": [
        {
            "name": "CUMDPT",
            "description": "Updated cumulative profile depth",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": ""
        },
        {
            "name": "DSMID",
            "description": "Updated depth to middle of each layer",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": ""
        },
        {
            "name": "TDL",
            "description": "Updated running sum variable used in water-related calculations",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": ""
        },
        {
            "name": "TMA",
            "description": "Updated moving average memory (5-day)",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "ATOT",
            "description": "Updated running total of TMA entries",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "SRFTEMP",
            "description": "Updated surface temperature",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        },
        {
            "name": "ST",
            "description": "Updated soil temperature by layer",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg C",
            "uri": ""
        }
    ],
    "functions": [
        {
            "name": "YR_DOY",
            "description": "Converts composite YRDOY to (year, day of year)."
        },
        {
            "name": "SOILT",
            "description": "Core soil temperature calculation by layer using sinusoidal annual forcing and damping with depth."
        },
        {
            "name": "_expand_to_layers",
            "description": "Expands a scalar or short sequence to a list of length NLAYR."
        },
        {
            "name": "_nint4",
            "description": "Rounds a float to 4 decimals using Fortran-like NINT behavior."
        }
    ],
    "tests": [
        {
            "name": "-",
            "description": "-",
            "inputs": [
                {
                    "name": "-",
                    "value": "-"
                }
            ],
            "outputs": [
                {
                    "name": "-",
                    "value": "-"
                }
            ]
        }
    ],
    "comments": [
        {
            "comment": "Initialization and daily rate logic are both implemented in STEMP, selected via CONTROL_DYNAMIC; thus STEMP is both the init and process function."
        },
        {
            "comment": "State variables treated as InOut: CUMDPT, DSMID, TDL, TMA, ATOT, SRFTEMP, ST."
        },
        {
            "comment": "SRAD and TMAX are accepted but not used in current computations; kept for interface fidelity."
        },
        {
            "comment": "Units for several soil property arrays (BD, DUL, LL, SW, DLAYR, DS) are not explicitly stated in code; left as '-'."
        },
        {
            "comment": "SOILT is the internal routine performing per-layer temperature calculations; it is invoked during both initialization (warm-up iterations) and daily steps."
        }
    ]
}