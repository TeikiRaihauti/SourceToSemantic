{
    "init": {
        "name": "STEMP"
    },
    "process": {
        "name": "STEMP",
        "description": "Determines soil temperature by layer; handles seasonal initialization (CONTROL_DYNAMIC=2) and daily rate update (CONTROL_DYNAMIC=3)."
    },
    "inputs": [
        {
            "name": "CONTROL_DYNAMIC",
            "description": "Dynamic phase selector (2=SEASINIT, 3=RATE).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "CONTROL_YRDOY",
            "description": "Composite year-day-of-year code (e.g., 2024123).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "YYYYDOY",
            "uri": "-"
        },
        {
            "name": "CONTROL_RUN",
            "description": "Run number.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "CONTROL_RNMODE",
            "description": "Run mode flag.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "ISWITCH_ISWWAT",
            "description": "Water simulation switch ('Y' or 'N').",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_BD",
            "description": "Bulk density by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "g/cm3",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DLAYR",
            "description": "Layer thickness by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DS",
            "description": "Depth to bottom of each layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DUL",
            "description": "Drained upper limit (volumetric) by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "SOILPROP_LL",
            "description": "Lower limit (volumetric) by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "SOILPROP_NLAYR",
            "description": "Number of soil layers.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_MSALB",
            "description": "Soil/mulch albedo.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SRAD",
            "description": "Daily solar radiation.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "MJ/m2-d",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Soil water content (volumetric) by layer.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Average air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Maximum air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "XLAT",
            "description": "Latitude.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "deg",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Annual average air temperature.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TAMP",
            "description": "Annual amplitude of air temperature.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Cumulative profile depth.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to midpoint of each layer.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Sum of DUL*thickness across profile.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "5-day moving average queue (most recent first).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Sum of TMA elements.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface temperature.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "CUMDPT",
            "description": "Cumulative profile depth (possibly updated at SEASINIT).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to midpoint of each layer (possibly updated at SEASINIT).",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Sum of DUL*thickness across profile (updated).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "5-day moving average queue (updated).",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Sum of TMA elements (updated).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface temperature (updated).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer (updated).",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "_nint",
            "description": "Nearest-integer rounding (halves away from zero)."
        },
        {
            "name": "_round_nint",
            "description": "Rounding to specified decimals using Fortran-like NINT."
        },
        {
            "name": "YR_DOY",
            "description": "Computes (YEAR, DOY) from an integer YRDOY code."
        },
        {
            "name": "SOILT",
            "description": "Computes soil temperature by layer and surface temperature; updates 5-day moving average (TMA) and its sum (ATOT)."
        }
    ],
    "tests": [
        {
            "name": "test_STEMP_basic",
            "description": "Basic smoke test ensuring STEMP runs without errors for SEASINIT and RATE.",
            "inputs": [
                {
                    "name": "CONTROL_DYNAMIC (call 1)",
                    "value": "2"
                },
                {
                    "name": "CONTROL_YRDOY",
                    "value": "2021100"
                },
                {
                    "name": "CONTROL_RUN",
                    "value": "1"
                },
                {
                    "name": "CONTROL_RNMODE",
                    "value": "B"
                },
                {
                    "name": "ISWITCH_ISWWAT",
                    "value": "Y"
                },
                {
                    "name": "SOILPROP_BD",
                    "value": [
                        1.6,
                        1.5,
                        1.4,
                        1.3
                    ]
                },
                {
                    "name": "SOILPROP_DLAYR",
                    "value": [
                        100.0,
                        100.0,
                        100.0,
                        100.0
                    ]
                },
                {
                    "name": "SOILPROP_DS",
                    "value": [
                        10.0,
                        20.0,
                        30.0,
                        40.0
                    ]
                },
                {
                    "name": "SOILPROP_DUL",
                    "value": [
                        0.3,
                        0.3,
                        0.3,
                        0.3
                    ]
                },
                {
                    "name": "SOILPROP_LL",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "SOILPROP_NLAYR",
                    "value": "4"
                },
                {
                    "name": "SOILPROP_MSALB",
                    "value": "0.13"
                },
                {
                    "name": "SRAD",
                    "value": "20.0"
                },
                {
                    "name": "SW",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "TAVG",
                    "value": "25.0"
                },
                {
                    "name": "TMAX",
                    "value": "30.0"
                },
                {
                    "name": "XLAT",
                    "value": "28.0"
                },
                {
                    "name": "TAV",
                    "value": "20.0"
                },
                {
                    "name": "TAMP",
                    "value": "10.0"
                },
                {
                    "name": "CUMDPT (init)",
                    "value": "0.0"
                },
                {
                    "name": "DSMID (init)",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                {
                    "name": "TDL (init)",
                    "value": "0.0"
                },
                {
                    "name": "TMA (init)",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                {
                    "name": "ATOT (init)",
                    "value": "0.0"
                },
                {
                    "name": "SRFTEMP (init)",
                    "value": "0.0"
                },
                {
                    "name": "ST (init)",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                {
                    "name": "CONTROL_DYNAMIC (call 2)",
                    "value": "3"
                }
            ],
            "outputs": [
                {
                    "name": "-",
                    "value": "-"
                }
            ]
        }
    ],
    "comments": [
        {
            "comment": "STEMP is both the initialization and main process function; seasonal init occurs when CONTROL_DYNAMIC==2, and daily updates occur when CONTROL_DYNAMIC==3."
        },
        {
            "comment": "Units for BD (g/cm3) are inferred; other units follow docstrings (e.g., DS in cm, DLAYR/DSMID/CUMDPT in mm, temperatures in degC)."
        },
        {
            "comment": "SRAD and TMAX are passed through but not used by SOILT in this implementation; they are retained for interface parity."
        },
        {
            "comment": "State variables (CUMDPT, DSMID, TDL, TMA, ATOT, SRFTEMP, ST) are treated as both inputs and outputs as they are updated in-place across calls."
        },
        {
            "comment": "The provided test performs no assertions; expected outputs are unspecified."
        }
    ]
}