{
    "init": {
        "name": "STEMP"
    },
    "process": {
        "name": "STEMP",
        "description": "Determines soil temperature by layer; performs seasonal initialization (SEASINIT) and daily updates (RATE) using SOILT."
    },
    "inputs": [
        {
            "name": "CONTROL_DYNAMIC",
            "description": "Dynamic phase selector (e.g., 2=SEASINIT, 3=RATE).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "CONTROL_YRDOY",
            "description": "Composite year-day-of-year (YYYYDDD) used to compute DOY.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "YYYYDDD",
            "uri": "-"
        },
        {
            "name": "CONTROL_RUN",
            "description": "Run number used during seasonal initialization logic.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "CONTROL_RNMODE",
            "description": "Run mode flag used during seasonal initialization logic.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "ISWITCH_ISWWAT",
            "description": "Water simulation switch ('Y' uses actual soil water SW; 'N' uses DUL).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "Y",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_BD",
            "description": "Bulk density by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "g/cm3",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DLAYR",
            "description": "Layer thickness by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DS",
            "description": "Cumulative depth to bottom of each layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DUL",
            "description": "Drained upper limit (volumetric water content) by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "SOILPROP_LL",
            "description": "Lower limit (volumetric water content) by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "SOILPROP_NLAYR",
            "description": "Number of soil layers.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "1",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_MSALB",
            "description": "Soil/mulch albedo.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SRAD",
            "description": "Daily solar radiation (passed to SOILT; not used by the equations).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "MJ/m2/d",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Soil water content by layer (volumetric).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "cm3/cm3",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Daily average air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Daily maximum air temperature (passed to SOILT; not used by the equations).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "XLAT",
            "description": "Latitude; sign determines hemisphere for initialization.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-90",
            "max": "90",
            "default": "-",
            "unit": "deg",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Annual average air temperature.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TAMP",
            "description": "Annual temperature amplitude.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Cumulative profile depth used in temperature calculations (set during initialization).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to midpoint of each soil layer (set during initialization).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Profile sum of DUL*layer_thickness (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "5-day moving average memory of TAVG (most recent first).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Sum of TMA elements (degC).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface temperature.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "CUMDPT",
            "description": "Cumulative profile depth (updated during initialization).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to midpoint of each soil layer (updated during initialization).",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "SOILPROP_NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Profile sum of DUL*layer_thickness (updated).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "5-day moving average memory (updated).",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Sum of TMA elements (updated).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface temperature (updated).",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer (updated).",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "SOILPROP_NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "YR_DOY",
            "description": "Computes (YEAR, DOY) from an integer YRDOY code."
        },
        {
            "name": "SOILT",
            "description": "Computes soil temperature by layer and surface temperature; updates TMA and ATOT."
        },
        {
            "name": "OPSTEMP",
            "description": "Outputs soil temperature diagnostics for reporting."
        }
    ],
    "tests": [
        {
            "name": "test_STEMP_basic",
            "description": "Seasonal initialization followed by one daily update (no numeric assertions).",
            "inputs": [
                {
                    "name": "CONTROL_DYNAMIC (call 1)",
                    "value": "2"
                },
                {
                    "name": "CONTROL_YRDOY",
                    "value": "2021100"
                },
                {
                    "name": "CONTROL_RUN",
                    "value": "1"
                },
                {
                    "name": "CONTROL_RNMODE",
                    "value": "B"
                },
                {
                    "name": "ISWITCH_ISWWAT",
                    "value": "Y"
                },
                {
                    "name": "SOILPROP_NLAYR",
                    "value": "4"
                },
                {
                    "name": "SOILPROP_BD",
                    "value": [
                        1.6,
                        1.5,
                        1.4,
                        1.3
                    ]
                },
                {
                    "name": "SOILPROP_DLAYR",
                    "value": [
                        10.0,
                        10.0,
                        10.0,
                        10.0
                    ]
                },
                {
                    "name": "SOILPROP_DS",
                    "value": [
                        10.0,
                        20.0,
                        30.0,
                        40.0
                    ]
                },
                {
                    "name": "SOILPROP_DUL",
                    "value": [
                        0.3,
                        0.3,
                        0.3,
                        0.3
                    ]
                },
                {
                    "name": "SOILPROP_LL",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "SOILPROP_MSALB",
                    "value": "0.13"
                },
                {
                    "name": "SRAD",
                    "value": "20.0"
                },
                {
                    "name": "SW",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "TAVG",
                    "value": "25.0"
                },
                {
                    "name": "TMAX",
                    "value": "30.0"
                },
                {
                    "name": "XLAT",
                    "value": "28.0"
                },
                {
                    "name": "TAV",
                    "value": "20.0"
                },
                {
                    "name": "TAMP",
                    "value": "10.0"
                },
                {
                    "name": "CUMDPT (init)",
                    "value": "0.0"
                },
                {
                    "name": "DSMID (init)",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                {
                    "name": "TDL (init)",
                    "value": "0.0"
                },
                {
                    "name": "TMA (init)",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                {
                    "name": "ATOT (init)",
                    "value": "0.0"
                },
                {
                    "name": "SRFTEMP (init)",
                    "value": "0.0"
                },
                {
                    "name": "ST (init)",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                {
                    "name": "CONTROL_DYNAMIC (call 2)",
                    "value": "3"
                }
            ],
            "outputs": [
                {
                    "name": "-",
                    "value": "-"
                }
            ]
        }
    ],
    "comments": [
        {
            "comment": "STEMP serves as both initializer (SEASINIT) and daily process (RATE); no separate init routine exists."
        },
        {
            "comment": "Units: DS and DLAYR are in cm; CUMDPT and DSMID are in mm; volumetric water contents (SW, DUL, LL) are cm3/cm3; BD is g/cm3; temperatures are degC."
        },
        {
            "comment": "TDL is computed in cm and, per the source, is incremented each RATE call (accumulating); PESW uses TSW−TLL (or TDL−TLL if ISWWAT='N')."
        },
        {
            "comment": "SRAD, TMAX, and MSALB (albedo) are passed to SOILT but are not used by the current equations."
        },
        {
            "comment": "Array lengths for per-layer variables reference SOILPROP_NLAYR; TMA length is 5."
        }
    ]
}