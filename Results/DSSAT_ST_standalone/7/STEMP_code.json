{
    "init": {
        "name": "STEMP"
    },
    "process": {
        "name": "STEMP",
        "description": "Soil temperature component that performs initialization (CONTROL_DYNAMIC==2) and daily updates (CONTROL_DYNAMIC==3), computing soil temperature profile, surface temperature, and updating moving temperature averages using SOILT."
    },
    "inputs": [
        {
            "name": "CONTROL_DYNAMIC",
            "description": "Simulation phase control flag (e.g., 2=SEASINIT, 3=RATE).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "CONTROL_YRDOY",
            "description": "Date in YYYYDDD used to compute day-of-year.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "1000001",
            "max": "9999366",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "ISWITCH_ISWWAT",
            "description": "Water switch (Y uses actual soil water, otherwise uses DUL).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "Y",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_BD",
            "description": "Bulk density by soil layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DLAYR",
            "description": "Layer thickness by soil layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DS",
            "description": "Cumulative depth to bottom of each layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DUL",
            "description": "Drained upper limit by soil layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_LL",
            "description": "Lower limit (LL) by soil layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_NLAYR",
            "description": "Number of soil layers.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "1",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_MSALB",
            "description": "Bare soil surface albedo.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "1.0",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SRAD",
            "description": "Daily solar radiation.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Soil water content by layer.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Daily average air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Daily maximum air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "XLAT",
            "description": "Latitude used to set seasonal heat day (HDAY).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-90.0",
            "max": "90.0",
            "default": "-",
            "unit": "degrees",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Long-term average annual air temperature.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TAMP",
            "description": "Amplitude of annual temperature variation.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Cumulative damping depth or depth-related state used in temperature calculations.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.0",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to midpoint of each soil layer.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "[]",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Profile total at drained upper limit (sum over layers).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "0.0",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "5-day moving average air temperatures used for soil temperature computation.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "[0,0,0,0,0]",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Sum of TMA values over the last 5 days.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.0",
            "unit": "degC*day",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface soil temperature.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.0",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer.",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "[]",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "CUMDPT",
            "description": "Updated cumulative depth-related state for temperature damping.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Updated depth to midpoint of each soil layer.",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Updated profile total at drained upper limit.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "0.0",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Updated 5-day moving average temperatures.",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Updated 5-day temperature sum.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC*day",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Updated surface soil temperature.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Updated soil temperature profile by layer.",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "YR_DOY",
            "description": "Converts YRDOY (YYYYDDD) into (YEAR, DOY)."
        },
        {
            "name": "_fortran_nint",
            "description": "Fortran-style NINT rounding: nearest integer with halves away from zero."
        },
        {
            "name": "_fortran_round",
            "description": "Rounds a float to given decimals using Fortran NINT semantics."
        },
        {
            "name": "SOILT",
            "description": "Computes soil temperature profile and surface temperature using soil properties, climate, and moisture; updates TMA and ATOT."
        }
    ],
    "tests": [
        {
            "name": "test_STEMP_basic_from_ASKEE",
            "description": "Initializes STEMP (SEASINIT) and runs one RATE step, returning states for inspection.",
            "inputs": [
                {
                    "name": "CONTROL_DYNAMIC",
                    "value": 2
                },
                {
                    "name": "CONTROL_YRDOY",
                    "value": 2021100
                },
                {
                    "name": "ISWITCH_ISWWAT",
                    "value": "Y"
                },
                {
                    "name": "SOILPROP_NLAYR",
                    "value": 4
                },
                {
                    "name": "SOILPROP_BD",
                    "value": [
                        1.6,
                        1.6,
                        1.6,
                        1.6
                    ]
                },
                {
                    "name": "SOILPROP_DLAYR",
                    "value": [
                        10.0,
                        10.0,
                        10.0,
                        10.0
                    ]
                },
                {
                    "name": "SOILPROP_DS",
                    "value": [
                        10.0,
                        20.0,
                        30.0,
                        40.0
                    ]
                },
                {
                    "name": "SOILPROP_DUL",
                    "value": [
                        0.3,
                        0.3,
                        0.3,
                        0.3
                    ]
                },
                {
                    "name": "SOILPROP_LL",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "SOILPROP_MSALB",
                    "value": 0.13
                },
                {
                    "name": "SRAD",
                    "value": 20.0
                },
                {
                    "name": "SW",
                    "value": [
                        0.2,
                        0.2,
                        0.2,
                        0.2
                    ]
                },
                {
                    "name": "TAVG",
                    "value": 25.0
                },
                {
                    "name": "TMAX",
                    "value": 30.0
                },
                {
                    "name": "XLAT",
                    "value": 28.0
                },
                {
                    "name": "TAV",
                    "value": 20.0
                },
                {
                    "name": "TAMP",
                    "value": 10.0
                },
                {
                    "name": "CUMDPT",
                    "value": 0.0
                },
                {
                    "name": "DSMID",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                {
                    "name": "TDL",
                    "value": 0.0
                },
                {
                    "name": "TMA",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                {
                    "name": "ATOT",
                    "value": 0.0
                },
                {
                    "name": "SRFTEMP",
                    "value": 0.0
                },
                {
                    "name": "ST",
                    "value": [
                        0.0,
                        0.0,
                        0.0,
                        0.0
                    ]
                }
            ],
            "outputs": []
        }
    ]
}