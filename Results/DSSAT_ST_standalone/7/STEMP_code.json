{
    "init": {
        "name": "STEMP"
    },
    "process": {
        "name": "STEMP",
        "description": "Determines soil temperature by layer; performs seasonal initialization (SEASINIT) and daily rate calculations (RATE)."
    },
    "inputs": [
        {
            "name": "control_dynamic",
            "description": "Control flag for model phase (use 2 for SEASINIT, 3 for RATE).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "control_yrdoy",
            "description": "Date as YYYYDDD used to derive day of year.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "control_run",
            "description": "Run number indicator.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "control_rnmode",
            "description": "Run mode code (e.g., 'B','Q','F',...).",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "iswitch_iswwat",
            "description": "Water simulation switch ('Y' or 'N').",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "Y",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "soilprop_bd",
            "description": "Soil bulk density by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "soilprop_dlayr",
            "description": "Soil layer thicknesses.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "soilprop_ds",
            "description": "Cumulative soil depth to layer bottoms.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "soilprop_dul",
            "description": "Drained upper limit (field capacity) by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "soilprop_ll",
            "description": "Lower limit (wilting point) by layer.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLELIST",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "soilprop_nlayr",
            "description": "Number of soil layers.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "soilprop_msalb",
            "description": "Soil albedo for moisture conditions.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.13",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SRAD",
            "description": "Daily solar radiation.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Soil water content by layer.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLELIST",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Daily average air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Daily maximum air temperature.",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "XLAT",
            "description": "Latitude (degrees; sign determines hemisphere).",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degree",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Average annual air temperature.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TAMP",
            "description": "Annual temperature amplitude.",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Cumulative depth for thermal calculations (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.0",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to midpoint of each soil layer (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "[0.0]*NLAYR",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Total drained upper limit (state accumulator).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.0",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Running 5-day average of TAVG (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "[0.0]*5",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Sum of last 5 daily average temperatures (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.0",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface soil temperature (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "0.0",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer (state).",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLELIST",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "[0.0]*NLAYR",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "CUMDPT",
            "description": "Updated cumulative depth for thermal calculations.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Updated depth to midpoint of each soil layer.",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Updated total drained upper limit accumulator.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Updated running 5-day average array.",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Updated sum of the last 5 daily average temperatures.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Updated surface soil temperature.",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Updated soil temperature by layer.",
            "datatype": "DOUBLELIST",
            "category": "state",
            "len": "soilprop_nlayr",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "fortran_nint",
            "description": "Fortran NINT-equivalent: nearest integer with ties away from zero."
        },
        {
            "name": "YR_DOY",
            "description": "Convert YRDOY (YYYYDDD) to (YEAR, DOY)."
        },
        {
            "name": "SOILT",
            "description": "Computes soil temperature profile and surface temperature given forcing and soil properties."
        },
        {
            "name": "STEMP",
            "description": "Main component: seasonal initialization (SEASINIT) and daily rate (RATE) computations for soil temperature."
        },
        {
            "name": "test_STEMP_basic",
            "description": "Basic sanity test to exercise initialization and one rate step; checks types and lengths."
        }
    ],
    "tests": [
        {
            "name": "test_STEMP_basic",
            "description": "Initialization (SEASINIT) followed by one RATE step; asserts SRFTEMP is float and array lengths are correct.",
            "inputs": [
                {
                    "name": "control_dynamic_init",
                    "value": "2"
                },
                {
                    "name": "control_dynamic_rate",
                    "value": "3"
                },
                {
                    "name": "NLAYR",
                    "value": "4"
                }
            ],
            "outputs": [
                {
                    "name": "type(SRFTEMP)_after_init",
                    "value": "float"
                },
                {
                    "name": "len(ST)_after_init",
                    "value": "4"
                },
                {
                    "name": "len(TMA)_after_init",
                    "value": "5"
                },
                {
                    "name": "type(SRFTEMP)_after_rate",
                    "value": "float"
                },
                {
                    "name": "len(ST)_after_rate",
                    "value": "4"
                },
                {
                    "name": "len(TMA)_after_rate",
                    "value": "5"
                }
            ]
        }
    ],
    "comments": [
        {
            "comment": "STEMP serves both as initialization (when control_dynamic==2) and as the main daily process (when control_dynamic==3); thus it is listed as both init and process."
        },
        {
            "comment": "Units are not specified in code; '-' used where unknown."
        },
        {
            "comment": "Array lengths are described relative to soilprop_nlayr; TMA has a fixed length of 5."
        },
        {
            "comment": "State variables are treated as both inputs and outputs per instructions: CUMDPT, DSMID, TDL, TMA, ATOT, SRFTEMP, ST."
        },
        {
            "comment": "Test asserts only on types and lengths; no fixed numeric expected values are provided."
        }
    ]
}