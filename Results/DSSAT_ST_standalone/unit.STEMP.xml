<?xml version="1.0" ?>
<ModelUnit modelid=".STEMP: Soil Temperature Module (DSSAT component)" name="STEMP: Soil Temperature Module (DSSAT component)" timestep="1" version="1.0">
	<Description>
		<Title>STEMP: Soil Temperature Module (DSSAT component)</Title>
		<Authors>DSSAT Development Team (DSSAT Florida)</Authors>
		<Institution>The University of Georgia; University of Florida; Iowa State University; International Center for Soil Fertility and Agricultural Development (IFDC); University of Guelph</Institution>
		<URI>https://github.com/DSSAT/dssat-csm</URI>
		<Reference>https://doi.org/10.2134/agronj1994.00021962008600060014x</Reference>
		<ExtendedDescription>STEMP computes daily soil temperature by layer for the DSSAT crop modeling system using EPIC-derived harmonic formulations. It updates a 5-day moving average of mean air temperature and uses long-term mean temperature (TAV) and amplitude (TAMP) to drive a sinusoidal annual signal shifted by the climatological hottest day (HDAY). Damping depth (DP) is a function of bulk density (ABD) and a moisture-dependent factor (FX), with the water content ratio WC = max(0.01, PESW)/(WW*CUMDPT)*10 influencing thermal damping. Layer temperatures are calculated at layer midpoints (DSMID) as a decaying cosine with depth, and a surface litter temperature (SRFTEMP) is also provided. The routine accounts for soil albedo (including mulch effects) and distinguishes whether soil water is simulated (ISWWAT). It is adapted from EPIC soil temperature routines and is widely used across DSSAT components.</ExtendedDescription>
		<ShortDescription>Daily multilayer soil temperature calculation for DSSAT using EPIC-based damping and sinusoidal forcing.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="ISWITCH_ISWWAT" description="Water balance switch ('Y' if simulated, 'N' otherwise)" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SOILPROP_BD" description="Bulk density by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SOILPROP_DS" description="Cumulative depth to bottom of each layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="SOILPROP_DUL" description="Drained upper limit by layer (volumetric)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="SOILPROP_LL" description="Lower limit by layer (volumetric)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="SOILPROP_NLAYR" description="Number of soil layers" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="1" default="-" unit="-" uri="-"/>
		<Input name="SOILPROP_MSALB" description="Soil albedo (including mulch/water effects)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="SOILPROP_DLAYR" description="Layer thickness by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="-" min="-" default="-" unit="mm" uri="-"/>
		<Input name="SRAD" description="Solar radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="SW" description="Soil water content by layer (volumetric)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="TAVG" description="Today's average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TMAX" description="Today's maximum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="XLAT" description="Latitude (degrees; &lt;0 southern hemisphere)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="90" min="-90" default="-" unit="deg" uri="-"/>
		<Input name="TAV" description="Annual average air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TAMP" description="Annual amplitude of air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="degC" uri="-"/>
		<Input name="CUMDPT" description="Profile depth" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="DSMID" description="Depth to mid-point of each layer" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="TDL" description="Cumulative DUL-weighted depth (seasonal state)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="TMA" description="Last 5 days' average temperatures" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="5" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ATOT" description="Running 5-day sum of TMA" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="SRFTEMP" description="Surface temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ST" description="Soil temperatures by layer" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="-" min="-" default="-" unit="degC" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="CUMDPT" description="Profile depth" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="mm" uri="-"/>
		<Output name="DSMID" description="Depth to mid-point of each layer" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="-" min="0" unit="mm" uri="-"/>
		<Output name="TDL" description="Updated cumulative DUL-weighted depth (seasonal state)" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="-" uri="-"/>
		<Output name="TMA" description="Updated last 5 days' average temperatures" variablecategory="state" datatype="DOUBLEARRAY" len="5" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ATOT" description="Updated running 5-day sum of TMA" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="SRFTEMP" description="Updated surface temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ST" description="Updated soil temperatures by layer" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="STEMP" language="cyml" filename="algo/pyx/STEMP.pyx"/>
	<Function name="STEMP" description="Main routine; performs seasonal initialization and daily soil temperature updates." language="cyml" type="external" filename="algo/pyx/STEMP.pyx"/>
	<Function name="SOILT" description="Computes soil temperature for each layer and surface temperature for the current day." language="cyml" type="external" filename="algo/pyx/SOILT.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/STEMP.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
