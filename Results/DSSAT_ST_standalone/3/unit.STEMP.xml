<?xml version="1.0" ?>
<ModelUnit modelid=".STEMP" name="STEMP" timestep="1" version="1.0">
	<Description>
		<Title>STEMP</Title>
		<Authors>DSSAT (DSSAT Florida)</Authors>
		<Institution>University of Georgia; University of Florida; Iowa State University; International Center for Soil Fertility and Agricultural Development (IFDC); University of Guelph</Institution>
		<URI>-</URI>
		<Reference>10.2134/agronj1994.00021962008600060014x</Reference>
		<ExtendedDescription>Implements the DSSAT soil temperature module (STEMP). Computes daily soil temperatures by layer and the soil surface using weather inputs (TAVG, TMAX, SRAD), average annual temperature (TAV), temperature amplitude (TAMP), latitude-based phase (HDAY), and soil properties (bulk density, layer depths, albedo, water content). Uses an EPIC-based damping depth formulation with corrected water content, maintains a 5â€‘day moving average of soil temperatures, and outputs layer temperatures (ST) and surface temperature (SRFTEMP).</ExtendedDescription>
		<ShortDescription>Determines soil temperature by layer.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="CONTROL_RUN" description="Run index/control flag (1 triggers seasonal initialization)." inputtype="variable" variablecategory="exogenous" datatype="INT" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="CONTROL_RNMODE" description="Run mode string; initialization occurs unless contains 'Q' or 'F'." inputtype="variable" variablecategory="exogenous" datatype="CHAR" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="CONTROL_YRDOY" description="Date code in YYYYDDD used to derive day-of-year." inputtype="variable" variablecategory="exogenous" datatype="INT" max="9999366" min="1000001" default="-" unit="YYYYDDD" uri="-"/>
		<Input name="ISWITCH_ISWWAT" description="Water balance switch ('Y' to use actual soil water, else use DUL)." inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="Y" unit="-" uri="-"/>
		<Input name="SOILPROP_BD" description="Soil bulk density by layer." inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="0" default="-" unit="g/cm3" uri="-"/>
		<Input name="SOILPROP_DS" description="Cumulative soil depth to bottom of layer." inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="0" default="-" unit="cm" uri="-"/>
		<Input name="SOILPROP_DUL" description="Drained upper limit (volumetric water content) by layer." inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="1" min="0" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="SOILPROP_LL" description="Lower limit (volumetric water content) by layer." inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="1" min="0" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="SOILPROP_NLAYR" description="Number of soil layers." inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="1" default="-" unit="-" uri="-"/>
		<Input name="SOILPROP_MSALB" description="Minimum soil albedo." inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="SOILPROP_DLAYR" description="Soil layer thickness." inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="NLAYR" max="-" min="0" default="-" unit="cm" uri="-"/>
		<Input name="SRAD" description="Daily solar radiation." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="MJ/m2/d" uri="-"/>
		<Input name="SW" description="Soil water content by layer." inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="NLAYR" max="1" min="0" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="TAVG" description="Daily average air temperature." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TMAX" description="Daily maximum air temperature." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="XLAT" description="Latitude used to set hottest day of year (HDAY)." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="90" min="-90" default="-" unit="degrees" uri="-"/>
		<Input name="TAV" description="Average annual air temperature." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="TAMP" description="Annual air temperature amplitude." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="CUMDPT" description="Cumulative soil depth to bottom of profile." inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="DSMID" description="Depth to midpoint of each soil layer." inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NLAYR" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="TDL" description="Total drained upper limit across layers (accumulated)." inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="-" unit="cm" uri="-"/>
		<Input name="TMA" description="Last 5 days of average air temperature." inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ATOT" description="Running sum of last 5 days average air temperatures." inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="SRFTEMP" description="Surface soil temperature." inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ST" description="Soil temperature by layer." inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="HDAY" description="Day-of-year of the climatological hottest day (depends on hemisphere)." inputtype="variable" variablecategory="state" datatype="DOUBLE" max="366" min="1" default="-" unit="day-of-year" uri="-"/>
		<Input name="ALBEDO" description="Soil albedo passed to SOILT." inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="B" description="Damping coefficient log(500/DP) used in soil temperature calculation." inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="DOY" description="Day-of-year derived from YRDOY." inputtype="variable" variablecategory="auxiliary" datatype="INT" max="366" min="1" default="-" unit="day-of-year" uri="-"/>
		<Input name="DP" description="Damping depth for soil temperature." inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="NLAYR" description="Number of soil layers passed to SOILT (derived from SOILPROP_NLAYR)." inputtype="variable" variablecategory="auxiliary" datatype="INT" max="-" min="1" default="-" unit="-" uri="-"/>
		<Input name="PESW" description="Potential extractable soil water." inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="0" default="-" unit="cm" uri="-"/>
		<Input name="WW" description="Volumetric soil water fraction used in damping function." inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="1" min="0" default="-" unit="cm3/cm3" uri="-"/>
		<Input name="YRDOY" description="Year-day integer code used by YR_DOY helper." inputtype="variable" variablecategory="auxiliary" datatype="INT" max="9999366" min="1000001" default="-" unit="YYYYDDD" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="CUMDPT" description="Cumulative soil depth to bottom of profile." variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="mm" uri="-"/>
		<Output name="DSMID" description="Depth to midpoint of each soil layer." variablecategory="state" datatype="DOUBLELIST" len="NLAYR" max="-" min="0" unit="mm" uri="-"/>
		<Output name="TDL" description="Total drained upper limit across layers (accumulated)." variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="cm" uri="-"/>
		<Output name="TMA" description="Last 5 days of average air temperature." variablecategory="state" datatype="DOUBLELIST" len="5" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ATOT" description="Running sum of last 5 days average air temperatures." variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="SRFTEMP" description="Surface soil temperature." variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="ST" description="Soil temperature by layer." variablecategory="state" datatype="DOUBLELIST" len="NLAYR" max="-" min="-" unit="degC" uri="-"/>
		<Output name="HDAY" description="Day-of-year of the climatological hottest day." variablecategory="state" datatype="DOUBLE" max="366" min="1" unit="day-of-year" uri="-"/>
	</Outputs>
	<Initialization name="STEMP_Initialize" language="cyml" filename="algo/pyx/STEMP_Initialize.pyx"/>
	<Function name="YR_DOY" description="Converts YRDOY (YYYYDDD) to (YEAR, DOY)." language="cyml" type="external" filename="algo/pyx/YR_DOY.pyx"/>
	<Function name="_is_sequence" description="Returns True if input supports len(), else False." language="cyml" type="external" filename="algo/pyx/_is_sequence.pyx"/>
	<Function name="_to_layer_array" description="Converts a scalar/sequence to a list of length n, padding/truncating as needed." language="cyml" type="external" filename="algo/pyx/_to_layer_array.pyx"/>
	<Function name="_fortran_nint" description="Fortran NINT: nearest integer with ties away from zero." language="cyml" type="external" filename="algo/pyx/_fortran_nint.pyx"/>
	<Function name="_round_via_nint" description="Rounds a value to given decimals using Fortran NINT on a scaled value." language="cyml" type="external" filename="algo/pyx/_round_via_nint.pyx"/>
	<Function name="SOILT" description="Computes soil temperature by layer and surface temperature; updates TMA and ATOT." language="cyml" type="external" filename="algo/pyx/SOILT.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/STEMP.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
