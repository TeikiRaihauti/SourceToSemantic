{
    "init": {
        "name": "STEMP_initialize"
    },
    "process": {
        "name": "STEMP",
        "description": "Daily soil temperature update; advances soil temperature states using soil properties, climate drivers, and prior state."
    },
    "inputs": [
        {
            "name": "ISWITCH_ISWWAT",
            "description": "Water switch ('Y' or 'N') controlling use of plant-extractable soil water in temperature calculation",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "CHAR",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_BD",
            "description": "Bulk density by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "g/cm3",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DLAYR",
            "description": "Layer thickness by layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DS",
            "description": "Cumulative depth to bottom of each layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "cm",
            "uri": "-"
        },
        {
            "name": "SOILPROP_DUL",
            "description": "Drained upper limit by layer (volumetric fraction)",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "fraction",
            "uri": "-"
        },
        {
            "name": "SOILPROP_LL",
            "description": "Lower limit by layer (volumetric fraction)",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "fraction",
            "uri": "-"
        },
        {
            "name": "SOILPROP_NLAYR",
            "description": "Number of soil layers",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "INT",
            "len": "-",
            "min": "1",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SOILPROP_MSALB",
            "description": "Mulch/soil albedo",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "SRAD",
            "description": "Solar radiation (not used by algorithm; passed through interfaces)",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "MJ/m2/d",
            "uri": "-"
        },
        {
            "name": "SW",
            "description": "Soil water by layer (volumetric fraction)",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "1",
            "default": "-",
            "unit": "fraction",
            "uri": "-"
        },
        {
            "name": "TAVG",
            "description": "Daily average air temperature",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TMAX",
            "description": "Daily maximum air temperature (not used by algorithm; passed through interfaces)",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "XLAT",
            "description": "Latitude (negative for southern hemisphere)",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-90",
            "max": "90",
            "default": "-",
            "unit": "deg",
            "uri": "-"
        },
        {
            "name": "TAV",
            "description": "Annual average air temperature",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "TAMP",
            "description": "Annual temperature amplitude",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "CONTROL_YRDOY",
            "description": "Date stamp in YYYYDDD format",
            "inputtype": "variable",
            "category": "exogenous",
            "datatype": "INT",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "YYYYDDD",
            "uri": "-"
        },
        {
            "name": "HDAY",
            "description": "Hottest day of year (DOY) used for phase of annual temperature cycle",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "1",
            "max": "366",
            "default": "-",
            "unit": "day-of-year",
            "uri": "-"
        },
        {
            "name": "CUMDPT",
            "description": "Profile depth",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "DSMID",
            "description": "Depth to mid-point of each layer",
            "inputtype": "parameter",
            "category": "constant",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "0",
            "max": "-",
            "default": "-",
            "unit": "mm",
            "uri": "-"
        },
        {
            "name": "TDL",
            "description": "Accumulated DUL*thickness (state; incremented during daily updates)",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Moving average temperatures (5-day history)",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Sum of TMA over 5 days",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Surface temperature",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLE",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Soil temperature by layer",
            "inputtype": "variable",
            "category": "state",
            "datatype": "DOUBLEARRAY",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "outputs": [
        {
            "name": "TDL",
            "description": "Accumulated DUL*thickness after daily update",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "-",
            "uri": "-"
        },
        {
            "name": "TMA",
            "description": "Updated 5-day moving average temperatures",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "5",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ATOT",
            "description": "Updated sum of TMA over 5 days",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "SRFTEMP",
            "description": "Updated surface temperature",
            "datatype": "DOUBLE",
            "category": "state",
            "len": "-",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        },
        {
            "name": "ST",
            "description": "Updated soil temperature by layer",
            "datatype": "DOUBLEARRAY",
            "category": "state",
            "len": "NLAYR",
            "min": "-",
            "max": "-",
            "default": "-",
            "unit": "degC",
            "uri": "-"
        }
    ],
    "functions": [
        {
            "name": "fortran_nint",
            "description": "Nearest-integer rounding (Fortran NINT) with halves rounded away from zero."
        },
        {
            "name": "YR_DOY",
            "description": "Convert YYYYDDD integer to (YEAR, DOY)."
        },
        {
            "name": "SOILT",
            "description": "Compute soil temperature by layer using annual temperature cycle, water content, damping depth, and moving average history."
        }
    ],
    "tests": [
        {
            "name": "-",
            "description": "-",
            "inputs": [
                {
                    "name": "-",
                    "value": "-"
                }
            ],
            "outputs": [
                {
                    "name": "-",
                    "value": "-"
                }
            ]
        }
    ],
    "comments": [
        {
            "comment": "STEMP is the main daily process; STEMP_initialize provides initial states and performs an 8-iteration spin-up calling SOILT."
        },
        {
            "comment": "ALBEDO (from MSALB), SRAD, and TMAX are passed through to preserve interface but are not used in the SOILT/STEMP computations."
        },
        {
            "comment": "TMA[0] is stored with 4 decimals and ST values with 3 decimals via fortran_nint."
        },
        {
            "comment": "TDL is a state variable and is incremented daily; it is not reset within STEMP."
        },
        {
            "comment": "Units for TDL are inconsistent between initialization (cm, using DS in cm) and daily update (using DLAYR in mm). Kept unit as '-' in outputs to avoid asserting an incorrect unit."
        },
        {
            "comment": "HDAY, CUMDPT, and DSMID are produced by initialization and treated as constant parameters for the daily process."
        }
    ]
}