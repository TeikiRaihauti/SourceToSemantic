<?xml version="1.0" ?>
<ModelUnit modelid=".soil temperature model" name="soil temperature model" timestep="1" version="1.0">
	<Description>
		<Title>soil temperature model</Title>
		<Authors>STICS</Authors>
		<Institution>INRAE</Institution>
		<URI>-</URI>
		<Reference>10.1016/j.agrformet.2014.05.002</Reference>
		<ExtendedDescription>A daily soil temperature component that computes a 1 cm-resolution temperature profile using an exponentially damped propagation of canopy temperature signals, parameterized by thermal diffusivity and diurnal frequency. It derives temperature amplitude from canopy minimum and maximum, adjusts each depth with damping and relaxation terms using minimum air temperature, aggregates to user-defined layer means, and updates previous state profiles and canopy temperature.</ExtendedDescription>
		<ShortDescription>Daily soil temperature profile and layer means from canopy temperature extremes with state updates.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="air_temp_day1" description="Mean air temperature on first day" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="layer_thick" description="Thickness of soil layers" inputtype="parameter" parametercategory="constant" datatype="INTARRAY" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="prev_temp_profile" description="Previous soil temperature profile for 1 cm layers" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="prev_canopy_temp" description="Previous canopy temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="min_canopy_temp" description="Current minimum canopy temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="max_canopy_temp" description="Current maximum canopy temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="min_air_temp" description="Current minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="prev_temp_profile_out" description="Updated previous soil temperature profile for 1 cm layers" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="prev_canopy_temp_out" description="Updated previous canopy temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="init_temp_profile" language="cyml" filename="algo/pyx/init_temp_profile.pyx"/>
	<Function name="init_temp_profile" description="Initialize previous soil temperature profile and previous canopy temperature." language="cyml" type="external" filename="algo/pyx/init_temp_profile.pyx"/>
	<Function name="model_temp_amp" description="Calculate temperature amplitude." language="cyml" type="external" filename="algo/pyx/model_temp_amp.pyx"/>
	<Function name="model_canopy_temp_avg" description="Calculate canopy average temperature." language="cyml" type="external" filename="algo/pyx/model_canopy_temp_avg.pyx"/>
	<Function name="layer_thickness2depth" description="Convert layer thicknesses to cumulative depths." language="cyml" type="external" filename="algo/pyx/layer_thickness2depth.pyx"/>
	<Function name="get_soil_depth" description="Compute total soil depth as the sum of layer thicknesses." language="cyml" type="external" filename="algo/pyx/get_soil_depth.pyx"/>
	<Function name="get_layers_number" description="Count the number of non-zero layers." language="cyml" type="external" filename="algo/pyx/get_layers_number.pyx"/>
	<Function name="model_layers_temp" description="Calculate mean temperature for each soil layer." language="cyml" type="external" filename="algo/pyx/model_layers_temp.pyx"/>
	<Function name="model_temp_profile" description="Compute soil temperature profile for 1 cm layers." language="cyml" type="external" filename="algo/pyx/model_temp_profile.pyx"/>
	<Function name="model_update" description="Update previous state variables." language="cyml" type="external" filename="algo/pyx/model_update.pyx"/>
	<Function name="model_soil_temp" description="Main soil temperature model composition step." language="cyml" type="external" filename="algo/pyx/model_soil_temp.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/model_soil_temp.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
