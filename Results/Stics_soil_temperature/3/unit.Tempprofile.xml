<?xml version="1.0" ?>
<ModelUnit modelid=".soil temperature model" name="soil temperature model" timestep="1" version="1.0">
	<Description>
		<Title>soil temperature model</Title>
		<Authors>STICS</Authors>
		<Institution>INRAE</Institution>
		<URI>-</URI>
		<Reference>http://dx.doi.org/10.1016/j.agrformet.2014.05.002</Reference>
		<ExtendedDescription>Computes daily soil temperature dynamics at 1 cm resolution and aggregates them to user-defined layers. The model derives canopy temperature amplitude and mean from minimum and maximum canopy temperatures, then updates the soil profile using an exponentially damped signal with fixed thermal diffusivity (5.37e-3) and daily frequency (7.272e-5), driven by previous canopy temperature and current minimum air temperature. It outputs the updated profile, layer means, and updates the previous state variables for the next time step.</ExtendedDescription>
		<ShortDescription>Daily soil temperature profile and layer means driven by canopy and air temperatures with exponential damping and state updates.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="min_temp" description="current minimum temperature" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="max_temp" description="current maximum temperature" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="min_canopy_temp" description="current minimum canopy temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="max_canopy_temp" description="current maximum canopy temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="layer_thick" description="layers thicknesses (cm), trailing zeros allowed" inputtype="parameter" parametercategory="constant" datatype="INTARRAY" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="layer_thick_or_depth" description="list of integers representing layer thickness or depth" inputtype="variable" variablecategory="auxiliary" datatype="INTARRAY" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="temp_profile" description="current soil profile temperature (1 cm layers)" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="prev_temp_profile" description="previous soil temperature profile (1 cm layers)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="prev_canopy_temp" description="previous canopy temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="air_temp_day1" description="Mean air temperature on first day for initialization" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="min_air_temp" description="current minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="temp_amp" description="current temperature amplitude" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="canopy_temp_avg" description="canopy mean temperature" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="prev_temp_profile" description="updated soil temperature profile (1 cm layers) after the time step" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="prev_canopy_temp" description="updated previous canopy temperature after the time step" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="init_temp_profile" language="cyml" filename="algo/pyx/init_temp_profile.pyx"/>
	<Function name="model_temp_amp" description="Calculates temperature amplitude." language="cyml" type="external" filename="algo/pyx/model_temp_amp.pyx"/>
	<Function name="model_canopy_temp_avg" description="Calculates canopy average temperature." language="cyml" type="external" filename="algo/pyx/model_canopy_temp_avg.pyx"/>
	<Function name="layer_thickness2depth" description="Convert layer thickness to cumulative depth per position." language="cyml" type="external" filename="algo/pyx/layer_thickness2depth.pyx"/>
	<Function name="get_layers_number" description="Count non-zero entries in a list (number of layers)." language="cyml" type="external" filename="algo/pyx/get_layers_number.pyx"/>
	<Function name="model_layers_temp" description="Calculates soil layers mean temperature." language="cyml" type="external" filename="algo/pyx/model_layers_temp.pyx"/>
	<Function name="model_temp_profile" description="Calculates soil temperature profile." language="cyml" type="external" filename="algo/pyx/model_temp_profile.pyx"/>
	<Function name="model_update" description="Update previous state variables from current values." language="cyml" type="external" filename="algo/pyx/model_update.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/model_soil_temp.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
