<?xml version="1.0" ?>
<ModelUnit modelid=".soil temperature model" name="soil temperature model" timestep="1" version="1.0">
	<Description>
		<Title>soil temperature model</Title>
		<Authors>STICS</Authors>
		<Institution>INRAE</Institution>
		<URI>-</URI>
		<Reference>10.1016/j.agrformet.2014.05.002</Reference>
		<ExtendedDescription>Computes soil temperature profile (1 cm resolution) and layer-mean temperatures from canopy and air temperatures at each time step. The workflow: (1) compute canopy temperature amplitude from min/max canopy temperatures; (2) update the soil profile using an exponential damping derived from a fixed thermal diffusivity and diurnal frequency, coupled with previous canopy and soil temperatures; (3) aggregate to layer means; (4) update previous state (profile and canopy). An init routine sets the initial profile and canopy temperature to the day-1 mean air temperature.</ExtendedDescription>
		<ShortDescription>STICS/INRAE soil temperature component computing profile and layer temperatures from canopy and air temperatures.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="air_temp_day1" description="Mean air temperature on first day" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="layer_thick" description="Sequence of soil layer thicknesses" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="cm" uri="-"/>
		<Input name="temp_amp" description="Current temperature amplitude" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="prev_temp_profile" description="Previous soil temperature profile at 1 cm resolution" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="prev_canopy_temp" description="Previous canopy (crop) temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="min_air_temp" description="Current minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="therm_diff" description="Thermal diffusivity used in soil temperature damping" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="0.00537" unit="cm2 s-1" uri="-"/>
		<Input name="temp_freq" description="Temperature oscillation angular frequency" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="7.272e-05" unit="s-1" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="temp_profile" description="Current soil temperature profile at 1 cm resolution" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="init_temp_profile" language="cyml" filename="algo/pyx/init_temp_profile.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/model_temp_profile.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
