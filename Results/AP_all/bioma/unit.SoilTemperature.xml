<?xml version="1.0" ?>
<ModelUnit modelid=".Soil Temperature" name="Soil Temperature" timestep="1" version="-">
	<Description>
		<Title>Soil Temperature</Title>
		<Authors>APSIM; Cyrille</Authors>
		<Institution>APSIM Initiative; INRAE</Institution>
		<URI>-</URI>
		<Reference>-</Reference>
		<ExtendedDescription>A one-dimensional soil temperature component that computes diurnal soil temperature dynamics across soil nodes using heat diffusion solved by a tridiagonal (Thomas) method. The vertical grid includes an air node, a surface node, soil nodes per layer, and phantom nodes to represent deep boundary conditions. Initialization can use provided layer temperatures or an annual sinusoidal profile based on mean annual temperature (Tav), amplitude (Amp), day of year, latitude, and layer thickness. The model optionally computes net radiation from meteorological inputs (shortwave radiation, cloudiness proxy) or derives it from potential/actual soil evaporation. Boundary layer conductance above the surface can be set constant or iteratively calculated from wind speed, air pressure, instrument height, canopy height, and Monin–Obukhov stability corrections with a radiative conductance term. Soil volumetric specific heat and effective thermal conductivity are computed by mixing rules over constituents (rocks, organic matter, sand, silt, clay, water, ice, air) using constituent volumetric fractions (from texture, bulk density, organic carbon, rock fraction, soil water) and shape factors. Outputs include updated soil temperatures at nodes, daily min/max/average soil temperatures per layer, heat storage, thermal conductivity/conductance, boundary layer conductance, and diagnostic variables.</ExtendedDescription>
		<ShortDescription>1D soil heat diffusion model with mixed-constituent thermal properties and optional iterative boundary layer conductance, initialized from annual sinusoid or provided temperatures.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="weather_MinT" description="Daily minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_MaxT" description="Daily maximum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_MeanT" description="Daily mean air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_Tav" description="Long-term average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_Amp" description="Annual air temperature amplitude" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_AirPressure" description="Air pressure" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="hPa" uri="-"/>
		<Input name="weather_Wind" description="Wind speed at instrument height" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="m/s" uri="-"/>
		<Input name="weather_Latitude" description="Site latitude" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="90" min="-90" default="-" unit="deg" uri="-"/>
		<Input name="weather_Radn" description="Daily global solar radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="MJ/m2/d" uri="-"/>
		<Input name="clock_Today_DayOfYear" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="366" min="1" default="-" unit="-" uri="-"/>
		<Input name="microClimate_CanopyHeight" description="Canopy height input" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="physical_Thickness" description="Layer thickness profile" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="physical_BD" description="Layer bulk density profile" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="-" unit="g/cm3" uri="-"/>
		<Input name="ps" description="Particle density of solids" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="Mg/m3" uri="-"/>
		<Input name="physical_Rocks" description="Rock fragment content per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="physical_ParticleSizeSand" description="Sand percentage per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="physical_ParticleSizeSilt" description="Silt percentage per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="physical_ParticleSizeClay" description="Clay percentage per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="organic_Carbon" description="Organic carbon per layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="waterBalance_SW" description="Water balance soil water by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="waterBalance_Eos" description="Soil evaporation supply" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="waterBalance_Eo" description="Potential evapotranspiration" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="waterBalance_Es" description="Actual soil evaporation rate" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="waterBalance_Salb" description="Soil albedo (shortwave reflectance)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="pInitialValues" description="Initial soil temperature profile values" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="DepthToConstantTemperature" description="Depth to constant temperature bottom boundary" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="1000" unit="mm" uri="-"/>
		<Input name="timestep" description="Model time step length" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="1" default="-" unit="s" uri="-"/>
		<Input name="latentHeatOfVapourisation" description="Latent heat of vaporisation" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="J/kg" uri="-"/>
		<Input name="stefanBoltzmannConstant" description="Stefan-Boltzmann constant" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="5.67e-8" unit="W/m2/K4" uri="-"/>
		<Input name="airNode" description="Index of air node in vertical grid" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="0" default="0" unit="-" uri="-"/>
		<Input name="surfaceNode" description="Index of soil surface node in grid" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="0" default="1" unit="-" uri="-"/>
		<Input name="topsoilNode" description="Index of topsoil node for initial profile mapping" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="1" default="-" unit="-" uri="-"/>
		<Input name="numPhantomNodes" description="Number of phantom nodes below profile" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="1" default="2" unit="-" uri="-"/>
		<Input name="constantBoundaryLayerConductance" description="Fixed boundary layer conductance when using constant source" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="W/m2/K" uri="-"/>
		<Input name="numIterationsForBoundaryLayerConductance" description="Iterations to converge stability corrections for boundary layer conductance" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="0" default="0" unit="-" uri="-"/>
		<Input name="defaultTimeOfMaximumTemperature" description="Hour of day for maximum air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="24" min="0" default="15" unit="h" uri="-"/>
		<Input name="defaultInstrumentHeight" description="Default instrument (wind) height above ground" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0.5" default="2.0" unit="m" uri="-"/>
		<Input name="bareSoilRoughness" description="Bare soil roughness height used at initialization" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="nodeDepth" description="Vertical grid node depths" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="-" unit="m" uri="-"/>
		<Input name="thermCondPar1" description="Thermal conductivity parameter 1 per node (initial)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="thermCondPar2" description="Thermal conductivity parameter 2 per node (initial)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="thermCondPar3" description="Thermal conductivity parameter 3 per node (initial)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="thermCondPar4" description="Thermal conductivity parameter 4 per node (initial)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="pom" description="Organic matter particle density" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="1.3" unit="Mg/m3" uri="-"/>
		<Input name="soilRoughnessHeight" description="Soil surface roughness height" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="mm" uri="-"/>
		<Input name="nu" description="Numerical scheme weight for Crank-Nicolson" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.5" unit="-" uri="-"/>
		<Input name="boundarLayerConductanceSource" description="Boundary layer conductance source (constant or calc)" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="calc" unit="-" uri="-"/>
		<Input name="netRadiationSource" description="Net radiation source (calc or eos)" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="calc" unit="-" uri="-"/>
		<Input name="MissingValue" description="Sentinel missing value used in arrays" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-999" unit="-" uri="-"/>
		<Input name="soilConstituentNames" description="List of soil constituents to include (e.g., Rocks, OrganicMatter, Sand, Silt, Clay, Water, Ice, Air, Minerals)" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="['Minerals','Water','Air']" unit="-" uri="-"/>
		<Input name="InitialValues" description="Initial soil temperature values provided or derived" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="[]" unit="degC" uri="-"/>
		<Input name="doInitialisationStuff" description="Flag controlling initialization pathway" inputtype="variable" variablecategory="state" datatype="INT" max="1" min="0" default="1" unit="-" uri="-"/>
		<Input name="internalTimeStep" description="Internal sub-daily step length used for diurnal loop" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="1" default="0" unit="s" uri="-"/>
		<Input name="timeOfDaySecs" description="Seconds from midnight within current day loop" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="86400" min="0" default="0" unit="s" uri="-"/>
		<Input name="numNodes" description="Number of nodes in vertical grid (including phantom nodes)" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="2" default="-" unit="-" uri="-"/>
		<Input name="numLayers" description="Number of soil layers (excluding phantom nodes)" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="1" default="-" unit="-" uri="-"/>
		<Input name="volSpecHeatSoil" description="Volumetric specific heat of soil per node" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" default="[]" unit="J/m3/K" uri="-"/>
		<Input name="soilTemp" description="Soil temperature profile by node" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="[]" unit="degC" uri="-"/>
		<Input name="morningSoilTemp" description="Soil temperature snapshot near 5:00 AM by node" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="[]" unit="degC" uri="-"/>
		<Input name="heatStorage" description="Heat storage capacity term per node over internal step" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" default="[]" unit="W/m2/K" uri="-"/>
		<Input name="thermalConductance" description="Thermal conductance between nodes" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" default="[]" unit="W/m2/K" uri="-"/>
		<Input name="thermalConductivity" description="Thermal conductivity per node (used internally; recalculated each step)" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLELIST" len="-" max="-" min="0" default="[]" unit="W/m/K" uri="-"/>
		<Input name="boundaryLayerConductance" description="Boundary layer conductance at surface-air interface" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="0" unit="W/m2/K" uri="-"/>
		<Input name="newTemperature" description="Working temperature vector used by solver (includes air node)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="[]" unit="degC" uri="-"/>
		<Input name="airTemperature" description="Air node temperature (equals newTemperature[airNode])" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="60" min="-50" default="-" unit="degC" uri="-"/>
		<Input name="maxTempYesterday" description="Yesterday maximum temperature for diurnal interpolation" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="0" unit="degC" uri="-"/>
		<Input name="minTempYesterday" description="Yesterday minimum temperature for diurnal interpolation" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="0" unit="degC" uri="-"/>
		<Input name="soilWater" description="Soil water content per layer/node (volumetric or mapped)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="1" min="0" default="[]" unit="mm/mm" uri="-"/>
		<Input name="minSoilTemp" description="Minimum soil temperature encountered during the day per node" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="[]" unit="degC" uri="-"/>
		<Input name="maxSoilTemp" description="Maximum soil temperature encountered during the day per node" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="[]" unit="degC" uri="-"/>
		<Input name="aveSoilTemp" description="Average soil temperature over the day per node" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="[]" unit="degC" uri="-"/>
		<Input name="aveSoilWater" description="Average soil water over the day per node (not used)" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="thickness" description="Model thickness array including phantom nodes (1-based indexing logic)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="[]" unit="mm" uri="-"/>
		<Input name="bulkDensity" description="Bulk density per layer/node (propagated to phantom nodes)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="[]" unit="g/cm3" uri="-"/>
		<Input name="rocks" description="Rock fragment content per layer/node (propagated)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="[]" unit="%" uri="-"/>
		<Input name="carbon" description="Organic carbon per layer/node (propagated)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="[]" unit="%" uri="-"/>
		<Input name="sand" description="Sand percentage per layer/node (propagated)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="[]" unit="%" uri="-"/>
		<Input name="silt" description="Silt percentage per layer/node (propagated)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="[]" unit="%" uri="-"/>
		<Input name="clay" description="Clay percentage per layer/node (propagated)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="[]" unit="%" uri="-"/>
		<Input name="instrumentHeight" description="Instrument (wind) height used for BL conductance calc" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0.5" default="-" unit="m" uri="-"/>
		<Input name="netRadiation" description="Net radiation at soil surface per internal step" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="0" unit="MJ/m2/step" uri="-"/>
		<Input name="canopyHeight" description="Effective canopy height used in roughness and BL conductance" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="0" unit="m" uri="-"/>
		<Input name="instrumHeight" description="Instrument height input (unused downstream, kept for interface)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="0" unit="m" uri="-"/>
		<Input name="nodeDepth" description="Grid node depths (passed to process for solver geometry)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="[]" unit="m" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="InitialValues" description="Updated/derived initial soil temperature profile values" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="doInitialisationStuff" description="Flag indicating whether initialization is pending (0/1)" variablecategory="state" datatype="INT" max="1" min="0" unit="-" uri="-"/>
		<Output name="internalTimeStep" description="Internal sub-daily step length used for diurnal loop" variablecategory="state" datatype="DOUBLE" max="-" min="1" unit="s" uri="-"/>
		<Output name="timeOfDaySecs" description="Seconds from midnight within current day loop" variablecategory="state" datatype="DOUBLE" max="86400" min="0" unit="s" uri="-"/>
		<Output name="volSpecHeatSoil" description="Volumetric specific heat of soil per node" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" unit="J/m3/K" uri="-"/>
		<Output name="soilTemp" description="Updated soil temperature profile by node" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="morningSoilTemp" description="Soil temperatures around early morning (5:00) by node" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="heatStorage" description="Heat storage coefficient per node over internal step" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" unit="W/m2/K" uri="-"/>
		<Output name="thermalConductance" description="Thermal conductance between nodes after solve" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" unit="W/m2/K" uri="-"/>
		<Output name="boundaryLayerConductance" description="Mean boundary layer conductance for the day" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="W/m2/K" uri="-"/>
		<Output name="newTemperature" description="Updated working temperature vector by node (includes air node)" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="airTemperature" description="Updated air node temperature" variablecategory="state" datatype="DOUBLE" max="60" min="-50" unit="degC" uri="-"/>
		<Output name="maxTempYesterday" description="Stored yesterday maximum temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="minTempYesterday" description="Stored yesterday minimum temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="soilWater" description="Updated soil water per layer/node" variablecategory="state" datatype="DOUBLELIST" len="-" max="1" min="0" unit="mm/mm" uri="-"/>
		<Output name="minSoilTemp" description="Daily minimum soil temperature per node" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="maxSoilTemp" description="Daily maximum soil temperature per node" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="aveSoilTemp" description="Daily average soil temperature per node" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="instrumentHeight" description="Updated instrument (wind) height after constraints" variablecategory="state" datatype="DOUBLE" max="-" min="0.5" unit="m" uri="-"/>
		<Output name="netRadiation" description="Net radiation at soil surface for the time step" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="MJ/m2/step" uri="-"/>
		<Output name="canopyHeight" description="Updated effective canopy height" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="m" uri="-"/>
	</Outputs>
	<Initialization name="soiltemperature_init" language="cyml" filename="algo/pyx/soiltemperature_init.pyx"/>
	<Function name="getIniVariables" description="Initializes instrumentHeight from provided instrument or default." language="cyml" type="external" filename="algo/pyx/getIniVariables.pyx"/>
	<Function name="Sum" description="Sums list values over index range skipping MissingValue." language="cyml" type="external" filename="algo/pyx/Sum.pyx"/>
	<Function name="Divide" description="Safe division returning errVal if denominator is zero." language="cyml" type="external" filename="algo/pyx/Divide.pyx"/>
	<Function name="ToCumThickness" description="Converts layer thicknesses to cumulative depths." language="cyml" type="external" filename="algo/pyx/ToCumThickness.pyx"/>
	<Function name="kelvinT" description="Converts Celsius to Kelvin." language="cyml" type="external" filename="algo/pyx/kelvinT.pyx"/>
	<Function name="airDensity" description="Computes air density from temperature and pressure." language="cyml" type="external" filename="algo/pyx/airDensity.pyx"/>
	<Function name="longWaveRadn" description="Computes longwave radiation using emissivity and temperature." language="cyml" type="external" filename="algo/pyx/longWaveRadn.pyx"/>
	<Function name="volumetricSpecificHeat" description="Returns volumetric specific heat for named soil constituent." language="cyml" type="external" filename="algo/pyx/volumetricSpecificHeat.pyx"/>
	<Function name="volumetricFractionRocks" description="Rock volumetric fraction for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionRocks.pyx"/>
	<Function name="volumetricFractionOrganicMatter" description="Organic matter volumetric fraction for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionOrganicMatter.pyx"/>
	<Function name="volumetricFractionIce" description="Ice volumetric fraction for a layer (returns 0)." language="cyml" type="external" filename="algo/pyx/volumetricFractionIce.pyx"/>
	<Function name="volumetricFractionWater" description="Water volumetric fraction for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionWater.pyx"/>
	<Function name="volumetricFractionClay" description="Clay volumetric fraction for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionClay.pyx"/>
	<Function name="volumetricFractionSilt" description="Silt volumetric fraction for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionSilt.pyx"/>
	<Function name="volumetricFractionSand" description="Sand volumetric fraction for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionSand.pyx"/>
	<Function name="volumetricFractionAir" description="Air volumetric fraction for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionAir.pyx"/>
	<Function name="mapLayer2Node" description="Maps per-layer values to nodes using linear weighting by distances." language="cyml" type="external" filename="algo/pyx/mapLayer2Node.pyx"/>
	<Function name="ThermalConductance" description="Returns (overwritten) conductance per constituent; preserves original bug using volumetricSpecificHeat." language="cyml" type="external" filename="algo/pyx/ThermalConductance.pyx"/>
	<Function name="shapeFactor" description="Returns (overwritten) shape factor; preserves original bug using volumetricSpecificHeat." language="cyml" type="external" filename="algo/pyx/shapeFactor.pyx"/>
	<Function name="Zero" description="Zeroes a list in place if not None." language="cyml" type="external" filename="algo/pyx/Zero.pyx"/>
	<Function name="doVolumetricSpecificHeat" description="Computes volumetric specific heat per node and maps to nodes." language="cyml" type="external" filename="algo/pyx/doVolumetricSpecificHeat.pyx"/>
	<Function name="doThermalConductivity" description="Computes effective thermal conductivity per node." language="cyml" type="external" filename="algo/pyx/doThermalConductivity.pyx"/>
	<Function name="getBoundaryLayerConductance" description="Iteratively computes boundary layer conductance with stability corrections." language="cyml" type="external" filename="algo/pyx/getBoundaryLayerConductance.pyx"/>
	<Function name="interpolateNetRadiation" description="Computes net shortwave and longwave radiation reaching soil per internal step." language="cyml" type="external" filename="algo/pyx/interpolateNetRadiation.pyx"/>
	<Function name="interpolateTemperature" description="Diurnal air temperature interpolation using sine curves." language="cyml" type="external" filename="algo/pyx/interpolateTemperature.pyx"/>
	<Function name="doThomas" description="Thomas algorithm for tridiagonal heat conduction solve." language="cyml" type="external" filename="algo/pyx/doThomas.pyx"/>
	<Function name="doUpdate" description="Updates soil temperatures, min/max/avg, and accumulates BL conductance." language="cyml" type="external" filename="algo/pyx/doUpdate.pyx"/>
	<Function name="doNetRadiation" description="Distributes daily solar radiation and computes cloud fraction and cva." language="cyml" type="external" filename="algo/pyx/doNetRadiation.pyx"/>
	<Function name="doProcess" description="Performs one day’s internal loop: radiation, BL conductance, solve, and daily aggregations." language="cyml" type="external" filename="algo/pyx/doProcess.pyx"/>
	<Function name="doThermalConductivityCoeffs" description="Computes thermal conductivity parameter arrays per node." language="cyml" type="external" filename="algo/pyx/doThermalConductivityCoeffs.pyx"/>
	<Function name="calcSoilTemperature" description="Initial seasonal soil temperature profile by depth." language="cyml" type="external" filename="algo/pyx/calcSoilTemperature.pyx"/>
	<Function name="calcSurfaceTemperature" description="Computes surface temperature from radiation and albedo." language="cyml" type="external" filename="algo/pyx/calcSurfaceTemperature.pyx"/>
	<Function name="readParam" description="Initializes conductivity parameters, soil temps, and roughness height." language="cyml" type="external" filename="algo/pyx/readParam.pyx"/>
	<Function name="getOtherVariables" description="Refreshes soil water, instrument height, canopy height from inputs." language="cyml" type="external" filename="algo/pyx/getOtherVariables.pyx"/>
	<Function name="getProfileVariables" description="Builds model profile arrays (thickness, nodeDepth, properties, phantom nodes)." language="cyml" type="external" filename="algo/pyx/getProfileVariables.pyx"/>
	<Function name="ValuesInArray" description="Checks if array has any non-missing values." language="cyml" type="external" filename="algo/pyx/ValuesInArray.pyx"/>
	<Function name="math_pi" description="Returns PI constant." language="cyml" type="external" filename="algo/pyx/math_pi.pyx"/>
	<Function name="math_sin" description="Wrapper for math.sin." language="cyml" type="external" filename="algo/pyx/math_sin.pyx"/>
	<Function name="math_cos" description="Wrapper for math.cos." language="cyml" type="external" filename="algo/pyx/math_cos.pyx"/>
	<Function name="math_log" description="Safe natural log with guard for non-positive inputs." language="cyml" type="external" filename="algo/pyx/math_log.pyx"/>
	<Function name="math_exp" description="Wrapper for math.exp." language="cyml" type="external" filename="algo/pyx/math_exp.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/soiltemperature_process.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
