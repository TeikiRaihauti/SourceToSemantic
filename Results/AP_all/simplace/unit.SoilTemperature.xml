<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperature (APSIM Campbell)" name="SoilTemperature (APSIM Campbell)" timestep="1" version="-">
	<Description>
		<Title>SoilTemperature (APSIM Campbell)</Title>
		<Authors>-</Authors>
		<Institution>-</Institution>
		<URI>net.simplace.sim.components.ApsimCampbell.SoilTemperature</URI>
		<Reference>-</Reference>
		<ExtendedDescription>A SIMPLACE component implementing an APSIM-Campbell style one-dimensional soil temperature model. It solves transient heat conduction in a soil profile with an energy balance at the surface, computing boundary layer conductance (optionally via an iterative Moninâ€“Obukhov approach), net radiation partitioning, and latent/sensible heat fluxes. The profile includes phantom nodes to a specified depth of constant temperature. Volumetric heat capacity and thermal conductivity are derived from layer constituents (rocks, organic matter, sand, silt, clay, water, air) and bulk density, with mapping between layer and node values. The model runs on internal sub-daily timesteps to produce daily minima, maxima, and averages of soil temperature per depth.</ExtendedDescription>
		<ShortDescription>SIMPLACE component for soil temperature dynamics using the APSIM Campbell approach with sub-daily energy balance and heat diffusion.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="weather_Tav" description="Average annual air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_Amp" description="Annual temperature amplitude" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_Latitude" description="Site latitude" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="deg" uri="-"/>
		<Input name="clock_Today_DayOfYear" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="366" min="1" default="-" unit="day" uri="-"/>
		<Input name="microClimate_CanopyHeight" description="Canopy height driver" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="physical_Thickness" description="Layer thicknesses" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="physical_BD" description="Layer bulk density" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="-" unit="g/cm3 or similar" uri="-"/>
		<Input name="physical_Rocks" description="Rock fraction per layer (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="physical_ParticleSizeSand" description="Sand fraction per layer (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="physical_ParticleSizeSilt" description="Silt fraction per layer (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="physical_ParticleSizeClay" description="Clay fraction per layer (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="organic_Carbon" description="Organic carbon per layer (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="waterBalance_SW" description="Soil water (layer-based) from water balance" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="-" max="1" min="0" default="-" unit="vol/vol" uri="-"/>
		<Input name="pInitialValues" description="Initial soil temperature values (top layers)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="DepthToConstantTemperature" description="Depth to constant temperature (used for phantom nodes)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="timestep" description="External model time step length" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="s" uri="-"/>
		<Input name="latentHeatOfVapourisation" description="Latent heat of vaporisation" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="stefanBoltzmannConstant" description="Stefan-Boltzmann constant" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="5.67e-8 (SI) if SI; varies in code units" unit="-" uri="-"/>
		<Input name="airNode" description="Index of air node" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="0" default="-" unit="index" uri="-"/>
		<Input name="surfaceNode" description="Index of surface node" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="0" default="-" unit="index" uri="-"/>
		<Input name="topsoilNode" description="Index of topsoil node" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="0" default="-" unit="index" uri="-"/>
		<Input name="numPhantomNodes" description="Number of phantom nodes below profile" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="0" default="0" unit="-" uri="-"/>
		<Input name="constantBoundaryLayerConductance" description="Constant boundary layer conductance when source='constant'" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="numIterationsForBoundaryLayerConductance" description="Iterations for stability correction coupling" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="0" default="0" unit="-" uri="-"/>
		<Input name="defaultTimeOfMaximumTemperature" description="Default hour of day for Tmax" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="24" min="0" default="-" unit="h" uri="-"/>
		<Input name="defaultInstrumentHeight" description="Default instrument height for wind/temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="bareSoilRoughness" description="Bare soil roughness height" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="instrumHeight" description="Provided instrument height" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="pom" description="Particle organic matter density parameter" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="2.5 typically" unit="-" uri="-"/>
		<Input name="nu" description="Implicit scheme weighting (0..1)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="1" unit="-" uri="-"/>
		<Input name="boundarLayerConductanceSource" description="Boundary layer conductance source ('constant' or 'calc')" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="constant" unit="-" uri="-"/>
		<Input name="netRadiationSource" description="Net radiation source ('calc' or 'eos')" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="calc" unit="-" uri="-"/>
		<Input name="MissingValue" description="Missing value sentinel" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-999" unit="-" uri="-"/>
		<Input name="soilConstituentNames" description="List of soil constituent names used for mixture properties" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="-" min="-" default="['OrganicMatter','Sand','Silt','Clay','Water','Air','Ice','Rocks','Minerals']" unit="-" uri="-"/>
		<Input name="weather_MinT" description="Daily minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_MaxT" description="Daily maximum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_MeanT" description="Daily mean air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="weather_AirPressure" description="Air pressure" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="hPa" uri="-"/>
		<Input name="weather_Wind" description="Wind speed at instrument height" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="m/s" uri="-"/>
		<Input name="weather_Radn" description="Daily shortwave radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="MJ/m2/d" uri="-"/>
		<Input name="waterBalance_Eos" description="Soil evaporation under standard conditions (MJ or mm eq.)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="waterBalance_Eo" description="Reference evapotranspiration (MJ or mm eq.)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="waterBalance_Es" description="Actual soil evaporation (MJ or mm eq.)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="waterBalance_Salb" description="Soil albedo" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="-" unit="-" uri="-"/>
		<Input name="InitialValues" description="State buffer for initial soil temperatures by layer" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="MissingValue" unit="degC" uri="-"/>
		<Input name="doInitialisationStuff" description="Flag to perform one-time initialisation in process" inputtype="variable" variablecategory="state" datatype="CHAR" max="-" min="-" default="True" unit="-" uri="-"/>
		<Input name="internalTimeStep" description="Internal sub-daily timestep used in process loop" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="round(timestep/48)" unit="s" uri="-"/>
		<Input name="timeOfDaySecs" description="Current time of day within the step" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="86400" min="0" default="-" unit="s" uri="-"/>
		<Input name="numNodes" description="Number of soil nodes (including phantom and boundary nodes)" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="1" default="-" unit="count" uri="-"/>
		<Input name="numLayers" description="Number of soil layers (physical profile)" inputtype="parameter" parametercategory="constant" datatype="INT" max="-" min="1" default="-" unit="count" uri="-"/>
		<Input name="nodeDepth" description="Node depths (m) with extended indexing" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="-" unit="m" uri="-"/>
		<Input name="volSpecHeatSoil" description="Volumetric specific heat at nodes" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" default="0" unit="J m-3 K-1" uri="-"/>
		<Input name="soilTemp" description="Soil temperature at nodes" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="weather_Tav-based" unit="degC" uri="-"/>
		<Input name="morningSoilTemp" description="Morning (5:00) soil temperature snapshot" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="0" unit="degC" uri="-"/>
		<Input name="heatStorage" description="Heat storage term per node for implicit scheme" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" default="0" unit="-" uri="-"/>
		<Input name="thermalConductance" description="Thermal conductance per node element" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" default="0" unit="-" uri="-"/>
		<Input name="thermalConductivity" description="Thermal conductivity per node" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" default="0" unit="-" uri="-"/>
		<Input name="boundaryLayerConductance" description="Boundary layer conductance (air-surface)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="0" unit="-" uri="-"/>
		<Input name="newTemperature" description="Working array for updated temperatures (includes air node)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="soilTemp" unit="degC" uri="-"/>
		<Input name="airTemperature" description="Air temperature used in current step" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="weather_MeanT or interpolated" unit="degC" uri="-"/>
		<Input name="maxTempYesterday" description="Yesterday's maximum temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="weather_MaxT on init" unit="degC" uri="-"/>
		<Input name="minTempYesterday" description="Yesterday's minimum temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="weather_MinT on init" unit="degC" uri="-"/>
		<Input name="soilWater" description="Soil water (node-based, mapped from layers)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="1" min="0" default="-" unit="vol/vol" uri="-"/>
		<Input name="minSoilTemp" description="Min soil temperature (daily) at nodes" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="0" unit="degC" uri="-"/>
		<Input name="maxSoilTemp" description="Max soil temperature (daily) at nodes" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="0" unit="degC" uri="-"/>
		<Input name="aveSoilTemp" description="Average soil temperature (daily) at nodes" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" default="0" unit="degC" uri="-"/>
		<Input name="thickness" description="Augmented thickness array (with phantom layers) in source indexing scheme" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="-" unit="-" uri="-"/>
		<Input name="bulkDensity" description="Augmented bulk density array mapped to nodes" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="-" min="0" default="-" unit="g/cm3 or similar" uri="-"/>
		<Input name="rocks" description="Augmented rock fraction array mapped to nodes (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="carbon" description="Augmented organic carbon array mapped to nodes (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="sand" description="Augmented sand fraction array mapped to nodes (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="silt" description="Augmented silt fraction array mapped to nodes (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="clay" description="Augmented clay fraction array mapped to nodes (%)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="100" min="0" default="-" unit="%" uri="-"/>
		<Input name="soilRoughnessHeight" description="Soil surface roughness height used for canopy/instrument adjustments" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="0" default="Derived from bareSoilRoughness" unit="-" uri="-"/>
		<Input name="instrumentHeight" description="Instrument height used for wind/log-law calculations" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="&gt;= canopyHeight+0.5" unit="-" uri="-"/>
		<Input name="netRadiation" description="Net radiation at soil surface during current step" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="0" unit="-" uri="-"/>
		<Input name="canopyHeight" description="Canopy height used in BL and radiation calculations" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="0" default="max(microClimate_CanopyHeight, soilRoughnessHeight)/1000" unit="-" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="InitialValues" description="Updated stored initial soil temperatures (top layers)" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="doInitialisationStuff" description="Updated initialisation flag" variablecategory="state" datatype="CHAR" max="-" min="-" unit="-" uri="-"/>
		<Output name="internalTimeStep" description="Internal sub-step length used" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="s" uri="-"/>
		<Output name="timeOfDaySecs" description="End-of-loop time of day seconds" variablecategory="state" datatype="DOUBLE" max="86400" min="0" unit="s" uri="-"/>
		<Output name="volSpecHeatSoil" description="Volumetric specific heat at nodes" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" unit="J m-3 K-1" uri="-"/>
		<Output name="soilTemp" description="Updated soil temperatures at nodes" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="morningSoilTemp" description="Updated morning soil temperatures (5:00)" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="heatStorage" description="Heat storage per node for implicit scheme" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" unit="-" uri="-"/>
		<Output name="thermalConductance" description="Thermal conductance per node element" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" unit="-" uri="-"/>
		<Output name="thermalConductivity" description="Thermal conductivity per node" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="0" unit="-" uri="-"/>
		<Output name="boundaryLayerConductance" description="Boundary layer conductance (air-surface) averaged/updated" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="-" uri="-"/>
		<Output name="newTemperature" description="Updated working temperatures (includes air node)" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="airTemperature" description="Air temperature used in the final sub-step" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="maxTempYesterday" description="Updated yesterday's maximum air temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="minTempYesterday" description="Updated yesterday's minimum air temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="soilWater" description="Updated node-based soil water (copied from waterBalance_SW)" variablecategory="state" datatype="DOUBLELIST" len="-" max="1" min="0" unit="vol/vol" uri="-"/>
		<Output name="minSoilTemp" description="Daily minimum soil temperature at nodes" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="maxSoilTemp" description="Daily maximum soil temperature at nodes" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="aveSoilTemp" description="Daily average soil temperature at nodes (accumulated)" variablecategory="state" datatype="DOUBLELIST" len="-" max="-" min="-" unit="degC" uri="-"/>
		<Output name="instrumentHeight" description="Updated instrument height" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="-" uri="-"/>
		<Output name="netRadiation" description="Updated net radiation at soil surface" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="canopyHeight" description="Updated canopy height used in BL calculations" variablecategory="state" datatype="DOUBLE" max="-" min="0" unit="-" uri="-"/>
	</Outputs>
	<Initialization name="init" language="cyml" filename="algo/pyx/init.pyx"/>
	<Function name="getIniVariables" description="Initialise instrumentHeight from provided or default value." language="cyml" type="external" filename="algo/pyx/getIniVariables.pyx"/>
	<Function name="Calculate_getProfileVariables" description="Build and initialise layer/node arrays (thickness, nodeDepth, properties), including phantom nodes." language="cyml" type="external" filename="algo/pyx/Calculate_getProfileVariables.pyx"/>
	<Function name="Calculate_doThermalConductivityCoeffs" description="Compute thermal conductivity coefficient arrays from bulk density and clay." language="cyml" type="external" filename="algo/pyx/Calculate_doThermalConductivityCoeffs.pyx"/>
	<Function name="Calculate_readParam" description="Compute soil temperature profile and thermal conductivity parameters; set soil roughness height." language="cyml" type="external" filename="algo/pyx/Calculate_readParam.pyx"/>
	<Function name="Calculate_getOtherVariables" description="Update soilWater from water balance; compute canopy and instrument heights." language="cyml" type="external" filename="algo/pyx/Calculate_getOtherVariables.pyx"/>
	<Function name="volumetricFractionOrganicMatter" description="Volumetric fraction of organic matter." language="cyml" type="external" filename="algo/pyx/volumetricFractionOrganicMatter.pyx"/>
	<Function name="volumetricFractionRocks" description="Volumetric fraction of rocks." language="cyml" type="external" filename="algo/pyx/volumetricFractionRocks.pyx"/>
	<Function name="volumetricFractionIce" description="Volumetric fraction of ice (always 0 here)." language="cyml" type="external" filename="algo/pyx/volumetricFractionIce.pyx"/>
	<Function name="volumetricFractionWater" description="Volumetric fraction of water." language="cyml" type="external" filename="algo/pyx/volumetricFractionWater.pyx"/>
	<Function name="volumetricFractionClay" description="Volumetric fraction of clay." language="cyml" type="external" filename="algo/pyx/volumetricFractionClay.pyx"/>
	<Function name="volumetricFractionSilt" description="Volumetric fraction of silt." language="cyml" type="external" filename="algo/pyx/volumetricFractionSilt.pyx"/>
	<Function name="volumetricFractionSand" description="Volumetric fraction of sand." language="cyml" type="external" filename="algo/pyx/volumetricFractionSand.pyx"/>
	<Function name="kelvinT" description="Convert Celsius to Kelvin." language="cyml" type="external" filename="algo/pyx/kelvinT.pyx"/>
	<Function name="Divide" description="Safe division with error fallback." language="cyml" type="external" filename="algo/pyx/Divide.pyx"/>
	<Function name="Sum" description="Sum with start/end indices and missing value check." language="cyml" type="external" filename="algo/pyx/Sum.pyx"/>
	<Function name="volumetricSpecificHeat" description="Return specific heat capacity per constituent (lookup)." language="cyml" type="external" filename="algo/pyx/volumetricSpecificHeat.pyx"/>
	<Function name="volumetricFractionAir" description="Volumetric fraction of air." language="cyml" type="external" filename="algo/pyx/volumetricFractionAir.pyx"/>
	<Function name="airDensity" description="Compute air density from temperature and pressure." language="cyml" type="external" filename="algo/pyx/airDensity.pyx"/>
	<Function name="longWaveRadn" description="Longwave radiation using Stefan-Boltzmann law." language="cyml" type="external" filename="algo/pyx/longWaveRadn.pyx"/>
	<Function name="mapLayer2Node" description="Map layer values to nodes by depth-weighted interpolation." language="cyml" type="external" filename="algo/pyx/mapLayer2Node.pyx"/>
	<Function name="ThermalConductance" description="Return constituent 'conductance' (implementation returns specific heat per original bug)." language="cyml" type="external" filename="algo/pyx/ThermalConductance.pyx"/>
	<Function name="shapeFactor" description="Return constituent shape factor (implementation returns specific heat per original bug)." language="cyml" type="external" filename="algo/pyx/shapeFactor.pyx"/>
	<Function name="Calculate_doUpdate" description="Update soil temp stats (min/max/avg) and accumulate boundary layer conductance." language="cyml" type="external" filename="algo/pyx/Calculate_doUpdate.pyx"/>
	<Function name="Calculate_doThomas" description="Tri-diagonal Thomas algorithm solve for heat diffusion." language="cyml" type="external" filename="algo/pyx/Calculate_doThomas.pyx"/>
	<Function name="Calculate_getBoundaryLayerConductance" description="Compute boundary layer conductance with Monin-Obukhov stability corrections and radiative term." language="cyml" type="external" filename="algo/pyx/Calculate_getBoundaryLayerConductance.pyx"/>
	<Function name="math_log_safe" description="Safe natural logarithm." language="cyml" type="external" filename="algo/pyx/math_log_safe.pyx"/>
	<Function name="interpolateNetRadiation" description="Interpolate net radiation to sub-daily step including LW and SW with cloud and emissivity effects." language="cyml" type="external" filename="algo/pyx/interpolateNetRadiation.pyx"/>
	<Function name="interpolateTemperature" description="Interpolate sub-daily air temperature using sinusoidal diurnal cycle." language="cyml" type="external" filename="algo/pyx/interpolateTemperature.pyx"/>
	<Function name="math_sin" description="Sine wrapper." language="cyml" type="external" filename="algo/pyx/math_sin.pyx"/>
	<Function name="doThermalConductivity" description="Compute thermal conductivity layers via constituent mixing and map to nodes." language="cyml" type="external" filename="algo/pyx/doThermalConductivity.pyx"/>
	<Function name="doVolumetricSpecificHeat" description="Compute volumetric specific heat of soil via constituents and map to nodes." language="cyml" type="external" filename="algo/pyx/doVolumetricSpecificHeat.pyx"/>
	<Function name="Zero" description="Return a zeroed copy of an array (or empty if None)." language="cyml" type="external" filename="algo/pyx/Zero.pyx"/>
	<Function name="Calculate_doNetRadiation" description="Distribute daily solar radiation over sub-steps and estimate cloud fraction and vapour emissivity term." language="cyml" type="external" filename="algo/pyx/Calculate_doNetRadiation.pyx"/>
	<Function name="Calculate_doProcess" description="Core sub-daily loop: compute radiation, BL conductance, solve heat diffusion, and update stats." language="cyml" type="external" filename="algo/pyx/Calculate_doProcess.pyx"/>
	<Function name="ToCumThickness" description="Convert thickness array to cumulative depths." language="cyml" type="external" filename="algo/pyx/ToCumThickness.pyx"/>
	<Function name="calcSoilTemperature" description="Analytical soil temperature profile using damping depth and annual harmonics." language="cyml" type="external" filename="algo/pyx/calcSoilTemperature.pyx"/>
	<Function name="math_exp_safe" description="Safe exponential with overflow handling." language="cyml" type="external" filename="algo/pyx/math_exp_safe.pyx"/>
	<Function name="calcSurfaceTemperature" description="Estimate surface temperature from mean/max T, albedo, and radiation." language="cyml" type="external" filename="algo/pyx/calcSurfaceTemperature.pyx"/>
	<Function name="ValuesInArray" description="Check if an array contains any non-missing values (including NaN handling)." language="cyml" type="external" filename="algo/pyx/ValuesInArray.pyx"/>
	<Function name="init" description="Initialise arrays and parameters for the soil heat model." language="cyml" type="external" filename="algo/pyx/init.pyx"/>
	<Function name="process" description="Advance the model by one external time step and update all state variables." language="cyml" type="external" filename="algo/pyx/process.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/process.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
