<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperature" name="SoilTemperature" timestep="1" version="1.0">
	<Description>
		<Title>SoilTemperature</Title>
		<Authors>APSIM</Authors>
		<Institution>APSIM Initiative</Institution>
		<URI>-</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Soil temperature and surface energy balance model computing heat fluxes and temperatures across the atmosphere–surface–soil profile using a tridiagonal (Thomas) scheme, boundary-layer conductance, and constituent-based thermal properties; based on Campbell (1985).</ExtendedDescription>
		<ShortDescription>Heat flux and temperatures over the surface and soil profile (based on Campbell, 1985).</ShortDescription>
	</Description>
	<Inputs>
		<Input name="weather_MinT" description="Daily minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_MaxT" description="Daily maximum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_MeanT" description="Daily mean air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_Tav" description="Mean annual air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_Amp" description="Amplitude of annual temperature cycle" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_AirPressure" description="Air pressure" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="hPa" uri=""/>
		<Input name="weather_Wind" description="Wind speed at instrument height" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="m s-1" uri=""/>
		<Input name="weather_Latitude" description="Site latitude" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="90" min="-90" default="" unit="deg" uri=""/>
		<Input name="weather_Radn" description="Daily global solar radiation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="MJ m-2 d-1" uri=""/>
		<Input name="clock_Today_DayOfYear" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="366" min="1" default="" unit="-" uri=""/>
		<Input name="microClimate_CanopyHeight" description="Canopy height" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="0" default="" unit="mm" uri=""/>
		<Input name="physical_Thickness" description="Layer thicknesses" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="mm" uri=""/>
		<Input name="physical_BD" description="Bulk density by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="g cm-3" uri=""/>
		<Input name="ps" description="Particle density of soil minerals" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="2.65" unit="g cm-3" uri=""/>
		<Input name="physical_Rocks" description="Rock fragment content by layer (percent volume)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="physical_ParticleSizeSand" description="Sand fraction by layer (percent)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="physical_ParticleSizeSilt" description="Silt fraction by layer (percent)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="physical_ParticleSizeClay" description="Clay fraction by layer (percent)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="organic_Carbon" description="Organic carbon content by layer (percent)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="waterBalance_SW" description="Volumetric soil water by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="1" min="0" default="" unit="m3 m-3" uri=""/>
		<Input name="waterBalance_Eos" description="Soil evaporation supply term (rate)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="0" default="" unit="-" uri=""/>
		<Input name="waterBalance_Eo" description="Potential evaporation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="0" default="" unit="-" uri=""/>
		<Input name="waterBalance_Es" description="Actual soil evaporation (rate)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="0" default="" unit="-" uri=""/>
		<Input name="waterBalance_Salb" description="Soil surface albedo" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="" unit="-" uri=""/>
		<Input name="InitialValues" description="Initial soil temperature values for topsoil nodes (if provided), persisted" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="[]" unit="degC" uri=""/>
		<Input name="pInitialValues" description="Configured initial temperature values by layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="" min="" default="[]" unit="degC" uri=""/>
		<Input name="DepthToConstantTemperature" description="Depth to constant temperature lower boundary" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="4000" unit="mm" uri=""/>
		<Input name="timestep" description="External model time step in seconds" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="1" default="86400" unit="s" uri=""/>
		<Input name="latentHeatOfVapourisation" description="Latent heat of vaporisation" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="2450000" unit="J kg-1" uri=""/>
		<Input name="stefanBoltzmannConstant" description="Stefan-Boltzmann constant" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="5.67e-8" unit="W m-2 K-4" uri=""/>
		<Input name="airNode" description="Air node index in node arrays" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="0" default="0" unit="-" uri=""/>
		<Input name="surfaceNode" description="Surface node index in node arrays" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="0" default="1" unit="-" uri=""/>
		<Input name="topsoilNode" description="Topsoil node index" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="1" default="2" unit="-" uri=""/>
		<Input name="numPhantomNodes" description="Number of phantom nodes below soil profile" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="1" default="2" unit="-" uri=""/>
		<Input name="constantBoundaryLayerConductance" description="Constant boundary layer conductance (if used)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="" unit="-" uri=""/>
		<Input name="numIterationsForBoundaryLayerConductance" description="Iterations when solving for boundary layer conductance" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="0" default="3" unit="-" uri=""/>
		<Input name="defaultTimeOfMaximumTemperature" description="Default time of day for maximum air temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="24" min="0" default="15" unit="h" uri=""/>
		<Input name="defaultInstrumentHeight" description="Default instrument height if not specified" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0.1" default="2.0" unit="m" uri=""/>
		<Input name="bareSoilRoughness" description="Bare soil roughness height used to initialize soil roughness height" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="10" unit="mm" uri=""/>
		<Input name="doInitialisationStuff" description="Flag to run one-time initialisation of temperatures and states" inputtype="variable" variablecategory="state" datatype="INT" max="1" min="0" default="1" unit="-" uri=""/>
		<Input name="internalTimeStep" description="Internal integration time step used by the soil model" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="1" default="" unit="s" uri=""/>
		<Input name="timeOfDaySecs" description="Within-day simulation time" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="86400" min="0" default="" unit="s" uri=""/>
		<Input name="numNodes" description="Number of thermal nodes (including boundary/phantom as implemented)" inputtype="variable" variablecategory="state" datatype="INT" max="" min="3" default="" unit="-" uri=""/>
		<Input name="numLayers" description="Number of soil layers in profile" inputtype="variable" variablecategory="state" datatype="INT" max="" min="1" default="" unit="-" uri=""/>
		<Input name="nodeDepth" description="Depth of each node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="m" uri=""/>
		<Input name="thermCondPar1" description="Thermal conductivity empirical coefficient 1 by element/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="-" uri=""/>
		<Input name="thermCondPar2" description="Thermal conductivity empirical coefficient 2 by element/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="-" uri=""/>
		<Input name="thermCondPar3" description="Thermal conductivity empirical coefficient 3 by element/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="-" uri=""/>
		<Input name="thermCondPar4" description="Thermal conductivity empirical coefficient 4 by element/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="-" uri=""/>
		<Input name="volSpecHeatSoil" description="Volumetric specific heat at nodes" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="J m-3 K-1" uri=""/>
		<Input name="soilTemp" description="Soil temperature at nodes (air, surface, profile)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="degC" uri=""/>
		<Input name="morningSoilTemp" description="Soil temperature snapshot at ~5 AM for nodes" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="degC" uri=""/>
		<Input name="heatStorage" description="Heat storage term per node for implicit solver" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="W m-2 K-1 (scaled)" uri=""/>
		<Input name="thermalConductance" description="Element thermal conductance used by solver (node-based)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="-" uri=""/>
		<Input name="thermalConductivity" description="Thermal conductivity at nodes (includes BL conductance at air node)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="W m-1 K-1" uri=""/>
		<Input name="boundaryLayerConductance" description="Boundary layer conductance aggregated over the day" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="0" default="" unit="-" uri=""/>
		<Input name="newTemperature" description="Working new temperature vector for implicit solver (nodes)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="degC" uri=""/>
		<Input name="airTemperature" description="Current air temperature (interpolated intra-day if needed)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="maxTempYesterday" description="Yesterday's max air temperature used in interpolation" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="minTempYesterday" description="Yesterday's min air temperature used in interpolation" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="soilWater" description="Node-mapped volumetric soil water (includes phantom nodes fill)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="1" min="0" default="" unit="m3 m-3" uri=""/>
		<Input name="minSoilTemp" description="Minimum soil temperature per node for the current day" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="degC" uri=""/>
		<Input name="maxSoilTemp" description="Maximum soil temperature per node for the current day" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="degC" uri=""/>
		<Input name="aveSoilTemp" description="Average soil temperature per node over the day (accumulated within step)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="degC" uri=""/>
		<Input name="aveSoilWater" description="Placeholder average soil water by layer (unused here)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" default="[]" unit="m3 m-3" uri=""/>
		<Input name="thickness" description="Node thickness array including phantom nodes (indexing with nodes)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="mm" uri=""/>
		<Input name="bulkDensity" description="Bulk density mapped to nodes/elements (includes phantom fill)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="g cm-3" uri=""/>
		<Input name="rocks" description="Rock fraction by node/layer (percent volume)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="carbon" description="Organic carbon by node/layer (percent)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="sand" description="Sand fraction by node/layer (percent)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="pom" description="Particle density of organic matter" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="1.3" unit="g cm-3" uri=""/>
		<Input name="silt" description="Silt fraction by node/layer (percent)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="clay" description="Clay fraction by node/layer (percent)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="soilRoughnessHeight" description="Soil surface roughness height" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="" unit="mm" uri=""/>
		<Input name="instrumentHeight" description="Instrument height above ground (updated to be &gt;= canopy+0.5 m)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="0.5" default="" unit="m" uri=""/>
		<Input name="netRadiation" description="Net radiation at soil surface during sub-steps (aggregated as last value)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="" default="" unit="MJ m-2 per internal step" uri=""/>
		<Input name="canopyHeight" description="Effective canopy height used for BL calculations (&gt;= roughness)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="0" default="" unit="m" uri=""/>
		<Input name="instrumHeight" description="Optional direct instrument height input used during init selection" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="" unit="m" uri=""/>
		<Input name="nu" description="Implicit scheme weighting factor (Crank-Nicolson parameter)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.5" unit="-" uri=""/>
		<Input name="boundarLayerConductanceSource" description="Boundary layer conductance source selector: 'constant' or 'calc'" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="" min="" default="calc" unit="-" uri=""/>
		<Input name="netRadiationSource" description="Net radiation source selector: 'calc' or 'eos'" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="" min="" default="calc" unit="-" uri=""/>
		<Input name="MissingValue" description="Sentinel value used to mark missing data in arrays" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="-999" unit="-" uri=""/>
		<Input name="soilConstituentNames" description="Names of soil constituents considered in thermal property mixing (e.g., ['Rocks','OrganicMatter','Sand','Silt','Clay','Water','Air','Minerals'])" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="" min="" default="['Rocks','OrganicMatter','Sand','Silt','Clay','Water','Air','Minerals']" unit="-" uri=""/>
	</Inputs>
	<Outputs>
		<Output name="heatStorage" description="Heat storage term per node from implicit solver" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" unit="W m-2 K-1 (scaled)" uri=""/>
		<Output name="instrumentHeight" description="Updated instrument height above ground" variablecategory="state" datatype="DOUBLE" max="" min="0.5" unit="m" uri=""/>
		<Output name="canopyHeight" description="Updated effective canopy height" variablecategory="state" datatype="DOUBLE" max="" min="0" unit="m" uri=""/>
		<Output name="minSoilTemp" description="Minimum soil temperature per node during the day" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" unit="degC" uri=""/>
		<Output name="maxSoilTemp" description="Maximum soil temperature per node during the day" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" unit="degC" uri=""/>
		<Output name="aveSoilTemp" description="Average soil temperature per node over the day" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" unit="degC" uri=""/>
		<Output name="volSpecHeatSoil" description="Volumetric specific heat at nodes after mixing/mapping" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" unit="J m-3 K-1" uri=""/>
		<Output name="soilTemp" description="Updated soil temperature at nodes" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" unit="degC" uri=""/>
		<Output name="netRadiation" description="Net radiation at soil surface for the last internal step" variablecategory="state" datatype="DOUBLE" max="" min="" unit="MJ m-2 per internal step" uri=""/>
		<Output name="morningSoilTemp" description="Soil temperatures snapshot at ~5 AM (nodes)" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" unit="degC" uri=""/>
		<Output name="newTemperature" description="Working new temperature vector after solver step" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" unit="degC" uri=""/>
		<Output name="thermalConductivity" description="Thermal conductivity at nodes (includes BL at air node)" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" unit="W m-1 K-1" uri=""/>
		<Output name="thermalConductance" description="Element thermal conductance after solver step" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" unit="-" uri=""/>
		<Output name="boundaryLayerConductance" description="Aggregated boundary layer conductance for the day" variablecategory="state" datatype="DOUBLE" max="" min="0" unit="-" uri=""/>
		<Output name="maxTempYesterday" description="Updated previous day's maximum air temperature" variablecategory="state" datatype="DOUBLE" max="" min="" unit="degC" uri=""/>
		<Output name="minTempYesterday" description="Updated previous day's minimum air temperature" variablecategory="state" datatype="DOUBLE" max="" min="" unit="degC" uri=""/>
		<Output name="airTemperature" description="Air temperature used for the last internal step" variablecategory="state" datatype="DOUBLE" max="" min="" unit="degC" uri=""/>
		<Output name="internalTimeStep" description="Internal integration time step used within-day" variablecategory="state" datatype="DOUBLE" max="" min="1" unit="s" uri=""/>
		<Output name="timeOfDaySecs" description="Within-day time at end of process step" variablecategory="state" datatype="DOUBLE" max="86400" min="0" unit="s" uri=""/>
		<Output name="InitialValues" description="Persisted initial temperature values for topsoil nodes" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" unit="degC" uri=""/>
		<Output name="soilWater" description="Updated node volumetric soil water" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="1" min="0" unit="m3 m-3" uri=""/>
		<Output name="rocks" description="Rock fraction by node/layer (carried forward)" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" unit="%" uri=""/>
		<Output name="carbon" description="Organic carbon by node/layer (carried forward)" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" unit="%" uri=""/>
		<Output name="doInitialisationStuff" description="Initialisation flag state after running initialisation once" variablecategory="state" datatype="INT" max="1" min="0" unit="-" uri=""/>
	</Outputs>
	<Initialization name="init_soiltemperature" language="cyml" filename="algo/pyx/init_soiltemperature.pyx"/>
	<Function name="getIniVariables" description="Selects instrument height using provided value or a default." language="cyml" type="external" filename="algo/pyx/getIniVariables.pyx"/>
	<Function name="getProfileVariables" description="Allocates and constructs node/layer arrays and derived profiles including node depths and phantom nodes." language="cyml" type="external" filename="algo/pyx/getProfileVariables.pyx"/>
	<Function name="doThermalConductivityCoeffs" description="Computes empirical coefficients for soil thermal conductivity from texture and bulk density." language="cyml" type="external" filename="algo/pyx/doThermalConductivityCoeffs.pyx"/>
	<Function name="readParam" description="Initializes thermal conductivity coefficients and initial soil temperatures." language="cyml" type="external" filename="algo/pyx/readParam.pyx"/>
	<Function name="getOtherVariables" description="Maps water content to nodes and updates canopy and instrument heights." language="cyml" type="external" filename="algo/pyx/getOtherVariables.pyx"/>
	<Function name="volumetricFractionOrganicMatter" description="Computes volumetric fraction of organic matter." language="cyml" type="external" filename="algo/pyx/volumetricFractionOrganicMatter.pyx"/>
	<Function name="volumetricFractionRocks" description="Computes volumetric fraction of rocks." language="cyml" type="external" filename="algo/pyx/volumetricFractionRocks.pyx"/>
	<Function name="volumetricFractionIce" description="Returns volumetric fraction of ice (fixed 0)." language="cyml" type="external" filename="algo/pyx/volumetricFractionIce.pyx"/>
	<Function name="volumetricFractionWater" description="Computes volumetric fraction of water adjusted for organic matter." language="cyml" type="external" filename="algo/pyx/volumetricFractionWater.pyx"/>
	<Function name="volumetricFractionClay" description="Computes volumetric fraction of clay." language="cyml" type="external" filename="algo/pyx/volumetricFractionClay.pyx"/>
	<Function name="volumetricFractionSilt" description="Computes volumetric fraction of silt." language="cyml" type="external" filename="algo/pyx/volumetricFractionSilt.pyx"/>
	<Function name="volumetricFractionSand" description="Computes volumetric fraction of sand." language="cyml" type="external" filename="algo/pyx/volumetricFractionSand.pyx"/>
	<Function name="kelvinT" description="Converts Celsius to Kelvin." language="cyml" type="external" filename="algo/pyx/kelvinT.pyx"/>
	<Function name="Divide" description="Safe division with error value fallback." language="cyml" type="external" filename="algo/pyx/Divide.pyx"/>
	<Function name="Sum" description="Sums array segment ignoring MissingValue." language="cyml" type="external" filename="algo/pyx/Sum.pyx"/>
	<Function name="volumetricSpecificHeat" description="Returns volumetric specific heat for a constituent." language="cyml" type="external" filename="algo/pyx/volumetricSpecificHeat.pyx"/>
	<Function name="volumetricFractionAir" description="Computes volumetric fraction of air as the remaining fraction." language="cyml" type="external" filename="algo/pyx/volumetricFractionAir.pyx"/>
	<Function name="airDensity" description="Computes air density from temperature and pressure." language="cyml" type="external" filename="algo/pyx/airDensity.pyx"/>
	<Function name="longWaveRadn" description="Computes longwave radiation given emissivity and temperature." language="cyml" type="external" filename="algo/pyx/longWaveRadn.pyx"/>
	<Function name="mapLayer2Node" description="Maps layer-centered values to node-centered values by linear interpolation." language="cyml" type="external" filename="algo/pyx/mapLayer2Node.pyx"/>
	<Function name="ThermalConductance" description="Returns thermal conductance proxy; in this implementation returns volumetric specific heat for given constituent." language="cyml" type="external" filename="algo/pyx/ThermalConductance.pyx"/>
	<Function name="shapeFactor" description="Returns shape factor proxy; in this implementation returns volumetric specific heat for given constituent except special-cased ice/air/minerals." language="cyml" type="external" filename="algo/pyx/shapeFactor.pyx"/>
	<Function name="doUpdate" description="Updates min/max/average soil temperatures and aggregates boundary layer conductance." language="cyml" type="external" filename="algo/pyx/doUpdate.pyx"/>
	<Function name="doThomas" description="Thomas algorithm to solve tridiagonal heat diffusion system and update temperatures." language="cyml" type="external" filename="algo/pyx/doThomas.pyx"/>
	<Function name="getBoundaryLayerConductance" description="Calculates boundary layer conductance using Monin-Obukhov similarity including radiative term." language="cyml" type="external" filename="algo/pyx/getBoundaryLayerConductance.pyx"/>
	<Function name="interpolateNetRadiation" description="Interpolates net radiation at soil surface for an internal time step." language="cyml" type="external" filename="algo/pyx/interpolateNetRadiation.pyx"/>
	<Function name="interpolateTemperature" description="Interpolates intra-day air temperature using sinusoidal diurnal cycle." language="cyml" type="external" filename="algo/pyx/interpolateTemperature.pyx"/>
	<Function name="doThermalConductivity" description="Computes effective thermal conductivity by mixing constituents and mapping to nodes." language="cyml" type="external" filename="algo/pyx/doThermalConductivity.pyx"/>
	<Function name="doVolumetricSpecificHeat" description="Computes effective volumetric specific heat and maps to nodes." language="cyml" type="external" filename="algo/pyx/doVolumetricSpecificHeat.pyx"/>
	<Function name="Zero" description="Returns a zero-filled array with same length as input." language="cyml" type="external" filename="algo/pyx/Zero.pyx"/>
	<Function name="doNetRadiation" description="Distributes daily solar radiation over internal steps and estimates cloud fraction and vapour parameter." language="cyml" type="external" filename="algo/pyx/doNetRadiation.pyx"/>
	<Function name="doProcess" description="Runs intra-day loop: updates air temperature, net radiation, BL conductance, solves heat diffusion, updates diagnostics." language="cyml" type="external" filename="algo/pyx/doProcess.pyx"/>
	<Function name="ToCumThickness" description="Computes cumulative thicknesses from layer thicknesses." language="cyml" type="external" filename="algo/pyx/ToCumThickness.pyx"/>
	<Function name="calcSoilTemperature" description="Initializes soil temperature profile using annual sinusoidal solution." language="cyml" type="external" filename="algo/pyx/calcSoilTemperature.pyx"/>
	<Function name="calcSurfaceTemperature" description="Estimates surface temperature from mean/max air temperature and albedo." language="cyml" type="external" filename="algo/pyx/calcSurfaceTemperature.pyx"/>
	<Function name="ValuesInArray" description="Checks whether an array contains any non-missing values." language="cyml" type="external" filename="algo/pyx/ValuesInArray.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/model_soiltemperature.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
