<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperatureSWAT" name="SoilTemperatureSWAT" timestep="1" version="001">
	<Description>
		<Title>SoilTemperatureSWAT</Title>
		<Authors>Simone Bregaglio; Nicolò Frasso</Authors>
		<Institution>University Of Milan</Institution>
		<URI>http://bioma.jrc.ec.europa.eu/ontology/JRC_MARS_biophysical_domain.owl</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Computes daily soil temperature by layers using the SWAT 2000 damping‑depth approach. The method blends previous-day layer temperatures with a lag coefficient and updates each layer’s temperature using depth-dependent damping derived from soil bulk density, volumetric water content, total profile water, and layer thickness. The depth factor scales the difference between annual mean air temperature and surface soil temperature. Reference: Neitsch et al., SWAT Theoretical Documentation (Version 2000): http://swatmodel.tamu.edu/media/1290/swat2000theory.pdf.</ExtendedDescription>
		<ShortDescription>SWAT-based daily soil temperature profile using a lagged, depth-damping formulation.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="LagCoefficient" description="Lag coefficient that controls the influence of the previous day's temperature on the current day's temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.8" unit="dimensionless" uri="-"/>
		<Input name="SoilProfileDepth" description="Soil profile depth" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="50" min="0" default="3" unit="m" uri="-"/>
		<Input name="SurfaceSoilTemperature" description="Average surface soil temperature" inputtype="variable" variablecategory="auxiliary" datatype="DOUBLE" max="60" min="-60" default="25" unit="degC" uri="-"/>
		<Input name="AirTemperatureAnnualAverage" description="Annual average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="50" min="-40" default="15" unit="degC" uri="-"/>
		<Input name="SoilTemperatureByLayers" description="Soil temperature of each layer (state from previous step)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="60" min="-60" default="15" unit="degC" uri="-"/>
		<Input name="BulkDensity" description="Bulk density by soil layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="1.8" min="0.9" default="1.3" unit="t m-3" uri="-"/>
		<Input name="VolumetricWaterContent" description="Volumetric soil water content by layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="0.8" min="0" default="0.25" unit="m3 m-3" uri="-"/>
		<Input name="LayerThickness" description="Soil layer thickness" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="3" min="0.005" default="0.05" unit="m" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="SoilTemperatureByLayers" description="Updated soil temperature of each layer" variablecategory="state" datatype="DOUBLEARRAY" len="SOILPROP_NLAYR" max="60" min="-60" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="Init" description="Initialize soil temperature by layers to 15 degC for all layers." language="cyml" type="external" filename="algo/pyx/Init.pyx"/>
	<Function name="Estimate" description="Compute soil temperature by layers using the SWAT method with damping depth and lag." language="cyml" type="external" filename="algo/pyx/Estimate.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
