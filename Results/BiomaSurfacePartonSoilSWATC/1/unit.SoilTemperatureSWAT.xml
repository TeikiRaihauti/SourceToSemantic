<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperatureSWAT" name="SoilTemperatureSWAT" timestep="1" version="001">
	<Description>
		<Title>SoilTemperatureSWAT</Title>
		<Authors>Simone Bregaglio; Nicolò Frasso</Authors>
		<Institution>University Of Milan</Institution>
		<URI>http://bioma.jrc.ec.europa.eu/ontology/JRC_MARS_biophysical_domain.owl</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Computes daily soil temperature by layers using the SWAT 2000 damping‑depth approach. The method blends previous-day layer temperatures with a lag coefficient and updates each layer’s temperature using depth-dependent damping derived from soil bulk density, volumetric water content, total profile water, and layer thickness. The depth factor scales the difference between annual mean air temperature and surface soil temperature. Reference: Neitsch et al., SWAT Theoretical Documentation (Version 2000): http://swatmodel.tamu.edu/media/1290/swat2000theory.pdf.</ExtendedDescription>
		<ShortDescription>SWAT-based daily soil temperature profile using a lagged, depth-damping formulation.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="states_LayerThickness" description="Soil layer thickness for each layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="" min="" default="None" unit="m" uri=""/>
		<Input name="LagCoefficient" description="Lag coefficient controlling influence of previous day temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="0.8" unit="-" uri=""/>
		<Input name="states_SoilProfileDepth" description="Soil profile depth" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="0.0" unit="m" uri=""/>
		<Input name="states_SurfaceSoilTemperature" description="Average surface soil temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="0.0" unit="degC" uri=""/>
		<Input name="exogenous_AirTemperatureAnnualAverage" description="Annual average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="0.0" unit="degC" uri=""/>
		<Input name="states_SoilTemperatureByLayers" description="Soil temperature of each layer from previous day" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="-" max="" min="" default="None" unit="degC" uri=""/>
		<Input name="states_BulkDensity" description="Bulk density of each layer" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="-" max="" min="" default="None" unit="t m-3" uri=""/>
		<Input name="states_VolumetricWaterContent" description="Volumetric soil water content of each layer" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="-" max="" min="" default="None" unit="m3 m-3" uri=""/>
	</Inputs>
	<Outputs>
		<Output name="states_SoilTemperatureByLayers_new" description="Updated soil temperature of each layer" variablecategory="state" datatype="DOUBLELIST" len="-" max="" min="" unit="degC" uri=""/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="Init" description="Initialize soil temperature by layers to 15 degC for all layers." language="cyml" type="external" filename="algo/pyx/Init.pyx"/>
	<Function name="Estimate" description="Compute soil temperature by layers using the SWAT method." language="cyml" type="external" filename="algo/pyx/Estimate.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name=""/>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
