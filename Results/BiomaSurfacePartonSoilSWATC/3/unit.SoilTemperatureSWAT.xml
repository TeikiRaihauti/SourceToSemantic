<?xml version="1.0" ?>
<ModelUnit modelid=".SoilTemperatureSWAT" name="SoilTemperatureSWAT" timestep="1" version="001">
	<Description>
		<Title>SoilTemperatureSWAT</Title>
		<Authors>Simone Bregaglio; Nicolò Frasso</Authors>
		<Institution>University Of Milan</Institution>
		<URI>http://bioma.jrc.ec.europa.eu/ontology/JRC_MARS_biophysical_domain.owl</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Calculates soil temperature by layers using the SWAT method (Neitsch et al., 2000). Each layer’s temperature is updated with a lagged combination of its prior value and an equilibrium temperature derived from annual average air temperature and current surface soil temperature. The approach computes a depth-dependent damping depth using soil profile depth, bulk density, layer thickness, and volumetric water content.</ExtendedDescription>
		<ShortDescription>Depth-resolved soil temperature model based on SWAT with lag and damping by soil properties.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="states_LayerThickness" description="Layer thickness (m), list/array length = number of layers" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="number of layers" max="-" min="-" default="-" unit="m" uri="-"/>
		<Input name="states_SoilProfileDepth" description="Soil profile depth (m)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="m" uri="-"/>
		<Input name="states_SurfaceSoilTemperature" description="Average surface soil temperature (degC)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="exogenous_AirTemperatureAnnualAverage" description="Annual average air temperature (degC)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="states_SoilTemperatureByLayers" description="Previous day's soil temperature of each layer (degC)" inputtype="variable" variablecategory="state" datatype="DOUBLELIST" len="number of layers" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="states_BulkDensity" description="Bulk density per layer (t m-3)" inputtype="parameter" parametercategory="constant" datatype="DOUBLELIST" len="number of layers" max="-" min="-" default="-" unit="t m-3" uri="-"/>
		<Input name="states_VolumetricWaterContent" description="Volumetric water content per layer (m3 m-3)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLELIST" len="number of layers" max="-" min="-" default="-" unit="m3 m-3" uri="-"/>
		<Input name="LagCoefficient" description="Lag coefficient (dimensionless, 0-1)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="-" unit="-" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="states1_SoilTemperatureByLayers" description="Updated soil temperature of each layer (degC)" variablecategory="state" datatype="DOUBLELIST" len="number of layers" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
