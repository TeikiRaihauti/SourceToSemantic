<?xml version="1.0" ?>
<ModelUnit modelid=".CalculateSoilTemperature" name="CalculateSoilTemperature" timestep="1" version="1.0.0.0">
	<Description>
		<Title>CalculateSoilTemperature</Title>
		<Authors>Loic Manceau</Authors>
		<Institution>INRA</Institution>
		<URI>http://biomamodelling.org</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Computes daily minimum and maximum soil temperature using air temperature inputs (min/mean/max), soil heat flux, and a latent heat parameter, with a deep-layer temperature memory that is initialized from the annual mean air temperature and updated by exponential smoothing.</ExtendedDescription>
		<ShortDescription>Daily min/max soil temperature with deep-layer memory.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="exogenous_meanAnnualAirTemp" description="Mean annual air temperature used to initialize deeplayerstates_deepLayerT." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="deeplayerstates_deepLayerT" description="Deep layer temperature state from previous step." inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="exogenous_maxTAir" description="Daily maximum air temperature driver." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="exogenous_meanTAir" description="Daily mean air temperature driver." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="exogenous_minTAir" description="Daily minimum air temperature driver." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ratesexternal_heatFlux" description="Soil heat flux driver." inputtype="variable" variablecategory="rate" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="lambda_" description="Scaling coefficient for SoilAvailableEnergy in SoilTempA." inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="deeplayerstates_deepLayerT" description="Updated deep layer temperature." variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="states_maxTSoil" description="Daily maximum soil temperature." variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="states_minTSoil" description="Daily minimum soil temperature." variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="SoilTempA" description="Estimate soil temperature from weatherMaxTemp, weatherMeanTemp, soilHeatFlux, and lambda_." language="cyml" type="external" filename="algo/pyx/SoilTempA.pyx"/>
	<Function name="SoilTempB" description="Estimate soil temperature from weatherMinTemp and deepTemperature." language="cyml" type="external" filename="algo/pyx/SoilTempB.pyx"/>
	<Function name="SoilMinimumTemperature" description="Return minimum of SoilTempA and SoilTempB." language="cyml" type="external" filename="algo/pyx/SoilMinimumTemperature.pyx"/>
	<Function name="SoilMaximumTemperature" description="Return maximum of SoilTempA and SoilTempB." language="cyml" type="external" filename="algo/pyx/SoilMaximumTemperature.pyx"/>
	<Function name="UpdateTemperature" description="Update deep layer temperature by smoothing with mean of min and max soil temperatures." language="cyml" type="external" filename="algo/pyx/UpdateTemperature.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
