<?xml version="1.0" ?>
<ModelUnit modelid=".SiriusQuality Soil Temperature" name="SiriusQuality Soil Temperature" timestep="1" version="1.0.0.0">
	<Description>
		<Title>SiriusQuality Soil Temperature</Title>
		<Authors>Loic Manceau</Authors>
		<Institution>INRA</Institution>
		<URI>http://biomamodelling.org</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Component to simulate soil temperature dynamics. It computes daily minimum and maximum soil temperature using two estimates: (A) a function of air temperatures and soil heat flux scaled by the latent heat parameter (lambda_), with a cold-season adjustment, and (B) the average of daily minimum air temperature and deep-layer temperature; the extrema are the min/max of A and B. The deep soil layer temperature is updated by exponential smoothing of the daily mean soil temperature and initialized to the annual mean air temperature. Optionally, hourly soil surface temperature is generated with the Parton-Logan (1981) diurnal model parameterized by a, b, and c and driven by day length. Inputs include maxTAir, meanTAir, minTAir, meanAnnualAirTemp, and heatFlux; outputs include minTSoil, maxTSoil, hourlySoilT, and deepLayerT.</ExtendedDescription>
		<ShortDescription>Calculates daily min/max soil temperature, updates deep-layer temperature, and optionally generates hourly soil temperatures.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="exogenous_meanAnnualAirTemp" description="Mean annual air temperature used to initialize deep layer temperature." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="deeplayerstates_deepLayerT" description="Deep layer temperature state at previous step." inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="exogenous_maxTAir" description="Daily maximum air temperature." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="exogenous_meanTAir" description="Daily mean air temperature." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="exogenous_minTAir" description="Daily minimum air temperature." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="ratesexternal_heatFlux" description="Soil heat flux from an external module." inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
		<Input name="lambda_" description="Scaling parameter for converting soil heat flux to available energy." inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="-" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="states_minTSoil" description="Computed minimum soil temperature for the day." variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="states_maxTSoil" description="Computed maximum soil temperature for the day." variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
		<Output name="deeplayerstates_deepLayerT" description="Updated deep layer temperature state." variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="-" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="SoilMinimumTemperature" description="Minimum soil temperature as the minimum of SoilTempA and SoilTempB." language="cyml" type="external" filename="algo/pyx/SoilMinimumTemperature.pyx"/>
	<Function name="SoilMaximumTemperature" description="Maximum soil temperature as the maximum of SoilTempA and SoilTempB." language="cyml" type="external" filename="algo/pyx/SoilMaximumTemperature.pyx"/>
	<Function name="SoilTempA" description="Energy- and meteorology-based soil temperature estimate using weatherMaxTemp, weatherMeanTemp, soilHeatFlux, and lambda_." language="cyml" type="external" filename="algo/pyx/SoilTempA.pyx"/>
	<Function name="SoilTempB" description="Temperature estimate as the average of weatherMinTemp and deepTemperature." language="cyml" type="external" filename="algo/pyx/SoilTempB.pyx"/>
	<Function name="UpdateTemperature" description="Updates deep layer temperature by smoothing with the mean of min and max soil temperatures." language="cyml" type="external" filename="algo/pyx/UpdateTemperature.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/CalculateModel.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
