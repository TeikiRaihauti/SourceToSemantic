<?xml version="1.0" ?>
<ModelUnit modelid=".SiriusQuality-SoilTemperature" name="SiriusQuality-SoilTemperature" timestep="1" version="1.0.0.0">
	<Description>
		<Title>SiriusQuality-SoilTemperature</Title>
		<Authors>Loic Manceau</Authors>
		<Institution>INRA</Institution>
		<URI>http://biomamodelling.org</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Soil temperature component providing daily minimum and maximum soil temperatures and, optionally, an hourly soil temperature profile. Daily min/max are computed from air temperatures, soil heat flux, and the latent heat parameter (lambda_) using two formulations: (A) a heat-flux driven function with a low-temperature adjustment and (B) an average of air minimum and deep-layer temperature; min is the minimum of A and B, max is the maximum of A and B. Deep-layer temperature is updated by exponential smoothing of daily mean soil temperature. Hourly temperatures follow the Parton and Logan (1981) diurnal scheme parameterized by a, b, and c and the day length. Inputs include max/min/mean air temperature, mean annual air temperature (for initialization), soil heat flux, and day length; outputs include daily min/max soil temperature, hourly soil temperature (optional), and deep-layer temperature.</ExtendedDescription>
		<ShortDescription>Component to compute daily min/max and optional hourly soil temperatures from weather and soil heat flux, with deep-layer temperature smoothing.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="deeplayerstates_deepLayerT" description="Deep soil layer temperature from previous step" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="exogenous_meanAnnualAirTemp" description="Annual mean air temperature used to initialize deep soil layer temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="exogenous_maxTAir" description="Daily maximum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="exogenous_meanTAir" description="Daily mean air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="exogenous_minTAir" description="Daily minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="degC" uri="-"/>
		<Input name="ratesexternal_heatFlux" description="Soil heat flux" inputtype="variable" variablecategory="rate" datatype="DOUBLE" max="-" min="-" default="-" unit="g m-2 d-1" uri="-"/>
		<Input name="lambda_" description="Latent heat of vaporization of water" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="-" unit="MJ kg-1" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="states_minTSoil" description="Computed minimum daily soil temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="states_maxTSoil" description="Computed maximum daily soil temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
		<Output name="deeplayerstates_deepLayerT" description="Updated deep soil layer temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="degC" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="Init" description="Initialize deep soil layer temperature to the annual mean air temperature." language="cyml" type="external" filename="algo/pyx/Init.pyx"/>
	<Function name="Estimate" description="Compute daily min/max soil temperatures and update deep layer temperature." language="cyml" type="external" filename="algo/pyx/Estimate.pyx"/>
	<Function name="SoilMinimumTemperature" description="Return the minimum of SoilTempA and SoilTempB." language="cyml" type="external" filename="algo/pyx/SoilMinimumTemperature.pyx"/>
	<Function name="SoilMaximumTemperature" description="Return the maximum of SoilTempA and SoilTempB." language="cyml" type="external" filename="algo/pyx/SoilMaximumTemperature.pyx"/>
	<Function name="SoilTempA" description="Estimate soil temperature from weatherMaxTemp, weatherMeanTemp, soilHeatFlux, and lambda_, including cold adjustment." language="cyml" type="external" filename="algo/pyx/SoilTempA.pyx"/>
	<Function name="SoilTempB" description="Estimate soil temperature as the average of weatherMinTemp and deepTemperature." language="cyml" type="external" filename="algo/pyx/SoilTempB.pyx"/>
	<Function name="UpdateTemperature" description="Update deep layer temperature using a weighted moving average of previous temperature and mean soil temperature." language="cyml" type="external" filename="algo/pyx/UpdateTemperature.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets>
		<Testset name="t_-" description="-">
			<Test name="t_-">
				<OutputValue name="-">-</OutputValue>
			</Test>
		</Testset>
	</Testsets>
</ModelUnit>
