<?xml version="1.0" ?>
<ModelUnit modelid=".SiriusQuality Soil Temperature" name="SiriusQuality Soil Temperature" timestep="1" version="1.0.0.0">
	<Description>
		<Title>SiriusQuality Soil Temperature</Title>
		<Authors>Loic Manceau</Authors>
		<Institution>INRA</Institution>
		<URI>http://biomamodelling.org</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Soil temperature component of SiriusQuality. It computes daily minimum and maximum soil temperature from air temperatures (min/mean/max) and soil heat flux, using an energy-based function (with latent heat of vaporization parameter λ and a cold adjustment below 8 °C) and a deep-layer coupling; the final min/max are the min/max of two estimates. The deep soil layer temperature is a state updated as an exponential moving average of daily mean soil temperature. Optionally, hourly soil surface temperature is generated using the Parton–Logan (1981) diurnal model parameterized by a, b, c and day length. Initialization sets deep-layer temperature from the annual mean air temperature; special missing/sentinel values (-999/999) are handled. Inputs include maxTAir, minTAir, meanTAir, meanAnnualAirTemp, dayLength, and heatFlux; outputs include minTSoil, maxTSoil, hourlySoilT, and deepLayerT.</ExtendedDescription>
		<ShortDescription>Computes daily min/max (and optional hourly) soil temperature from air temperatures, soil heat flux, and deep-layer temperature.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="deeplayerstates_deepLayerT" description="Deep soil layer temperature" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="-" unit="C" uri="-"/>
		<Input name="exogenous_meanAnnualAirTemp" description="Annual mean air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="C" uri="-"/>
		<Input name="exogenous_maxTAir" description="Maximum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="C" uri="-"/>
		<Input name="exogenous_meanTAir" description="Mean air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="C" uri="-"/>
		<Input name="exogenous_minTAir" description="Minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="C" uri="-"/>
		<Input name="ratesexternal_heatFlux" description="Soil heat flux" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="-" min="-" default="-" unit="g m-2 d-1" uri="-"/>
		<Input name="lambda_" description="Latent heat of water vaporization at 20 C" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="-" min="-" default="2.454" unit="MJ kg-1" uri="-"/>
	</Inputs>
	<Outputs>
		<Output name="states_minTSoil" description="Computed minimum soil temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="C" uri="-"/>
		<Output name="states_maxTSoil" description="Computed maximum soil temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="C" uri="-"/>
		<Output name="deeplayerstates_deepLayerT" description="Updated deep layer temperature" variablecategory="state" datatype="DOUBLE" max="-" min="-" unit="C" uri="-"/>
	</Outputs>
	<Initialization name="Init" language="cyml" filename="algo/pyx/Init.pyx"/>
	<Function name="Init" description="Initialize deep soil layer temperature." language="cyml" type="external" filename="algo/pyx/Init.pyx"/>
	<Function name="Estimate" description="Compute daily minimum and maximum soil temperature and update deep layer temperature." language="cyml" type="external" filename="algo/pyx/Estimate.pyx"/>
	<Function name="SoilMinimumTemperature" description="Soil minimum temperature (C)." language="cyml" type="external" filename="algo/pyx/SoilMinimumTemperature.pyx"/>
	<Function name="SoilMaximumTemperature" description="Soil maximum temperature (C)." language="cyml" type="external" filename="algo/pyx/SoilMaximumTemperature.pyx"/>
	<Function name="SoilTempA" description="Soil temperature A component." language="cyml" type="external" filename="algo/pyx/SoilTempA.pyx"/>
	<Function name="SoilTempB" description="Soil temperature B component." language="cyml" type="external" filename="algo/pyx/SoilTempB.pyx"/>
	<Function name="UpdateTemperature" description="Update the deep soil layer temperature using a weighted average of previous deep temperature and current mean soil temperature." language="cyml" type="external" filename="algo/pyx/UpdateTemperature.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/Estimate.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
