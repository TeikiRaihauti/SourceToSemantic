<?xml version="1.0" ?>
<ModelUnit modelid=".Soil Temperature" name="Soil Temperature" timestep="1" version="-">
	<Description>
		<Title>Soil Temperature</Title>
		<Authors>-</Authors>
		<Institution>-</Institution>
		<URI>Models.Soils.SoilTemp.SoilTemperature</URI>
		<Reference>-</Reference>
		<ExtendedDescription>Simulates soil temperature dynamics across the profile, including the surface, using sub-daily heat flux calculations. Implements Campbell (1985) formulations for volumetric heat capacity and thermal conductivity, solves the tri-diagonal heat diffusion system via the Thomas algorithm, and calculates atmospheric boundary layer conductance with radiative and stability corrections. Uses weather, soil physical/organic properties, and soil water inputs; outputs include min/max/average soil and surface temperatures and thermal properties.</ExtendedDescription>
		<ShortDescription>Soil temperature profile and surface model based on Campbell (1985) with sub-daily heat conduction and boundary-layer exchange.</ShortDescription>
	</Description>
	<Inputs>
		<Input name="physical_Thickness" description="Layer thicknesses" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="-" uri=""/>
		<Input name="physical_BD" description="Layer bulk density" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="-" uri=""/>
		<Input name="physical_Rocks" description="Layer rock fraction (%)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="%" uri=""/>
		<Input name="physical_ParticleSizeSand" description="Layer sand fraction (%)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="%" uri=""/>
		<Input name="physical_ParticleSizeSilt" description="Layer silt fraction (%)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="%" uri=""/>
		<Input name="physical_ParticleSizeClay" description="Layer clay fraction (%)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="%" uri=""/>
		<Input name="organic_Carbon" description="Layer organic carbon (%)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="%" uri=""/>
		<Input name="waterBalance_SW" description="Layer soil water content (volumetric or equivalent)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLEARRAY" len="-" max="" min="" default="" unit="-" uri=""/>
		<Input name="waterBalance_Eo" description="Potential evaporation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="-" uri=""/>
		<Input name="waterBalance_Eos" description="Soil evaporation supply (or soil-limited evaporation)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="-" uri=""/>
		<Input name="waterBalance_Es" description="Actual soil evaporation" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="-" uri=""/>
		<Input name="waterBalance_Salb" description="Soil albedo (0-1)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="1" min="0" default="" unit="-" uri=""/>
		<Input name="microClimate_CanopyHeight" description="Canopy height" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="mm" uri=""/>
		<Input name="weather_MeanT" description="Daily mean air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_MaxT" description="Daily maximum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_MinT" description="Daily minimum air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_Tav" description="Long-term average air temperature" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="50" min="-30" default="" unit="degC" uri=""/>
		<Input name="weather_Amp" description="Annual temperature amplitude" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="degC" uri=""/>
		<Input name="weather_AirPressure" description="Air pressure" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="hPa" uri=""/>
		<Input name="weather_Radn" description="Incoming solar radiation (daily total)" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="-" uri=""/>
		<Input name="weather_Wind" description="Wind speed at instrument height" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="" min="" default="" unit="m/s" uri=""/>
		<Input name="weather_Latitude" description="Site latitude" inputtype="variable" variablecategory="exogenous" datatype="DOUBLE" max="90" min="-90" default="" unit="deg" uri=""/>
		<Input name="clock_Today_DayOfYear" description="Day of year" inputtype="variable" variablecategory="exogenous" datatype="INT" max="366" min="1" default="" unit="day" uri=""/>
		<Input name="DepthToConstantTemperature" description="Depth to constant temperature boundary" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="10000.0" unit="mm" uri=""/>
		<Input name="instrumHeight" description="Configured instrument height (used if &gt; 0)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="0.0" unit="m" uri=""/>
		<Input name="defaultTimeOfMaximumTemperature" description="Default local time of daily maximum temperature" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="24" min="0" default="14.0" unit="hour" uri=""/>
		<Input name="InitialValues" description="Optional initial layer temperatures (top to bottom)" inputtype="parameter" parametercategory="constant" datatype="DOUBLEARRAY" len="-" max="" min="" default="-" unit="degC" uri=""/>
		<Input name="pom" description="Organic matter density parameter" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="1.3" unit="-" uri=""/>
		<Input name="ps" description="Mineral particle density parameter" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="2.63" unit="-" uri=""/>
		<Input name="soilConstituentNames" description="Names of soil constituents used in thermal mix" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="" min="" default="['Rocks','OrganicMatter','Sand','Silt','Clay','Water','Ice','Air']" unit="-" uri=""/>
		<Input name="timestep" description="Model time step (seconds)" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="86400.0" unit="s" uri=""/>
		<Input name="latentHeatOfVapourisation" description="Latent heat of vaporization" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="2465000.0" unit="J/kg" uri=""/>
		<Input name="stefanBoltzmannConstant" description="Stefan-Boltzmann constant" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="" default="5.67e-08" unit="W m^-2 K^-4" uri=""/>
		<Input name="airNode" description="Index of air node" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="0" default="0" unit="-" uri=""/>
		<Input name="surfaceNode" description="Index of surface node" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="1" default="1" unit="-" uri=""/>
		<Input name="topsoilNode" description="Index of topsoil node" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="2" default="2" unit="-" uri=""/>
		<Input name="numPhantomNodes" description="Number of phantom nodes below profile" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="0" default="5" unit="-" uri=""/>
		<Input name="constantBoundaryLayerConductance" description="Constant boundary layer conductance when using 'constant' source" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="20.0" unit="-" uri=""/>
		<Input name="numIterationsForBoundaryLayerConductance" description="Iterations for BL conductance/temperature coupling each substep" inputtype="parameter" parametercategory="constant" datatype="INT" max="" min="0" default="1" unit="-" uri=""/>
		<Input name="bareSoilRoughness" description="Bare soil roughness height" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="" min="0" default="57.0" unit="mm" uri=""/>
		<Input name="nu" description="Implicit weighting factor for Thomas algorithm" inputtype="parameter" parametercategory="constant" datatype="DOUBLE" max="1" min="0" default="0.6" unit="-" uri=""/>
		<Input name="boundarLayerConductanceSource" description="Boundary-layer conductance source ('calc' or 'constant')" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="" min="" default="calc" unit="-" uri=""/>
		<Input name="netRadiationSource" description="Net radiation source ('calc' or 'eos')" inputtype="parameter" parametercategory="constant" datatype="CHAR" max="" min="" default="calc" unit="-" uri=""/>
		<Input name="numLayers" description="Number of soil layers" inputtype="variable" variablecategory="state" datatype="INT" max="" min="0" default="" unit="-" uri=""/>
		<Input name="numNodes" description="Number of thermal nodes (layers + phantom nodes)" inputtype="variable" variablecategory="state" datatype="INT" max="" min="0" default="" unit="-" uri=""/>
		<Input name="thickness" description="Node/layer thickness array used by solver" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="mm" uri=""/>
		<Input name="nodeDepth" description="Node depths from surface" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="m" uri=""/>
		<Input name="bulkDensity" description="Bulk density by node/layer" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="-" uri=""/>
		<Input name="soilWater" description="Soil water content per node/layer" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="1" min="0" default="" unit="-" uri=""/>
		<Input name="carbon" description="Organic carbon (%) per layer/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="rocks" description="Rock fraction (%) per layer/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="sand" description="Sand fraction (%) per layer/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="silt" description="Silt fraction (%) per layer/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="clay" description="Clay fraction (%) per layer/node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="0" default="" unit="%" uri=""/>
		<Input name="soilTemp" description="Current node temperatures (including air and phantom nodes)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="" unit="degC" uri=""/>
		<Input name="newTemperature" description="Workspace for updated node temperatures" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="" unit="degC" uri=""/>
		<Input name="volSpecHeatSoil" description="Volumetric specific heat per node" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="-" uri=""/>
		<Input name="thermalConductivity" description="Thermal conductivity per node (mapped from layers)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="-" uri=""/>
		<Input name="heatStorage" description="Node heat storage coefficient for implicit scheme" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="-" uri=""/>
		<Input name="thermalConductance" description="Element thermal conductance between nodes (including air node)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" default="" unit="-" uri=""/>
		<Input name="minSoilTemp" description="Minimum node temperature for the day" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="" unit="degC" uri=""/>
		<Input name="maxSoilTemp" description="Maximum node temperature for the day" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="" unit="degC" uri=""/>
		<Input name="aveSoilTemp" description="Average node temperature for the day (accumulator)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="" unit="degC" uri=""/>
		<Input name="morningSoilTemp" description="Node temperatures captured near morning (around 5 AM)" inputtype="variable" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="-" min="-" default="" unit="degC" uri=""/>
		<Input name="instrumentHeight" description="Effective instrument height used in BL calculations" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="0" default="" unit="m" uri=""/>
		<Input name="canopyHeight" description="Effective canopy height (considering soil roughness)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="0" default="" unit="m" uri=""/>
		<Input name="soilRoughnessHeight" description="Soil surface roughness height used to constrain canopy height minimum" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="0" default="" unit="mm" uri=""/>
		<Input name="boundaryLayerConductance" description="Mean boundary layer conductance aggregated over substeps" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="0" default="" unit="-" uri=""/>
		<Input name="netRadiation" description="Net radiation input to the surface at current substep" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="" default="" unit="-" uri=""/>
		<Input name="internalTimeStep" description="Internal substep size used for the implicit solver" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="" min="0" default="" unit="s" uri=""/>
		<Input name="timeOfDaySecs" description="Seconds since midnight within the day during substepping" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="86400" min="0" default="" unit="s" uri=""/>
		<Input name="airTemperature" description="Air node temperature at each substep" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="" unit="degC" uri=""/>
		<Input name="maxTempYesterday" description="Yesterday's maximum air temperature (for diurnal interpolation)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="" unit="degC" uri=""/>
		<Input name="minTempYesterday" description="Yesterday's minimum air temperature (for diurnal interpolation)" inputtype="variable" variablecategory="state" datatype="DOUBLE" max="-" min="-" default="" unit="degC" uri=""/>
	</Inputs>
	<Outputs>
		<Output name="soilTemp" description="Updated node temperatures after the daily step" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="-50" unit="degC" uri=""/>
		<Output name="minSoilTemp" description="Daily minimum node temperatures" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="-50" unit="degC" uri=""/>
		<Output name="maxSoilTemp" description="Daily maximum node temperatures" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="-50" unit="degC" uri=""/>
		<Output name="aveSoilTemp" description="Daily average node temperatures" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="-50" unit="degC" uri=""/>
		<Output name="morningSoilTemp" description="Node temperatures near 5 AM snapshot" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="-50" unit="degC" uri=""/>
		<Output name="volSpecHeatSoil" description="Volumetric specific heat of soil by node" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" unit="-" uri=""/>
		<Output name="thermalConductivity" description="Thermal conductivity by node" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" unit="-" uri=""/>
		<Output name="heatStorage" description="Heat storage coefficient by node" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" unit="-" uri=""/>
		<Output name="thermalConductance" description="Element thermal conductance including air node" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="0" unit="-" uri=""/>
		<Output name="boundaryLayerConductance" description="Daily-mean boundary-layer conductance aggregated from substeps" variablecategory="state" datatype="DOUBLE" max="" min="0" unit="-" uri=""/>
		<Output name="newTemperature" description="Last substep node temperatures from the implicit solver" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="100" min="-50" unit="degC" uri=""/>
		<Output name="airTemperature" description="Air node temperature used during substeps" variablecategory="state" datatype="DOUBLE" max="100" min="-50" unit="degC" uri=""/>
		<Output name="netRadiation" description="Net radiation at soil surface for last substep" variablecategory="state" datatype="DOUBLE" max="" min="" unit="-" uri=""/>
		<Output name="internalTimeStep" description="Internal substep length used for the day" variablecategory="state" datatype="DOUBLE" max="86400" min="0" unit="s" uri=""/>
		<Output name="timeOfDaySecs" description="Time within the day at last substep" variablecategory="state" datatype="DOUBLE" max="86400" min="0" unit="s" uri=""/>
		<Output name="instrumentHeight" description="Updated effective instrument height" variablecategory="state" datatype="DOUBLE" max="" min="0.5" unit="m" uri=""/>
		<Output name="canopyHeight" description="Updated effective canopy height" variablecategory="state" datatype="DOUBLE" max="" min="0" unit="m" uri=""/>
		<Output name="soilWater" description="Updated soil water per node/layer (mapped from waterBalance_SW)" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="1" min="0" unit="-" uri=""/>
		<Output name="maxTempYesterday" description="Stored yesterday's maximum air temperature for next day interpolation" variablecategory="state" datatype="DOUBLE" max="100" min="-50" unit="degC" uri=""/>
		<Output name="minTempYesterday" description="Stored yesterday's minimum air temperature for next day interpolation" variablecategory="state" datatype="DOUBLE" max="100" min="-50" unit="degC" uri=""/>
		<Output name="doInitialisationStuff" description="Flag indicating whether first-time initialisation has been applied" variablecategory="state" datatype="CHAR" max="" min="" unit="-" uri=""/>
		<Output name="InitialValues" description="Stored initial layer temperatures (for reporting or reuse)" variablecategory="state" datatype="DOUBLEARRAY" len="-" max="" min="" unit="degC" uri=""/>
		<Output name="waterBalance_Salb" description="Soil albedo stored in state for use within substeps" variablecategory="state" datatype="DOUBLE" max="1" min="0" unit="-" uri=""/>
	</Outputs>
	<Initialization name="SoilTemperature_initialize" language="cyml" filename="algo/pyx/SoilTemperature_initialize.pyx"/>
	<Function name="Divide" description="Safe division with fallback error value when denominator is zero." language="cyml" type="external" filename="algo/pyx/Divide.pyx"/>
	<Function name="ValuesInArray" description="Checks if an array contains any valid (non-NaN, not 999999) value." language="cyml" type="external" filename="algo/pyx/ValuesInArray.pyx"/>
	<Function name="Sum" description="Partial sum of array values from startIndex to endIndex ignoring sentinel 999999." language="cyml" type="external" filename="algo/pyx/Sum.pyx"/>
	<Function name="Zero" description="Sets all elements of an array to 0.0 in-place." language="cyml" type="external" filename="algo/pyx/Zero.pyx"/>
	<Function name="ToCumThickness" description="Converts thickness array to cumulative depths." language="cyml" type="external" filename="algo/pyx/ToCumThickness.pyx"/>
	<Function name="kelvinT" description="Converts Celsius temperature to Kelvin." language="cyml" type="external" filename="algo/pyx/kelvinT.pyx"/>
	<Function name="longWaveRadn" description="Computes longwave radiation using Stefan-Boltzmann law." language="cyml" type="external" filename="algo/pyx/longWaveRadn.pyx"/>
	<Function name="boundCheck" description="Range check helper (no exception)." language="cyml" type="external" filename="algo/pyx/boundCheck.pyx"/>
	<Function name="volumetricFractionRocks" description="Volumetric fraction of rocks for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionRocks.pyx"/>
	<Function name="volumetricFractionOrganicMatter" description="Volumetric fraction of organic matter for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionOrganicMatter.pyx"/>
	<Function name="volumetricFractionSand" description="Volumetric fraction of sand for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionSand.pyx"/>
	<Function name="volumetricFractionSilt" description="Volumetric fraction of silt for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionSilt.pyx"/>
	<Function name="volumetricFractionClay" description="Volumetric fraction of clay for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionClay.pyx"/>
	<Function name="volumetricFractionWater" description="Volumetric fraction of water for a layer." language="cyml" type="external" filename="algo/pyx/volumetricFractionWater.pyx"/>
	<Function name="volumetricFractionIce" description="Volumetric fraction of ice for a layer (returns 0)." language="cyml" type="external" filename="algo/pyx/volumetricFractionIce.pyx"/>
	<Function name="volumetricFractionAir" description="Volumetric fraction of air as 1 - solids - water - ice." language="cyml" type="external" filename="algo/pyx/volumetricFractionAir.pyx"/>
	<Function name="volumetricSpecificHeat" description="Material-specific volumetric heat capacity constants by constituent." language="cyml" type="external" filename="algo/pyx/volumetricSpecificHeat.pyx"/>
	<Function name="ThermalConductance" description="Material thermal conductance by constituent (replicates original code behavior by returning volumetricSpecificHeat)." language="cyml" type="external" filename="algo/pyx/ThermalConductance.pyx"/>
	<Function name="shapeFactor" description="Shape factor for constituents (replicates original code behavior by returning volumetricSpecificHeat)." language="cyml" type="external" filename="algo/pyx/shapeFactor.pyx"/>
	<Function name="airDensity" description="Computes air density from temperature and pressure." language="cyml" type="external" filename="algo/pyx/airDensity.pyx"/>
	<Function name="mapLayer2Node" description="Maps layer properties to nodes by linear interpolation." language="cyml" type="external" filename="algo/pyx/mapLayer2Node.pyx"/>
	<Function name="doThermalConductivityCoeffs" description="Computes empirical coefficients for thermal conductivity based on clay and bulk density." language="cyml" type="external" filename="algo/pyx/doThermalConductivityCoeffs.pyx"/>
	<Function name="doVolumetricSpecificHeat" description="Computes node volumetric specific heat and maps to nodes." language="cyml" type="external" filename="algo/pyx/doVolumetricSpecificHeat.pyx"/>
	<Function name="doThermalConductivity" description="Computes thermal conductivity per node using mixture theory." language="cyml" type="external" filename="algo/pyx/doThermalConductivity.pyx"/>
	<Function name="doThomas" description="Implicit tridiagonal solver for heat diffusion with surface energy flux boundary." language="cyml" type="external" filename="algo/pyx/doThomas.pyx"/>
	<Function name="interpolateTemperature" description="Interpolates sub-daily air temperature using a sinusoidal diurnal cycle." language="cyml" type="external" filename="algo/pyx/interpolateTemperature.pyx"/>
	<Function name="doUpdate" description="Updates daily min/max/avg temperatures and aggregates boundary-layer conductance." language="cyml" type="external" filename="algo/pyx/doUpdate.pyx"/>
	<Function name="getBoundaryLayerConductance" description="Computes boundary layer conductance including stability corrections and radiative coupling." language="cyml" type="external" filename="algo/pyx/getBoundaryLayerConductance.pyx"/>
	<Function name="calcSoilTemperature" description="Initial soil temperature profile from annual harmonic solution." language="cyml" type="external" filename="algo/pyx/calcSoilTemperature.pyx"/>
	<Function name="calcLayerTemperature" description="Harmonic layer temperature at a given phase and damping depth." language="cyml" type="external" filename="algo/pyx/calcLayerTemperature.pyx"/>
	<Function name="calcSurfaceTemperature" description="Initial surface temperature from radiation and albedo." language="cyml" type="external" filename="algo/pyx/calcSurfaceTemperature.pyx"/>
	<Function name="doNetRadiation" description="Computes diurnal partitioning of solar radiation and cloud fraction." language="cyml" type="external" filename="algo/pyx/doNetRadiation.pyx"/>
	<Function name="interpolateNetRadiation" description="Combines shortwave and longwave to get net soil surface radiation for a substep." language="cyml" type="external" filename="algo/pyx/interpolateNetRadiation.pyx"/>
	<Function name="getIniVariables" description="Initialises instrument height and checks average temperature bounds." language="cyml" type="external" filename="algo/pyx/getIniVariables.pyx"/>
	<Function name="getProfileVariables" description="Constructs node geometry and copies profile properties into state." language="cyml" type="external" filename="algo/pyx/getProfileVariables.pyx"/>
	<Function name="readParam" description="Initial parameter-based computations and initial soil temperatures." language="cyml" type="external" filename="algo/pyx/readParam.pyx"/>
	<Function name="getOtherVariables" description="Refreshes dynamic inputs: soil water and canopy height; constrains instrument height." language="cyml" type="external" filename="algo/pyx/getOtherVariables.pyx"/>
	<Function name="doProcess" description="Performs the internal substep loop for one day updating temperatures and diagnostics." language="cyml" type="external" filename="algo/pyx/doProcess.pyx"/>
	<Function name="FinalSoilTemperature" description="Extracts final layer temperatures for reporting." language="cyml" type="external" filename="algo/pyx/FinalSoilTemperature.pyx"/>
	<Function name="FinalSoilSurfaceTemperature" description="Returns final surface node temperature." language="cyml" type="external" filename="algo/pyx/FinalSoilSurfaceTemperature.pyx"/>
	<Function name="AverageSoilTemperature" description="Returns daily average temperatures per layer." language="cyml" type="external" filename="algo/pyx/AverageSoilTemperature.pyx"/>
	<Function name="AverageSoilSurfaceTemperature" description="Returns daily average surface temperature." language="cyml" type="external" filename="algo/pyx/AverageSoilSurfaceTemperature.pyx"/>
	<Function name="MinimumSoilTemperature" description="Returns daily minimum temperatures per layer." language="cyml" type="external" filename="algo/pyx/MinimumSoilTemperature.pyx"/>
	<Function name="MinimumSoilSurfaceTemperature" description="Returns daily minimum surface temperature." language="cyml" type="external" filename="algo/pyx/MinimumSoilSurfaceTemperature.pyx"/>
	<Function name="MaximumSoilTemperature" description="Returns daily maximum temperatures per layer." language="cyml" type="external" filename="algo/pyx/MaximumSoilTemperature.pyx"/>
	<Function name="MaximumSoilSurfaceTemperature" description="Returns daily maximum surface temperature." language="cyml" type="external" filename="algo/pyx/MaximumSoilSurfaceTemperature.pyx"/>
	<Function name="BoundaryLayerConductance" description="Returns aggregated boundary layer conductance." language="cyml" type="external" filename="algo/pyx/BoundaryLayerConductance.pyx"/>
	<Function name="ThermalConductivity_profile" description="Returns thermal conductivity profile for reporting." language="cyml" type="external" filename="algo/pyx/ThermalConductivity_profile.pyx"/>
	<Function name="HeatCapacity_profile" description="Returns volumetric heat capacity profile for reporting." language="cyml" type="external" filename="algo/pyx/HeatCapacity_profile.pyx"/>
	<Function name="HeatStore_profile" description="Returns heat storage profile for reporting." language="cyml" type="external" filename="algo/pyx/HeatStore_profile.pyx"/>
	<Function name="Thr_profile" description="Returns morning soil temperature profile." language="cyml" type="external" filename="algo/pyx/Thr_profile.pyx"/>
	<Algorithm language="cyml" platform="" filename="algo/pyx/SoilTemperature_process.pyx"/>
	<Parametersets/>
	<Testsets/>
</ModelUnit>
